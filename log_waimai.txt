INFO:root:18:38:15 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=400, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:18:38:20 processing dataset...
INFO:root:18:38:21 Now we are doing BERT classification training on gpu(0)!
INFO:root:18:38:21 training steps=1250
INFO:root:18:38:45 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:38:50 validation metrics:accuracy:0.6820
INFO:root:18:38:50 Time cost=5.00s, throughput=399.85 samples/s
INFO:root:18:38:50 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:18:38:50 Time cost=29.30s
INFO:root:18:38:54 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=400, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:18:38:58 processing dataset...
INFO:root:18:38:59 Now we are doing BERT classification training on gpu(0)!
INFO:root:18:38:59 training steps=1250
INFO:root:18:39:23 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:39:28 validation metrics:accuracy:0.7015
INFO:root:18:39:28 Time cost=5.04s, throughput=396.48 samples/s
INFO:root:18:39:30 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:18:39:30 Time cost=30.32s
INFO:root:18:39:53 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:39:58 validation metrics:accuracy:0.7550
INFO:root:18:39:58 Time cost=5.07s, throughput=394.12 samples/s
INFO:root:18:39:59 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:18:39:59 Time cost=29.10s
INFO:root:18:40:22 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:40:27 validation metrics:accuracy:0.7680
INFO:root:18:40:27 Time cost=5.00s, throughput=400.35 samples/s
INFO:root:18:40:28 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:18:40:28 Time cost=29.01s
INFO:root:18:40:51 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:42:28 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=400, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:18:42:33 processing dataset...
INFO:root:18:42:34 Now we are doing BERT classification training on gpu(0)!
INFO:root:18:42:34 training steps=1250
INFO:root:18:42:58 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:43:03 validation metrics:accuracy:0.7015
INFO:root:18:43:03 Time cost=5.12s, throughput=390.72 samples/s
INFO:root:18:43:04 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:18:43:04 Time cost=30.36s
INFO:root:18:43:28 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:43:33 validation metrics:accuracy:0.7550
INFO:root:18:43:33 Time cost=4.96s, throughput=402.91 samples/s
INFO:root:18:43:34 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:18:43:34 Time cost=29.80s
INFO:root:18:43:58 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:44:03 validation metrics:accuracy:0.7680
INFO:root:18:44:03 Time cost=5.10s, throughput=391.98 samples/s
INFO:root:18:44:04 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:18:44:04 Time cost=30.05s
INFO:root:18:44:27 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=400, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:18:44:31 processing dataset...
INFO:root:18:44:33 Now we are doing BERT classification training on gpu(0)!
INFO:root:18:44:33 training steps=1250
INFO:root:18:45:11 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:18:45:15 processing dataset...
INFO:root:18:45:17 Now we are doing BERT classification training on gpu(0)!
INFO:root:18:45:17 training steps=1250
INFO:root:18:45:22 [Epoch 1 Batch 40/254] loss=0.6794, lr=0.0000062, metrics:accuracy:0.5987
INFO:root:18:46:06 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:18:46:10 processing dataset...
INFO:root:18:46:12 Now we are doing BERT classification training on gpu(0)!
INFO:root:18:46:12 training steps=1250
INFO:root:18:46:16 [Epoch 1 Batch 40/254] loss=0.6794, lr=0.0000062, metrics:accuracy:0.5987
INFO:root:18:46:42 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:18:46:46 processing dataset...
INFO:root:18:46:48 Now we are doing BERT classification training on gpu(0)!
INFO:root:18:46:48 training steps=1250
INFO:root:18:46:53 [Epoch 1 Batch 40/254] loss=0.6794, lr=0.0000062, metrics:accuracy:0.5987
INFO:root:18:46:56 [Epoch 1 Batch 80/254] loss=0.6002, lr=0.0000126, metrics:accuracy:0.6188
INFO:root:18:47:00 [Epoch 1 Batch 120/254] loss=0.5964, lr=0.0000190, metrics:accuracy:0.6396
INFO:root:18:47:04 [Epoch 1 Batch 160/254] loss=0.5732, lr=0.0000194, metrics:accuracy:0.6548
INFO:root:18:47:07 [Epoch 1 Batch 200/254] loss=0.5957, lr=0.0000187, metrics:accuracy:0.6654
INFO:root:18:47:11 [Epoch 1 Batch 240/254] loss=0.5587, lr=0.0000180, metrics:accuracy:0.6702
INFO:root:18:47:12 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:47:13 [Batch 40/250] loss=0.5860, metrics:accuracy:40.0000
INFO:root:18:58:23 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:18:58:28 processing dataset...
INFO:root:18:58:29 Now we are doing BERT classification training on gpu(0)!
INFO:root:18:58:29 training steps=1250
INFO:root:18:58:34 [Epoch 1 Batch 40/254] loss=0.6794, lr=0.0000062, metrics:accuracy:0.5987
INFO:root:18:58:38 [Epoch 1 Batch 80/254] loss=0.6002, lr=0.0000126, metrics:accuracy:0.6188
INFO:root:18:58:41 [Epoch 1 Batch 120/254] loss=0.5964, lr=0.0000190, metrics:accuracy:0.6396
INFO:root:18:58:45 [Epoch 1 Batch 160/254] loss=0.5732, lr=0.0000194, metrics:accuracy:0.6548
INFO:root:18:58:48 [Epoch 1 Batch 200/254] loss=0.5957, lr=0.0000187, metrics:accuracy:0.6654
INFO:root:18:58:52 [Epoch 1 Batch 240/254] loss=0.5587, lr=0.0000180, metrics:accuracy:0.6702
INFO:root:18:58:54 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:58:54 [Batch 40/250] loss=0.5860, metrics:accuracy:40.0000
INFO:root:18:58:55 [Batch 80/250] loss=0.6279, metrics:accuracy:80.0000
INFO:root:18:58:56 [Batch 120/250] loss=0.5406, metrics:accuracy:120.0000
INFO:root:18:58:57 [Batch 160/250] loss=0.6413, metrics:accuracy:160.0000
INFO:root:18:58:58 [Batch 200/250] loss=0.6144, metrics:accuracy:200.0000
INFO:root:18:58:59 [Batch 240/250] loss=0.6309, metrics:accuracy:240.0000
INFO:root:18:58:59 validation metrics:accuracy:0.7015
INFO:root:18:58:59 Time cost=5.16s, throughput=387.76 samples/s
INFO:root:18:59:01 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:18:59:01 Time cost=31.40s
INFO:root:18:59:05 [Epoch 2 Batch 40/254] loss=0.5249, lr=0.0000170, metrics:accuracy:0.7496
INFO:root:18:59:08 [Epoch 2 Batch 80/254] loss=0.5370, lr=0.0000163, metrics:accuracy:0.7408
INFO:root:18:59:12 [Epoch 2 Batch 120/254] loss=0.5320, lr=0.0000156, metrics:accuracy:0.7388
INFO:root:18:59:16 [Epoch 2 Batch 160/254] loss=0.5269, lr=0.0000149, metrics:accuracy:0.7385
INFO:root:18:59:20 [Epoch 2 Batch 200/254] loss=0.5233, lr=0.0000142, metrics:accuracy:0.7396
INFO:root:18:59:23 [Epoch 2 Batch 240/254] loss=0.5237, lr=0.0000135, metrics:accuracy:0.7430
INFO:root:18:59:25 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:59:26 [Batch 40/250] loss=0.5103, metrics:accuracy:290.0000
INFO:root:18:59:26 [Batch 80/250] loss=0.4928, metrics:accuracy:330.0000
INFO:root:18:59:27 [Batch 120/250] loss=0.4862, metrics:accuracy:370.0000
INFO:root:18:59:28 [Batch 160/250] loss=0.5335, metrics:accuracy:410.0000
INFO:root:18:59:29 [Batch 200/250] loss=0.4871, metrics:accuracy:450.0000
INFO:root:18:59:30 [Batch 240/250] loss=0.5222, metrics:accuracy:490.0000
INFO:root:18:59:30 validation metrics:accuracy:0.7550
INFO:root:18:59:30 Time cost=5.25s, throughput=380.66 samples/s
INFO:root:18:59:33 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:18:59:33 Time cost=32.15s
INFO:root:18:59:37 [Epoch 3 Batch 40/254] loss=0.4887, lr=0.0000125, metrics:accuracy:0.7672
INFO:root:18:59:40 [Epoch 3 Batch 80/254] loss=0.4874, lr=0.0000118, metrics:accuracy:0.7648
INFO:root:18:59:44 [Epoch 3 Batch 120/254] loss=0.4781, lr=0.0000111, metrics:accuracy:0.7720
INFO:root:18:59:48 [Epoch 3 Batch 160/254] loss=0.4819, lr=0.0000104, metrics:accuracy:0.7756
INFO:root:18:59:52 [Epoch 3 Batch 200/254] loss=0.4389, lr=0.0000097, metrics:accuracy:0.7806
INFO:root:18:59:56 [Epoch 3 Batch 240/254] loss=0.4743, lr=0.0000089, metrics:accuracy:0.7801
INFO:root:18:59:57 Now we are doing evaluation on dev with gpu(0).
INFO:root:18:59:58 [Batch 40/250] loss=0.4757, metrics:accuracy:540.0000
INFO:root:18:59:59 [Batch 80/250] loss=0.4591, metrics:accuracy:580.0000
INFO:root:18:59:59 [Batch 120/250] loss=0.4426, metrics:accuracy:620.0000
INFO:root:19:00:00 [Batch 160/250] loss=0.5047, metrics:accuracy:660.0000
INFO:root:19:00:01 [Batch 200/250] loss=0.4937, metrics:accuracy:700.0000
INFO:root:19:00:02 [Batch 240/250] loss=0.5460, metrics:accuracy:740.0000
INFO:root:19:00:02 validation metrics:accuracy:0.7680
INFO:root:19:00:02 Time cost=5.29s, throughput=378.40 samples/s
INFO:root:19:00:04 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:19:00:04 Time cost=30.74s
INFO:root:19:00:08 [Epoch 4 Batch 40/254] loss=0.4272, lr=0.0000080, metrics:accuracy:0.8086
INFO:root:19:00:12 [Epoch 4 Batch 80/254] loss=0.4288, lr=0.0000073, metrics:accuracy:0.8041
INFO:root:19:00:15 [Epoch 4 Batch 120/254] loss=0.4519, lr=0.0000066, metrics:accuracy:0.7990
INFO:root:19:00:19 [Epoch 4 Batch 160/254] loss=0.4726, lr=0.0000058, metrics:accuracy:0.7922
INFO:root:19:00:22 [Epoch 4 Batch 200/254] loss=0.4344, lr=0.0000051, metrics:accuracy:0.7953
INFO:root:19:00:26 [Epoch 4 Batch 240/254] loss=0.4447, lr=0.0000044, metrics:accuracy:0.7961
INFO:root:19:00:27 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:00:28 [Batch 40/250] loss=0.4767, metrics:accuracy:790.0000
INFO:root:19:00:29 [Batch 80/250] loss=0.4522, metrics:accuracy:830.0000
INFO:root:19:00:30 [Batch 120/250] loss=0.4494, metrics:accuracy:870.0000
INFO:root:19:00:30 [Batch 160/250] loss=0.5166, metrics:accuracy:910.0000
INFO:root:19:00:31 [Batch 200/250] loss=0.4868, metrics:accuracy:950.0000
INFO:root:19:00:32 [Batch 240/250] loss=0.5502, metrics:accuracy:990.0000
INFO:root:19:00:32 validation metrics:accuracy:0.7735
INFO:root:19:00:32 Time cost=5.19s, throughput=385.66 samples/s
INFO:root:19:00:33 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:19:00:33 Time cost=29.28s
INFO:root:19:00:37 [Epoch 5 Batch 40/254] loss=0.3927, lr=0.0000035, metrics:accuracy:0.8328
INFO:root:19:00:41 [Epoch 5 Batch 80/254] loss=0.4077, lr=0.0000028, metrics:accuracy:0.8175
INFO:root:19:00:45 [Epoch 5 Batch 120/254] loss=0.4382, lr=0.0000020, metrics:accuracy:0.8127
INFO:root:19:00:48 [Epoch 5 Batch 160/254] loss=0.4257, lr=0.0000013, metrics:accuracy:0.8100
INFO:root:19:00:52 [Epoch 5 Batch 200/254] loss=0.4546, lr=0.0000006, metrics:accuracy:0.8068
INFO:root:19:00:55 Finish training step: 1250
INFO:root:19:00:55 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:00:56 [Batch 40/250] loss=0.4718, metrics:accuracy:1040.0000
INFO:root:19:00:57 [Batch 80/250] loss=0.4426, metrics:accuracy:1080.0000
INFO:root:19:00:58 [Batch 120/250] loss=0.4501, metrics:accuracy:1120.0000
INFO:root:19:00:59 [Batch 160/250] loss=0.4943, metrics:accuracy:1160.0000
INFO:root:19:01:00 [Batch 200/250] loss=0.4708, metrics:accuracy:1200.0000
INFO:root:19:01:01 [Batch 240/250] loss=0.5424, metrics:accuracy:1240.0000
INFO:root:19:01:01 validation metrics:accuracy:0.7775
INFO:root:19:01:01 Time cost=5.84s, throughput=342.49 samples/s
INFO:root:19:01:08 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:19:01:08 Time cost=34.94s
INFO:root:19:01:08 Best model at epoch 4. Validation metrics:accuracy:0.7775
INFO:root:19:01:08 Now we are doing testing on test with gpu(0).
INFO:root:19:01:13 Time cost=5.07s, throughput=392.80 samples/s
INFO:root:19:33:45 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:19:33:50 processing dataset...
INFO:root:19:33:52 Now we are doing BERT classification training on gpu(0)!
INFO:root:19:33:52 training steps=1250
INFO:root:19:33:56 [Epoch 1 Batch 40/254] loss=0.6794, lr=0.0000062, metrics:accuracy:0.5987
INFO:root:19:34:00 [Epoch 1 Batch 80/254] loss=0.6002, lr=0.0000126, metrics:accuracy:0.6188
INFO:root:19:34:04 [Epoch 1 Batch 120/254] loss=0.5964, lr=0.0000190, metrics:accuracy:0.6396
INFO:root:19:34:07 [Epoch 1 Batch 160/254] loss=0.5732, lr=0.0000194, metrics:accuracy:0.6548
INFO:root:19:34:11 [Epoch 1 Batch 200/254] loss=0.5957, lr=0.0000187, metrics:accuracy:0.6654
INFO:root:19:34:15 [Epoch 1 Batch 240/254] loss=0.5587, lr=0.0000180, metrics:accuracy:0.6702
INFO:root:19:34:16 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:34:17 [Batch 40/250] loss=0.5860, metrics:accuracy:40.0000
INFO:root:19:34:18 [Batch 80/250] loss=0.6279, metrics:accuracy:80.0000
INFO:root:19:34:19 [Batch 120/250] loss=0.5406, metrics:accuracy:120.0000
INFO:root:19:34:19 [Batch 160/250] loss=0.6413, metrics:accuracy:160.0000
INFO:root:19:34:20 [Batch 200/250] loss=0.6144, metrics:accuracy:200.0000
INFO:root:19:34:21 [Batch 240/250] loss=0.6309, metrics:accuracy:240.0000
INFO:root:19:34:21 validation metrics:accuracy:0.7015
INFO:root:19:34:21 Time cost=5.40s, throughput=370.36 samples/s
INFO:root:19:34:24 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:19:34:24 Time cost=32.43s
INFO:root:19:34:28 [Epoch 2 Batch 40/254] loss=0.5249, lr=0.0000170, metrics:accuracy:0.7496
INFO:root:19:34:32 [Epoch 2 Batch 80/254] loss=0.5370, lr=0.0000163, metrics:accuracy:0.7408
INFO:root:19:34:36 [Epoch 2 Batch 120/254] loss=0.5320, lr=0.0000156, metrics:accuracy:0.7388
INFO:root:19:34:40 [Epoch 2 Batch 160/254] loss=0.5269, lr=0.0000149, metrics:accuracy:0.7385
INFO:root:19:34:44 [Epoch 2 Batch 200/254] loss=0.5233, lr=0.0000142, metrics:accuracy:0.7396
INFO:root:19:34:48 [Epoch 2 Batch 240/254] loss=0.5237, lr=0.0000135, metrics:accuracy:0.7430
INFO:root:19:34:49 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:34:50 [Batch 40/250] loss=0.5103, metrics:accuracy:290.0000
INFO:root:19:34:51 [Batch 80/250] loss=0.4928, metrics:accuracy:330.0000
INFO:root:19:34:51 [Batch 120/250] loss=0.4862, metrics:accuracy:370.0000
INFO:root:19:34:52 [Batch 160/250] loss=0.5335, metrics:accuracy:410.0000
INFO:root:19:34:53 [Batch 200/250] loss=0.4871, metrics:accuracy:450.0000
INFO:root:19:34:54 [Batch 240/250] loss=0.5222, metrics:accuracy:490.0000
INFO:root:19:34:54 validation metrics:accuracy:0.7550
INFO:root:19:34:54 Time cost=5.12s, throughput=390.77 samples/s
INFO:root:19:34:56 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:19:34:56 Time cost=31.48s
INFO:root:19:34:59 [Epoch 3 Batch 40/254] loss=0.4887, lr=0.0000125, metrics:accuracy:0.7672
INFO:root:19:35:03 [Epoch 3 Batch 80/254] loss=0.4874, lr=0.0000118, metrics:accuracy:0.7648
INFO:root:19:35:06 [Epoch 3 Batch 120/254] loss=0.4781, lr=0.0000111, metrics:accuracy:0.7720
INFO:root:19:35:10 [Epoch 3 Batch 160/254] loss=0.4819, lr=0.0000104, metrics:accuracy:0.7756
INFO:root:19:35:14 [Epoch 3 Batch 200/254] loss=0.4389, lr=0.0000097, metrics:accuracy:0.7806
INFO:root:19:35:18 [Epoch 3 Batch 240/254] loss=0.4743, lr=0.0000089, metrics:accuracy:0.7801
INFO:root:19:35:19 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:35:20 [Batch 40/250] loss=0.4757, metrics:accuracy:540.0000
INFO:root:19:35:21 [Batch 80/250] loss=0.4591, metrics:accuracy:580.0000
INFO:root:19:35:22 [Batch 120/250] loss=0.4426, metrics:accuracy:620.0000
INFO:root:19:35:22 [Batch 160/250] loss=0.5047, metrics:accuracy:660.0000
INFO:root:19:35:23 [Batch 200/250] loss=0.4937, metrics:accuracy:700.0000
INFO:root:19:35:24 [Batch 240/250] loss=0.5460, metrics:accuracy:740.0000
INFO:root:19:35:24 validation metrics:accuracy:0.7680
INFO:root:19:35:24 Time cost=5.17s, throughput=386.97 samples/s
INFO:root:19:35:26 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:19:35:26 Time cost=30.55s
INFO:root:19:35:30 [Epoch 4 Batch 40/254] loss=0.4272, lr=0.0000080, metrics:accuracy:0.8086
INFO:root:19:35:34 [Epoch 4 Batch 80/254] loss=0.4288, lr=0.0000073, metrics:accuracy:0.8041
INFO:root:19:35:38 [Epoch 4 Batch 120/254] loss=0.4519, lr=0.0000066, metrics:accuracy:0.7990
INFO:root:19:35:41 [Epoch 4 Batch 160/254] loss=0.4726, lr=0.0000058, metrics:accuracy:0.7922
INFO:root:19:35:45 [Epoch 4 Batch 200/254] loss=0.4344, lr=0.0000051, metrics:accuracy:0.7953
INFO:root:19:35:49 [Epoch 4 Batch 240/254] loss=0.4447, lr=0.0000044, metrics:accuracy:0.7961
INFO:root:19:35:50 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:35:51 [Batch 40/250] loss=0.4767, metrics:accuracy:790.0000
INFO:root:19:35:52 [Batch 80/250] loss=0.4522, metrics:accuracy:830.0000
INFO:root:19:35:53 [Batch 120/250] loss=0.4494, metrics:accuracy:870.0000
INFO:root:19:35:54 [Batch 160/250] loss=0.5166, metrics:accuracy:910.0000
INFO:root:19:35:54 [Batch 200/250] loss=0.4868, metrics:accuracy:950.0000
INFO:root:19:35:55 [Batch 240/250] loss=0.5502, metrics:accuracy:990.0000
INFO:root:19:35:55 validation metrics:accuracy:0.7735
INFO:root:19:35:55 Time cost=5.07s, throughput=394.84 samples/s
INFO:root:19:36:01 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:19:36:01 Time cost=35.23s
INFO:root:19:36:06 [Epoch 5 Batch 40/254] loss=0.3927, lr=0.0000035, metrics:accuracy:0.8328
INFO:root:19:36:10 [Epoch 5 Batch 80/254] loss=0.4077, lr=0.0000028, metrics:accuracy:0.8175
INFO:root:19:36:13 [Epoch 5 Batch 120/254] loss=0.4382, lr=0.0000020, metrics:accuracy:0.8127
INFO:root:19:36:17 [Epoch 5 Batch 160/254] loss=0.4257, lr=0.0000013, metrics:accuracy:0.8100
INFO:root:19:36:20 [Epoch 5 Batch 200/254] loss=0.4546, lr=0.0000006, metrics:accuracy:0.8068
INFO:root:19:36:24 Finish training step: 1250
INFO:root:19:36:24 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:36:24 [Batch 40/250] loss=0.4718, metrics:accuracy:1040.0000
INFO:root:19:36:25 [Batch 80/250] loss=0.4426, metrics:accuracy:1080.0000
INFO:root:19:36:26 [Batch 120/250] loss=0.4501, metrics:accuracy:1120.0000
INFO:root:19:36:27 [Batch 160/250] loss=0.4943, metrics:accuracy:1160.0000
INFO:root:19:36:28 [Batch 200/250] loss=0.4708, metrics:accuracy:1200.0000
INFO:root:19:36:29 [Batch 240/250] loss=0.5424, metrics:accuracy:1240.0000
INFO:root:19:36:29 validation metrics:accuracy:0.7775
INFO:root:19:36:29 Time cost=5.08s, throughput=393.54 samples/s
INFO:root:19:36:32 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:19:36:32 Time cost=30.93s
INFO:root:19:36:33 Best model at epoch 4. Validation metrics:accuracy:0.7775
INFO:root:19:36:33 Now we are doing testing on test with gpu(0).
INFO:root:19:36:37 Time cost=4.84s, throughput=411.62 samples/s
INFO:root:19:50:40 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:19:51:13 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:19:51:17 processing dataset...
INFO:root:19:51:19 Now we are doing BERT classification training on gpu(0)!
INFO:root:19:51:19 training steps=1250
INFO:root:19:51:53 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:19:51:59 processing dataset...
INFO:root:19:52:01 Now we are doing BERT classification training on gpu(0)!
INFO:root:19:52:01 training steps=1250
INFO:root:19:52:05 [Epoch 1 Batch 40/254] loss=0.6794, lr=0.0000062, metrics:accuracy:0.5987
INFO:root:19:52:09 [Epoch 1 Batch 80/254] loss=0.6002, lr=0.0000126, metrics:accuracy:0.6188
INFO:root:19:52:13 [Epoch 1 Batch 120/254] loss=0.5964, lr=0.0000190, metrics:accuracy:0.6396
INFO:root:19:52:16 [Epoch 1 Batch 160/254] loss=0.5732, lr=0.0000194, metrics:accuracy:0.6548
INFO:root:19:52:20 [Epoch 1 Batch 200/254] loss=0.5957, lr=0.0000187, metrics:accuracy:0.6654
INFO:root:19:52:23 [Epoch 1 Batch 240/254] loss=0.5587, lr=0.0000180, metrics:accuracy:0.6702
INFO:root:19:52:25 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:52:26 [Batch 40/250] loss=0.5860, metrics:accuracy:40.0000
INFO:root:19:52:26 [Batch 80/250] loss=0.6279, metrics:accuracy:80.0000
INFO:root:19:52:27 [Batch 120/250] loss=0.5406, metrics:accuracy:120.0000
INFO:root:19:53:07 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:19:53:13 processing dataset...
INFO:root:19:53:14 Now we are doing BERT classification training on gpu(0)!
INFO:root:19:53:14 training steps=2500
INFO:root:19:53:19 [Epoch 1 Batch 40/254] loss=0.6801, lr=0.0000031, metrics:accuracy:0.5792
INFO:root:19:53:22 [Epoch 1 Batch 80/254] loss=0.5912, lr=0.0000063, metrics:accuracy:0.6144
INFO:root:19:53:26 [Epoch 1 Batch 120/254] loss=0.6044, lr=0.0000095, metrics:accuracy:0.6367
INFO:root:19:53:30 [Epoch 1 Batch 160/254] loss=0.5882, lr=0.0000127, metrics:accuracy:0.6530
INFO:root:19:53:34 [Epoch 1 Batch 200/254] loss=0.6041, lr=0.0000159, metrics:accuracy:0.6608
INFO:root:19:53:38 [Epoch 1 Batch 240/254] loss=0.5543, lr=0.0000191, metrics:accuracy:0.6715
INFO:root:19:53:39 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:53:40 [Batch 40/250] loss=0.6128, metrics:accuracy:40.0000
INFO:root:19:53:41 [Batch 80/250] loss=0.6305, metrics:accuracy:80.0000
INFO:root:19:53:42 [Batch 120/250] loss=0.5689, metrics:accuracy:120.0000
INFO:root:19:53:43 [Batch 160/250] loss=0.6400, metrics:accuracy:160.0000
INFO:root:19:53:43 [Batch 200/250] loss=0.6116, metrics:accuracy:200.0000
INFO:root:19:53:44 [Batch 240/250] loss=0.6182, metrics:accuracy:240.0000
INFO:root:19:53:44 validation metrics:accuracy:0.7385
INFO:root:19:53:44 Time cost=5.26s, throughput=380.37 samples/s
INFO:root:19:53:47 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:19:53:47 Time cost=33.35s
INFO:root:19:53:51 [Epoch 2 Batch 40/254] loss=0.5579, lr=0.0000196, metrics:accuracy:0.7354
INFO:root:19:53:55 [Epoch 2 Batch 80/254] loss=0.5339, lr=0.0000193, metrics:accuracy:0.7349
INFO:root:19:53:59 [Epoch 2 Batch 120/254] loss=0.5352, lr=0.0000189, metrics:accuracy:0.7273
INFO:root:19:54:03 [Epoch 2 Batch 160/254] loss=0.5359, lr=0.0000186, metrics:accuracy:0.7241
INFO:root:19:54:07 [Epoch 2 Batch 200/254] loss=0.5013, lr=0.0000182, metrics:accuracy:0.7313
INFO:root:19:54:11 [Epoch 2 Batch 240/254] loss=0.5241, lr=0.0000178, metrics:accuracy:0.7342
INFO:root:19:54:12 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:54:13 [Batch 40/250] loss=0.4960, metrics:accuracy:290.0000
INFO:root:19:54:14 [Batch 80/250] loss=0.4599, metrics:accuracy:330.0000
INFO:root:19:54:15 [Batch 120/250] loss=0.4726, metrics:accuracy:370.0000
INFO:root:19:54:16 [Batch 160/250] loss=0.4993, metrics:accuracy:410.0000
INFO:root:19:54:17 [Batch 200/250] loss=0.4698, metrics:accuracy:450.0000
INFO:root:19:54:17 [Batch 240/250] loss=0.5048, metrics:accuracy:490.0000
INFO:root:19:54:18 validation metrics:accuracy:0.7690
INFO:root:19:54:18 Time cost=5.46s, throughput=366.40 samples/s
INFO:root:19:54:19 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:19:54:19 Time cost=32.03s
INFO:root:19:54:23 [Epoch 3 Batch 40/254] loss=0.4952, lr=0.0000174, metrics:accuracy:0.7576
INFO:root:19:54:27 [Epoch 3 Batch 80/254] loss=0.4921, lr=0.0000170, metrics:accuracy:0.7535
INFO:root:19:54:31 [Epoch 3 Batch 120/254] loss=0.4700, lr=0.0000166, metrics:accuracy:0.7624
INFO:root:19:54:35 [Epoch 3 Batch 160/254] loss=0.4685, lr=0.0000163, metrics:accuracy:0.7700
INFO:root:19:54:40 [Epoch 3 Batch 200/254] loss=0.4524, lr=0.0000159, metrics:accuracy:0.7737
INFO:root:19:54:43 [Epoch 3 Batch 240/254] loss=0.4739, lr=0.0000156, metrics:accuracy:0.7754
INFO:root:19:54:45 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:54:46 [Batch 40/250] loss=0.4506, metrics:accuracy:540.0000
INFO:root:19:54:46 [Batch 80/250] loss=0.4474, metrics:accuracy:580.0000
INFO:root:19:54:47 [Batch 120/250] loss=0.4536, metrics:accuracy:620.0000
INFO:root:19:54:48 [Batch 160/250] loss=0.4920, metrics:accuracy:660.0000
INFO:root:19:54:49 [Batch 200/250] loss=0.4797, metrics:accuracy:700.0000
INFO:root:19:54:50 [Batch 240/250] loss=0.5386, metrics:accuracy:740.0000
INFO:root:19:54:50 validation metrics:accuracy:0.7750
INFO:root:19:54:50 Time cost=5.17s, throughput=387.07 samples/s
INFO:root:19:54:51 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:19:54:51 Time cost=32.03s
INFO:root:19:54:56 [Epoch 4 Batch 40/254] loss=0.4174, lr=0.0000151, metrics:accuracy:0.8078
INFO:root:19:54:59 [Epoch 4 Batch 80/254] loss=0.4196, lr=0.0000147, metrics:accuracy:0.8049
INFO:root:19:55:03 [Epoch 4 Batch 120/254] loss=0.4437, lr=0.0000144, metrics:accuracy:0.8001
INFO:root:19:55:07 [Epoch 4 Batch 160/254] loss=0.4529, lr=0.0000140, metrics:accuracy:0.7951
INFO:root:19:55:11 [Epoch 4 Batch 200/254] loss=0.4224, lr=0.0000137, metrics:accuracy:0.7994
INFO:root:19:55:15 [Epoch 4 Batch 240/254] loss=0.4309, lr=0.0000133, metrics:accuracy:0.8012
INFO:root:19:55:16 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:55:17 [Batch 40/250] loss=0.4662, metrics:accuracy:790.0000
INFO:root:19:55:18 [Batch 80/250] loss=0.4872, metrics:accuracy:830.0000
INFO:root:19:55:19 [Batch 120/250] loss=0.4482, metrics:accuracy:870.0000
INFO:root:19:55:19 [Batch 160/250] loss=0.4726, metrics:accuracy:910.0000
INFO:root:19:55:20 [Batch 200/250] loss=0.4777, metrics:accuracy:950.0000
INFO:root:19:55:21 [Batch 240/250] loss=0.5271, metrics:accuracy:990.0000
INFO:root:19:55:21 validation metrics:accuracy:0.7830
INFO:root:19:55:21 Time cost=5.37s, throughput=372.43 samples/s
INFO:root:19:55:23 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:19:55:23 Time cost=31.43s
INFO:root:19:55:27 [Epoch 5 Batch 40/254] loss=0.3793, lr=0.0000128, metrics:accuracy:0.8359
INFO:root:19:55:31 [Epoch 5 Batch 80/254] loss=0.3901, lr=0.0000125, metrics:accuracy:0.8297
INFO:root:19:55:35 [Epoch 5 Batch 120/254] loss=0.4274, lr=0.0000121, metrics:accuracy:0.8206
INFO:root:19:55:38 [Epoch 5 Batch 160/254] loss=0.4132, lr=0.0000118, metrics:accuracy:0.8171
INFO:root:19:55:42 [Epoch 5 Batch 200/254] loss=0.4288, lr=0.0000114, metrics:accuracy:0.8150
INFO:root:19:55:46 [Epoch 5 Batch 240/254] loss=0.3819, lr=0.0000111, metrics:accuracy:0.8150
INFO:root:19:55:47 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:55:48 [Batch 40/250] loss=0.4842, metrics:accuracy:1040.0000
INFO:root:19:55:49 [Batch 80/250] loss=0.5016, metrics:accuracy:1080.0000
INFO:root:19:55:50 [Batch 120/250] loss=0.4468, metrics:accuracy:1120.0000
INFO:root:19:55:50 [Batch 160/250] loss=0.4885, metrics:accuracy:1160.0000
INFO:root:19:55:51 [Batch 200/250] loss=0.4730, metrics:accuracy:1200.0000
INFO:root:19:55:52 [Batch 240/250] loss=0.5379, metrics:accuracy:1240.0000
INFO:root:19:55:52 validation metrics:accuracy:0.7845
INFO:root:19:55:52 Time cost=5.24s, throughput=381.99 samples/s
INFO:root:19:55:54 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:19:55:54 Time cost=31.05s
INFO:root:19:55:58 [Epoch 6 Batch 40/254] loss=0.3965, lr=0.0000106, metrics:accuracy:0.8204
INFO:root:19:56:02 [Epoch 6 Batch 80/254] loss=0.3694, lr=0.0000102, metrics:accuracy:0.8287
INFO:root:19:56:05 [Epoch 6 Batch 120/254] loss=0.3709, lr=0.0000099, metrics:accuracy:0.8296
INFO:root:19:56:09 [Epoch 6 Batch 160/254] loss=0.3657, lr=0.0000095, metrics:accuracy:0.8305
INFO:root:19:56:13 [Epoch 6 Batch 200/254] loss=0.3669, lr=0.0000092, metrics:accuracy:0.8314
INFO:root:19:56:17 [Epoch 6 Batch 240/254] loss=0.3598, lr=0.0000088, metrics:accuracy:0.8340
INFO:root:19:56:18 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:56:19 [Batch 40/250] loss=0.4464, metrics:accuracy:1290.0000
INFO:root:19:56:20 [Batch 80/250] loss=0.4787, metrics:accuracy:1330.0000
INFO:root:19:56:21 [Batch 120/250] loss=0.4753, metrics:accuracy:1370.0000
INFO:root:19:56:22 [Batch 160/250] loss=0.4823, metrics:accuracy:1410.0000
INFO:root:19:56:22 [Batch 200/250] loss=0.4811, metrics:accuracy:1450.0000
INFO:root:19:56:23 [Batch 240/250] loss=0.5706, metrics:accuracy:1490.0000
INFO:root:19:56:23 validation metrics:accuracy:0.7780
INFO:root:19:56:23 Time cost=5.03s, throughput=397.49 samples/s
INFO:root:19:56:24 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:19:56:24 Time cost=30.28s
INFO:root:19:56:28 [Epoch 7 Batch 40/254] loss=0.3491, lr=0.0000083, metrics:accuracy:0.8441
INFO:root:19:56:31 [Epoch 7 Batch 80/254] loss=0.3424, lr=0.0000080, metrics:accuracy:0.8427
INFO:root:19:56:35 [Epoch 7 Batch 120/254] loss=0.3693, lr=0.0000076, metrics:accuracy:0.8422
INFO:root:19:56:39 [Epoch 7 Batch 160/254] loss=0.3237, lr=0.0000073, metrics:accuracy:0.8460
INFO:root:19:56:43 [Epoch 7 Batch 200/254] loss=0.3613, lr=0.0000069, metrics:accuracy:0.8461
INFO:root:19:56:46 [Epoch 7 Batch 240/254] loss=0.3444, lr=0.0000066, metrics:accuracy:0.8443
INFO:root:19:56:47 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:56:48 [Batch 40/250] loss=0.4802, metrics:accuracy:1540.0000
INFO:root:19:56:49 [Batch 80/250] loss=0.4540, metrics:accuracy:1580.0000
INFO:root:19:56:50 [Batch 120/250] loss=0.4985, metrics:accuracy:1620.0000
INFO:root:19:56:50 [Batch 160/250] loss=0.4846, metrics:accuracy:1660.0000
INFO:root:19:56:51 [Batch 200/250] loss=0.4586, metrics:accuracy:1700.0000
INFO:root:19:56:52 [Batch 240/250] loss=0.5392, metrics:accuracy:1740.0000
INFO:root:19:56:52 validation metrics:accuracy:0.8010
INFO:root:19:56:52 Time cost=4.92s, throughput=406.71 samples/s
INFO:root:19:56:53 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:19:56:53 Time cost=28.72s
INFO:root:19:56:54 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=5, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:19:56:57 [Epoch 8 Batch 40/254] loss=0.3680, lr=0.0000061, metrics:accuracy:0.8288
INFO:root:19:57:00 [Epoch 8 Batch 80/254] loss=0.3371, lr=0.0000057, metrics:accuracy:0.8399
INFO:root:19:57:04 [Epoch 8 Batch 120/254] loss=0.2788, lr=0.0000054, metrics:accuracy:0.8530
INFO:root:19:57:07 [Epoch 8 Batch 160/254] loss=0.3277, lr=0.0000050, metrics:accuracy:0.8534
INFO:root:19:57:11 [Epoch 8 Batch 200/254] loss=0.3209, lr=0.0000046, metrics:accuracy:0.8561
INFO:root:19:57:15 [Epoch 8 Batch 240/254] loss=0.3286, lr=0.0000043, metrics:accuracy:0.8557
INFO:root:19:57:16 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:57:17 [Batch 40/250] loss=0.4948, metrics:accuracy:1790.0000
INFO:root:19:57:18 [Batch 80/250] loss=0.4792, metrics:accuracy:1830.0000
INFO:root:19:57:19 [Batch 120/250] loss=0.5001, metrics:accuracy:1870.0000
INFO:root:19:57:20 [Batch 160/250] loss=0.4990, metrics:accuracy:1910.0000
INFO:root:19:57:20 [Batch 200/250] loss=0.4632, metrics:accuracy:1950.0000
INFO:root:19:57:21 [Batch 240/250] loss=0.5527, metrics:accuracy:1990.0000
INFO:root:19:57:21 validation metrics:accuracy:0.7875
INFO:root:19:57:21 Time cost=5.13s, throughput=390.17 samples/s
INFO:root:19:57:22 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:19:57:22 Time cost=29.16s
INFO:root:19:57:26 [Epoch 9 Batch 40/254] loss=0.3097, lr=0.0000038, metrics:accuracy:0.8689
INFO:root:19:57:30 [Epoch 9 Batch 80/254] loss=0.3447, lr=0.0000035, metrics:accuracy:0.8614
INFO:root:19:57:33 [Epoch 9 Batch 120/254] loss=0.2918, lr=0.0000031, metrics:accuracy:0.8680
INFO:root:19:57:37 [Epoch 9 Batch 160/254] loss=0.2885, lr=0.0000027, metrics:accuracy:0.8693
INFO:root:19:57:41 [Epoch 9 Batch 200/254] loss=0.3184, lr=0.0000024, metrics:accuracy:0.8683
INFO:root:19:57:44 [Epoch 9 Batch 240/254] loss=0.2819, lr=0.0000020, metrics:accuracy:0.8697
INFO:root:19:57:46 Now we are doing evaluation on dev with gpu(0).
INFO:root:19:57:46 [Batch 40/250] loss=0.5223, metrics:accuracy:2040.0000
INFO:root:19:57:58 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:20:04:31 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:20:04:36 processing dataset...
INFO:root:20:04:37 Now we are doing BERT classification training on gpu(0)!
INFO:root:20:04:37 training steps=2500
INFO:root:20:04:41 [Epoch 1 Batch 40/254] loss=0.6801, lr=0.0000031, metrics:accuracy:0.5792
INFO:root:20:04:45 [Epoch 1 Batch 80/254] loss=0.5912, lr=0.0000063, metrics:accuracy:0.6144
INFO:root:20:04:49 [Epoch 1 Batch 120/254] loss=0.6044, lr=0.0000095, metrics:accuracy:0.6367
INFO:root:20:04:53 [Epoch 1 Batch 160/254] loss=0.5882, lr=0.0000127, metrics:accuracy:0.6530
INFO:root:20:04:56 [Epoch 1 Batch 200/254] loss=0.6041, lr=0.0000159, metrics:accuracy:0.6608
INFO:root:20:05:00 [Epoch 1 Batch 240/254] loss=0.5543, lr=0.0000191, metrics:accuracy:0.6715
INFO:root:20:05:01 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:05:02 [Batch 40/250] loss=0.6128, metrics:accuracy:40.0000
INFO:root:20:05:03 [Batch 80/250] loss=0.6305, metrics:accuracy:80.0000
INFO:root:20:05:04 [Batch 120/250] loss=0.5689, metrics:accuracy:120.0000
INFO:root:20:05:04 [Batch 160/250] loss=0.6400, metrics:accuracy:160.0000
INFO:root:20:05:05 [Batch 200/250] loss=0.6116, metrics:accuracy:200.0000
INFO:root:20:05:06 [Batch 240/250] loss=0.6182, metrics:accuracy:240.0000
INFO:root:20:05:06 validation metrics:accuracy:0.7385
INFO:root:20:05:06 Time cost=5.02s, throughput=398.45 samples/s
INFO:root:20:05:08 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:20:05:08 Time cost=30.70s
INFO:root:20:05:12 [Epoch 2 Batch 40/254] loss=0.5579, lr=0.0000196, metrics:accuracy:0.7354
INFO:root:20:05:15 [Epoch 2 Batch 80/254] loss=0.5339, lr=0.0000193, metrics:accuracy:0.7349
INFO:root:20:05:19 [Epoch 2 Batch 120/254] loss=0.5352, lr=0.0000189, metrics:accuracy:0.7273
INFO:root:20:05:22 [Epoch 2 Batch 160/254] loss=0.5359, lr=0.0000186, metrics:accuracy:0.7241
INFO:root:20:05:26 [Epoch 2 Batch 200/254] loss=0.5013, lr=0.0000182, metrics:accuracy:0.7313
INFO:root:20:05:30 [Epoch 2 Batch 240/254] loss=0.5241, lr=0.0000178, metrics:accuracy:0.7342
INFO:root:20:05:31 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:05:32 [Batch 40/250] loss=0.4960, metrics:accuracy:290.0000
INFO:root:20:05:33 [Batch 80/250] loss=0.4599, metrics:accuracy:330.0000
INFO:root:20:05:34 [Batch 120/250] loss=0.4726, metrics:accuracy:370.0000
INFO:root:20:05:35 [Batch 160/250] loss=0.4993, metrics:accuracy:410.0000
INFO:root:20:05:35 [Batch 200/250] loss=0.4698, metrics:accuracy:450.0000
INFO:root:20:05:36 [Batch 240/250] loss=0.5048, metrics:accuracy:490.0000
INFO:root:20:05:36 validation metrics:accuracy:0.7690
INFO:root:20:05:36 Time cost=4.96s, throughput=402.84 samples/s
INFO:root:20:05:38 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:20:05:38 Time cost=30.23s
INFO:root:20:05:42 [Epoch 3 Batch 40/254] loss=0.4952, lr=0.0000174, metrics:accuracy:0.7576
INFO:root:20:05:45 [Epoch 3 Batch 80/254] loss=0.4921, lr=0.0000170, metrics:accuracy:0.7535
INFO:root:20:05:49 [Epoch 3 Batch 120/254] loss=0.4700, lr=0.0000166, metrics:accuracy:0.7624
INFO:root:20:05:53 [Epoch 3 Batch 160/254] loss=0.4685, lr=0.0000163, metrics:accuracy:0.7700
INFO:root:20:05:57 [Epoch 3 Batch 200/254] loss=0.4524, lr=0.0000159, metrics:accuracy:0.7737
INFO:root:20:06:00 [Epoch 3 Batch 240/254] loss=0.4739, lr=0.0000156, metrics:accuracy:0.7754
INFO:root:20:06:02 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:06:03 [Batch 40/250] loss=0.4506, metrics:accuracy:540.0000
INFO:root:20:06:03 [Batch 80/250] loss=0.4474, metrics:accuracy:580.0000
INFO:root:20:06:04 [Batch 120/250] loss=0.4536, metrics:accuracy:620.0000
INFO:root:20:06:05 [Batch 160/250] loss=0.4920, metrics:accuracy:660.0000
INFO:root:20:06:06 [Batch 200/250] loss=0.4797, metrics:accuracy:700.0000
INFO:root:20:06:07 [Batch 240/250] loss=0.5386, metrics:accuracy:740.0000
INFO:root:20:06:07 validation metrics:accuracy:0.7750
INFO:root:20:06:07 Time cost=4.98s, throughput=401.98 samples/s
INFO:root:20:06:09 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:20:06:09 Time cost=30.65s
INFO:root:20:06:13 [Epoch 4 Batch 40/254] loss=0.4174, lr=0.0000151, metrics:accuracy:0.8078
INFO:root:20:06:17 [Epoch 4 Batch 80/254] loss=0.4196, lr=0.0000147, metrics:accuracy:0.8049
INFO:root:20:06:20 [Epoch 4 Batch 120/254] loss=0.4437, lr=0.0000144, metrics:accuracy:0.8001
INFO:root:20:06:24 [Epoch 4 Batch 160/254] loss=0.4529, lr=0.0000140, metrics:accuracy:0.7951
INFO:root:20:06:27 [Epoch 4 Batch 200/254] loss=0.4224, lr=0.0000137, metrics:accuracy:0.7994
INFO:root:20:06:31 [Epoch 4 Batch 240/254] loss=0.4309, lr=0.0000133, metrics:accuracy:0.8012
INFO:root:20:06:32 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:06:33 [Batch 40/250] loss=0.4662, metrics:accuracy:790.0000
INFO:root:20:06:34 [Batch 80/250] loss=0.4872, metrics:accuracy:830.0000
INFO:root:20:06:34 [Batch 120/250] loss=0.4482, metrics:accuracy:870.0000
INFO:root:20:06:35 [Batch 160/250] loss=0.4726, metrics:accuracy:910.0000
INFO:root:20:06:36 [Batch 200/250] loss=0.4777, metrics:accuracy:950.0000
INFO:root:20:06:37 [Batch 240/250] loss=0.5271, metrics:accuracy:990.0000
INFO:root:20:06:37 validation metrics:accuracy:0.7830
INFO:root:20:06:37 Time cost=4.91s, throughput=406.95 samples/s
INFO:root:20:06:38 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:20:06:38 Time cost=29.82s
INFO:root:20:06:42 [Epoch 5 Batch 40/254] loss=0.3793, lr=0.0000128, metrics:accuracy:0.8359
INFO:root:20:06:46 [Epoch 5 Batch 80/254] loss=0.3901, lr=0.0000125, metrics:accuracy:0.8297
INFO:root:20:06:50 [Epoch 5 Batch 120/254] loss=0.4274, lr=0.0000121, metrics:accuracy:0.8206
INFO:root:20:06:53 [Epoch 5 Batch 160/254] loss=0.4132, lr=0.0000118, metrics:accuracy:0.8171
INFO:root:20:06:57 [Epoch 5 Batch 200/254] loss=0.4288, lr=0.0000114, metrics:accuracy:0.8150
INFO:root:20:07:01 [Epoch 5 Batch 240/254] loss=0.3819, lr=0.0000111, metrics:accuracy:0.8150
INFO:root:20:07:02 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:07:03 [Batch 40/250] loss=0.4842, metrics:accuracy:1040.0000
INFO:root:20:07:04 [Batch 80/250] loss=0.5016, metrics:accuracy:1080.0000
INFO:root:20:07:05 [Batch 120/250] loss=0.4468, metrics:accuracy:1120.0000
INFO:root:20:07:05 [Batch 160/250] loss=0.4885, metrics:accuracy:1160.0000
INFO:root:20:07:06 [Batch 200/250] loss=0.4730, metrics:accuracy:1200.0000
INFO:root:20:07:07 [Batch 240/250] loss=0.5379, metrics:accuracy:1240.0000
INFO:root:20:07:07 validation metrics:accuracy:0.7845
INFO:root:20:07:07 Time cost=5.06s, throughput=395.61 samples/s
INFO:root:20:07:12 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:20:07:12 Time cost=33.13s
INFO:root:20:07:16 [Epoch 6 Batch 40/254] loss=0.3965, lr=0.0000106, metrics:accuracy:0.8204
INFO:root:20:07:19 [Epoch 6 Batch 80/254] loss=0.3694, lr=0.0000102, metrics:accuracy:0.8287
INFO:root:20:07:23 [Epoch 6 Batch 120/254] loss=0.3709, lr=0.0000099, metrics:accuracy:0.8296
INFO:root:20:07:27 [Epoch 6 Batch 160/254] loss=0.3657, lr=0.0000095, metrics:accuracy:0.8305
INFO:root:20:07:30 [Epoch 6 Batch 200/254] loss=0.3669, lr=0.0000092, metrics:accuracy:0.8314
INFO:root:20:07:35 [Epoch 6 Batch 240/254] loss=0.3598, lr=0.0000088, metrics:accuracy:0.8340
INFO:root:20:07:36 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:07:37 [Batch 40/250] loss=0.4464, metrics:accuracy:1290.0000
INFO:root:20:07:37 [Batch 80/250] loss=0.4787, metrics:accuracy:1330.0000
INFO:root:20:07:38 [Batch 120/250] loss=0.4753, metrics:accuracy:1370.0000
INFO:root:20:07:39 [Batch 160/250] loss=0.4823, metrics:accuracy:1410.0000
INFO:root:20:07:40 [Batch 200/250] loss=0.4811, metrics:accuracy:1450.0000
INFO:root:20:07:41 [Batch 240/250] loss=0.5706, metrics:accuracy:1490.0000
INFO:root:20:07:41 validation metrics:accuracy:0.7780
INFO:root:20:07:41 Time cost=5.00s, throughput=400.39 samples/s
INFO:root:20:07:43 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:20:07:43 Time cost=31.84s
INFO:root:20:07:47 [Epoch 7 Batch 40/254] loss=0.3491, lr=0.0000083, metrics:accuracy:0.8441
INFO:root:20:07:51 [Epoch 7 Batch 80/254] loss=0.3424, lr=0.0000080, metrics:accuracy:0.8427
INFO:root:20:07:55 [Epoch 7 Batch 120/254] loss=0.3693, lr=0.0000076, metrics:accuracy:0.8422
INFO:root:20:07:59 [Epoch 7 Batch 160/254] loss=0.3237, lr=0.0000073, metrics:accuracy:0.8460
INFO:root:20:08:03 [Epoch 7 Batch 200/254] loss=0.3613, lr=0.0000069, metrics:accuracy:0.8461
INFO:root:20:08:06 [Epoch 7 Batch 240/254] loss=0.3444, lr=0.0000066, metrics:accuracy:0.8443
INFO:root:20:08:07 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:08:08 [Batch 40/250] loss=0.4802, metrics:accuracy:1540.0000
INFO:root:20:08:09 [Batch 80/250] loss=0.4540, metrics:accuracy:1580.0000
INFO:root:20:08:10 [Batch 120/250] loss=0.4985, metrics:accuracy:1620.0000
INFO:root:20:08:11 [Batch 160/250] loss=0.4846, metrics:accuracy:1660.0000
INFO:root:20:08:11 [Batch 200/250] loss=0.4586, metrics:accuracy:1700.0000
INFO:root:20:08:12 [Batch 240/250] loss=0.5392, metrics:accuracy:1740.0000
INFO:root:20:08:12 validation metrics:accuracy:0.8010
INFO:root:20:08:12 Time cost=4.94s, throughput=404.77 samples/s
INFO:root:20:08:15 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:20:08:15 Time cost=31.38s
INFO:root:20:08:18 [Epoch 8 Batch 40/254] loss=0.3680, lr=0.0000061, metrics:accuracy:0.8288
INFO:root:20:08:22 [Epoch 8 Batch 80/254] loss=0.3371, lr=0.0000057, metrics:accuracy:0.8399
INFO:root:20:08:26 [Epoch 8 Batch 120/254] loss=0.2788, lr=0.0000054, metrics:accuracy:0.8530
INFO:root:20:08:30 [Epoch 8 Batch 160/254] loss=0.3277, lr=0.0000050, metrics:accuracy:0.8534
INFO:root:20:08:34 [Epoch 8 Batch 200/254] loss=0.3209, lr=0.0000046, metrics:accuracy:0.8561
INFO:root:20:08:38 [Epoch 8 Batch 240/254] loss=0.3286, lr=0.0000043, metrics:accuracy:0.8557
INFO:root:20:08:39 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:08:40 [Batch 40/250] loss=0.4948, metrics:accuracy:1790.0000
INFO:root:20:08:40 [Batch 80/250] loss=0.4792, metrics:accuracy:1830.0000
INFO:root:20:08:41 [Batch 120/250] loss=0.5001, metrics:accuracy:1870.0000
INFO:root:20:08:42 [Batch 160/250] loss=0.4990, metrics:accuracy:1910.0000
INFO:root:20:08:43 [Batch 200/250] loss=0.4632, metrics:accuracy:1950.0000
INFO:root:20:08:44 [Batch 240/250] loss=0.5527, metrics:accuracy:1990.0000
INFO:root:20:08:44 validation metrics:accuracy:0.7875
INFO:root:20:08:44 Time cost=4.98s, throughput=401.67 samples/s
INFO:root:20:08:45 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:20:08:45 Time cost=30.68s
INFO:root:20:08:49 [Epoch 9 Batch 40/254] loss=0.3097, lr=0.0000038, metrics:accuracy:0.8689
INFO:root:20:08:53 [Epoch 9 Batch 80/254] loss=0.3447, lr=0.0000035, metrics:accuracy:0.8614
INFO:root:20:08:57 [Epoch 9 Batch 120/254] loss=0.2918, lr=0.0000031, metrics:accuracy:0.8680
INFO:root:20:09:01 [Epoch 9 Batch 160/254] loss=0.2885, lr=0.0000027, metrics:accuracy:0.8693
INFO:root:20:09:04 [Epoch 9 Batch 200/254] loss=0.3184, lr=0.0000024, metrics:accuracy:0.8683
INFO:root:20:09:08 [Epoch 9 Batch 240/254] loss=0.2819, lr=0.0000020, metrics:accuracy:0.8697
INFO:root:20:09:09 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:09:10 [Batch 40/250] loss=0.5223, metrics:accuracy:2040.0000
INFO:root:20:09:11 [Batch 80/250] loss=0.5194, metrics:accuracy:2080.0000
INFO:root:20:09:12 [Batch 120/250] loss=0.5087, metrics:accuracy:2120.0000
INFO:root:20:09:13 [Batch 160/250] loss=0.5249, metrics:accuracy:2160.0000
INFO:root:20:09:14 [Batch 200/250] loss=0.5112, metrics:accuracy:2200.0000
INFO:root:20:09:14 [Batch 240/250] loss=0.6073, metrics:accuracy:2240.0000
INFO:root:20:09:15 validation metrics:accuracy:0.7835
INFO:root:20:09:15 Time cost=5.01s, throughput=399.32 samples/s
INFO:root:20:09:15 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:20:09:15 Time cost=29.76s
INFO:root:20:09:19 [Epoch 10 Batch 40/254] loss=0.3079, lr=0.0000016, metrics:accuracy:0.8557
INFO:root:20:09:23 [Epoch 10 Batch 80/254] loss=0.2705, lr=0.0000012, metrics:accuracy:0.8696
INFO:root:20:09:27 [Epoch 10 Batch 120/254] loss=0.2889, lr=0.0000008, metrics:accuracy:0.8733
INFO:root:20:09:30 [Epoch 10 Batch 160/254] loss=0.3320, lr=0.0000005, metrics:accuracy:0.8684
INFO:root:20:09:34 [Epoch 10 Batch 200/254] loss=0.3013, lr=0.0000001, metrics:accuracy:0.8678
INFO:root:20:09:35 Finish training step: 2500
INFO:root:20:09:35 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:09:36 [Batch 40/250] loss=0.5282, metrics:accuracy:2290.0000
INFO:root:20:09:37 [Batch 80/250] loss=0.5107, metrics:accuracy:2330.0000
INFO:root:20:09:38 [Batch 120/250] loss=0.5134, metrics:accuracy:2370.0000
INFO:root:20:09:38 [Batch 160/250] loss=0.5164, metrics:accuracy:2410.0000
INFO:root:20:09:39 [Batch 200/250] loss=0.5009, metrics:accuracy:2450.0000
INFO:root:20:09:40 [Batch 240/250] loss=0.5935, metrics:accuracy:2490.0000
INFO:root:20:09:40 validation metrics:accuracy:0.7885
INFO:root:20:09:40 Time cost=5.00s, throughput=400.10 samples/s
INFO:root:20:09:42 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:20:09:42 Time cost=26.70s
INFO:root:20:09:42 Best model at epoch 6. Validation metrics:accuracy:0.8010
INFO:root:20:09:42 Now we are doing testing on test with gpu(0).
INFO:root:20:09:47 Time cost=4.84s, throughput=411.97 samples/s
INFO:root:20:11:35 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=0.0002, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:20:11:40 processing dataset...
INFO:root:20:11:41 Now we are doing BERT classification training on gpu(0)!
INFO:root:20:11:41 training steps=2500
INFO:root:20:11:46 [Epoch 1 Batch 40/254] loss=0.6708, lr=0.0000312, metrics:accuracy:0.6183
INFO:root:20:11:49 [Epoch 1 Batch 80/254] loss=0.6399, lr=0.0000632, metrics:accuracy:0.6291
INFO:root:20:11:53 [Epoch 1 Batch 120/254] loss=0.6152, lr=0.0000952, metrics:accuracy:0.6367
INFO:root:20:11:57 [Epoch 1 Batch 160/254] loss=0.6890, lr=0.0001272, metrics:accuracy:0.6355
INFO:root:20:12:00 [Epoch 1 Batch 200/254] loss=0.6998, lr=0.0001592, metrics:accuracy:0.6203
INFO:root:20:12:04 [Epoch 1 Batch 240/254] loss=0.6557, lr=0.0001912, metrics:accuracy:0.6243
INFO:root:20:12:05 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:12:06 [Batch 40/250] loss=0.6442, metrics:accuracy:40.0000
INFO:root:20:12:07 [Batch 80/250] loss=0.6237, metrics:accuracy:80.0000
INFO:root:20:12:08 [Batch 120/250] loss=0.6817, metrics:accuracy:120.0000
INFO:root:20:12:08 [Batch 160/250] loss=0.6578, metrics:accuracy:160.0000
INFO:root:20:12:09 [Batch 200/250] loss=0.6203, metrics:accuracy:200.0000
INFO:root:20:12:10 [Batch 240/250] loss=0.6510, metrics:accuracy:240.0000
INFO:root:20:12:10 validation metrics:accuracy:0.6750
INFO:root:20:12:10 Time cost=5.13s, throughput=389.54 samples/s
INFO:root:20:12:12 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:20:12:12 Time cost=30.74s
INFO:root:20:12:16 [Epoch 2 Batch 40/254] loss=0.6535, lr=0.0001962, metrics:accuracy:0.6690
INFO:root:20:12:19 [Epoch 2 Batch 80/254] loss=0.6840, lr=0.0001926, metrics:accuracy:0.6489
INFO:root:20:12:23 [Epoch 2 Batch 120/254] loss=0.6477, lr=0.0001891, metrics:accuracy:0.6508
INFO:root:20:12:27 [Epoch 2 Batch 160/254] loss=0.6445, lr=0.0001855, metrics:accuracy:0.6553
INFO:root:20:12:30 [Epoch 2 Batch 200/254] loss=0.6548, lr=0.0001820, metrics:accuracy:0.6553
INFO:root:20:12:34 [Epoch 2 Batch 240/254] loss=0.6599, lr=0.0001784, metrics:accuracy:0.6542
INFO:root:20:12:35 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:12:36 [Batch 40/250] loss=0.6458, metrics:accuracy:290.0000
INFO:root:20:12:37 [Batch 80/250] loss=0.6249, metrics:accuracy:330.0000
INFO:root:20:12:38 [Batch 120/250] loss=0.6840, metrics:accuracy:370.0000
INFO:root:20:12:39 [Batch 160/250] loss=0.6597, metrics:accuracy:410.0000
INFO:root:20:12:39 [Batch 200/250] loss=0.6214, metrics:accuracy:450.0000
INFO:root:20:12:40 [Batch 240/250] loss=0.6527, metrics:accuracy:490.0000
INFO:root:20:12:40 validation metrics:accuracy:0.6750
INFO:root:20:12:40 Time cost=5.13s, throughput=389.74 samples/s
INFO:root:20:12:42 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:20:12:42 Time cost=29.99s
INFO:root:20:12:46 [Epoch 3 Batch 40/254] loss=0.6422, lr=0.0001736, metrics:accuracy:0.6664
INFO:root:20:12:49 [Epoch 3 Batch 80/254] loss=0.6668, lr=0.0001700, metrics:accuracy:0.6426
INFO:root:20:12:53 [Epoch 3 Batch 120/254] loss=0.6367, lr=0.0001665, metrics:accuracy:0.6521
INFO:root:20:12:57 [Epoch 3 Batch 160/254] loss=0.6281, lr=0.0001629, metrics:accuracy:0.6615
INFO:root:20:13:01 [Epoch 3 Batch 200/254] loss=0.6218, lr=0.0001594, metrics:accuracy:0.6694
INFO:root:20:13:04 [Epoch 3 Batch 240/254] loss=0.6583, lr=0.0001558, metrics:accuracy:0.6671
INFO:root:20:13:05 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:13:06 [Batch 40/250] loss=0.6311, metrics:accuracy:540.0000
INFO:root:20:13:07 [Batch 80/250] loss=0.6187, metrics:accuracy:580.0000
INFO:root:20:13:08 [Batch 120/250] loss=0.6538, metrics:accuracy:620.0000
INFO:root:20:13:09 [Batch 160/250] loss=0.6394, metrics:accuracy:660.0000
INFO:root:20:13:10 [Batch 200/250] loss=0.6167, metrics:accuracy:700.0000
INFO:root:20:13:10 [Batch 240/250] loss=0.6353, metrics:accuracy:740.0000
INFO:root:20:13:11 validation metrics:accuracy:0.6750
INFO:root:20:13:11 Time cost=5.10s, throughput=392.54 samples/s
INFO:root:20:13:12 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:20:13:12 Time cost=30.30s
INFO:root:20:13:16 [Epoch 4 Batch 40/254] loss=0.6387, lr=0.0001510, metrics:accuracy:0.6727
INFO:root:20:13:20 [Epoch 4 Batch 80/254] loss=0.6270, lr=0.0001475, metrics:accuracy:0.6751
INFO:root:20:13:24 [Epoch 4 Batch 120/254] loss=0.6558, lr=0.0001439, metrics:accuracy:0.6665
INFO:root:20:13:27 [Epoch 4 Batch 160/254] loss=0.6537, lr=0.0001404, metrics:accuracy:0.6615
INFO:root:20:13:31 [Epoch 4 Batch 200/254] loss=0.6299, lr=0.0001368, metrics:accuracy:0.6641
INFO:root:20:13:35 [Epoch 4 Batch 240/254] loss=0.6275, lr=0.0001332, metrics:accuracy:0.6670
INFO:root:20:13:36 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:13:37 [Batch 40/250] loss=0.6346, metrics:accuracy:790.0000
INFO:root:20:13:37 [Batch 80/250] loss=0.6244, metrics:accuracy:830.0000
INFO:root:20:13:38 [Batch 120/250] loss=0.6532, metrics:accuracy:870.0000
INFO:root:20:13:39 [Batch 160/250] loss=0.6413, metrics:accuracy:910.0000
INFO:root:20:13:40 [Batch 200/250] loss=0.6227, metrics:accuracy:950.0000
INFO:root:20:13:41 [Batch 240/250] loss=0.6380, metrics:accuracy:990.0000
INFO:root:20:13:41 validation metrics:accuracy:0.6750
INFO:root:20:13:41 Time cost=5.27s, throughput=379.41 samples/s
INFO:root:20:13:43 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:20:13:43 Time cost=30.42s
INFO:root:20:13:47 [Epoch 5 Batch 40/254] loss=0.6261, lr=0.0001284, metrics:accuracy:0.6891
INFO:root:20:13:51 [Epoch 5 Batch 80/254] loss=0.6417, lr=0.0001249, metrics:accuracy:0.6764
INFO:root:20:13:54 [Epoch 5 Batch 120/254] loss=0.6528, lr=0.0001213, metrics:accuracy:0.6655
INFO:root:20:13:57 [Epoch 5 Batch 160/254] loss=0.6504, lr=0.0001178, metrics:accuracy:0.6617
INFO:root:20:14:01 [Epoch 5 Batch 200/254] loss=0.6267, lr=0.0001142, metrics:accuracy:0.6651
INFO:root:20:14:05 [Epoch 5 Batch 240/254] loss=0.6415, lr=0.0001107, metrics:accuracy:0.6633
INFO:root:20:14:06 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:14:07 [Batch 40/250] loss=0.6328, metrics:accuracy:1040.0000
INFO:root:20:14:08 [Batch 80/250] loss=0.6218, metrics:accuracy:1080.0000
INFO:root:20:14:09 [Batch 120/250] loss=0.6531, metrics:accuracy:1120.0000
INFO:root:20:14:10 [Batch 160/250] loss=0.6402, metrics:accuracy:1160.0000
INFO:root:20:14:10 [Batch 200/250] loss=0.6199, metrics:accuracy:1200.0000
INFO:root:20:14:11 [Batch 240/250] loss=0.6365, metrics:accuracy:1240.0000
INFO:root:20:14:11 validation metrics:accuracy:0.6750
INFO:root:20:14:11 Time cost=5.21s, throughput=384.01 samples/s
INFO:root:20:14:13 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:20:14:13 Time cost=30.20s
INFO:root:20:14:17 [Epoch 6 Batch 40/254] loss=0.6410, lr=0.0001059, metrics:accuracy:0.6594
INFO:root:20:14:20 [Epoch 6 Batch 80/254] loss=0.6457, lr=0.0001023, metrics:accuracy:0.6630
INFO:root:20:14:24 [Epoch 6 Batch 120/254] loss=0.6597, lr=0.0000988, metrics:accuracy:0.6568
INFO:root:20:14:28 [Epoch 6 Batch 160/254] loss=0.6327, lr=0.0000952, metrics:accuracy:0.6622
INFO:root:20:14:31 [Epoch 6 Batch 200/254] loss=0.6321, lr=0.0000916, metrics:accuracy:0.6634
INFO:root:20:14:35 [Epoch 6 Batch 240/254] loss=0.6250, lr=0.0000881, metrics:accuracy:0.6677
INFO:root:20:14:36 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:14:37 [Batch 40/250] loss=0.6312, metrics:accuracy:1290.0000
INFO:root:20:14:38 [Batch 80/250] loss=0.6188, metrics:accuracy:1330.0000
INFO:root:20:14:39 [Batch 120/250] loss=0.6538, metrics:accuracy:1370.0000
INFO:root:20:14:40 [Batch 160/250] loss=0.6394, metrics:accuracy:1410.0000
INFO:root:20:14:41 [Batch 200/250] loss=0.6168, metrics:accuracy:1450.0000
INFO:root:20:14:41 [Batch 240/250] loss=0.6353, metrics:accuracy:1490.0000
INFO:root:20:14:42 validation metrics:accuracy:0.6750
INFO:root:20:14:42 Time cost=5.23s, throughput=382.07 samples/s
INFO:root:20:14:43 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:20:14:43 Time cost=30.29s
INFO:root:20:14:47 [Epoch 7 Batch 40/254] loss=0.6245, lr=0.0000833, metrics:accuracy:0.6803
INFO:root:20:14:51 [Epoch 7 Batch 80/254] loss=0.6513, lr=0.0000797, metrics:accuracy:0.6652
INFO:root:20:14:54 [Epoch 7 Batch 120/254] loss=0.6557, lr=0.0000762, metrics:accuracy:0.6574
INFO:root:20:14:58 [Epoch 7 Batch 160/254] loss=0.6192, lr=0.0000726, metrics:accuracy:0.6659
INFO:root:20:15:02 [Epoch 7 Batch 200/254] loss=0.6366, lr=0.0000691, metrics:accuracy:0.6681
INFO:root:20:15:05 [Epoch 7 Batch 240/254] loss=0.6456, lr=0.0000655, metrics:accuracy:0.6655
INFO:root:20:15:07 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:15:07 [Batch 40/250] loss=0.6318, metrics:accuracy:1540.0000
INFO:root:20:15:08 [Batch 80/250] loss=0.6206, metrics:accuracy:1580.0000
INFO:root:20:15:09 [Batch 120/250] loss=0.6522, metrics:accuracy:1620.0000
INFO:root:20:15:10 [Batch 160/250] loss=0.6393, metrics:accuracy:1660.0000
INFO:root:20:15:11 [Batch 200/250] loss=0.6188, metrics:accuracy:1700.0000
INFO:root:20:15:11 [Batch 240/250] loss=0.6355, metrics:accuracy:1740.0000
INFO:root:20:15:12 validation metrics:accuracy:0.6750
INFO:root:20:15:12 Time cost=5.02s, throughput=398.40 samples/s
INFO:root:20:15:16 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:20:15:16 Time cost=32.67s
INFO:root:20:15:20 [Epoch 8 Batch 40/254] loss=0.6503, lr=0.0000607, metrics:accuracy:0.6473
INFO:root:20:15:23 [Epoch 8 Batch 80/254] loss=0.6593, lr=0.0000572, metrics:accuracy:0.6370
INFO:root:20:15:27 [Epoch 8 Batch 120/254] loss=0.6397, lr=0.0000536, metrics:accuracy:0.6453
INFO:root:20:15:31 [Epoch 8 Batch 160/254] loss=0.6614, lr=0.0000500, metrics:accuracy:0.6433
INFO:root:20:15:35 [Epoch 8 Batch 200/254] loss=0.6361, lr=0.0000465, metrics:accuracy:0.6493
INFO:root:20:15:39 [Epoch 8 Batch 240/254] loss=0.6080, lr=0.0000429, metrics:accuracy:0.6588
INFO:root:20:15:40 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:15:41 [Batch 40/250] loss=0.6349, metrics:accuracy:1790.0000
INFO:root:20:15:42 [Batch 80/250] loss=0.6249, metrics:accuracy:1830.0000
INFO:root:20:15:43 [Batch 120/250] loss=0.6533, metrics:accuracy:1870.0000
INFO:root:20:15:43 [Batch 160/250] loss=0.6416, metrics:accuracy:1910.0000
INFO:root:20:15:44 [Batch 200/250] loss=0.6232, metrics:accuracy:1950.0000
INFO:root:20:15:45 [Batch 240/250] loss=0.6383, metrics:accuracy:1990.0000
INFO:root:20:15:45 validation metrics:accuracy:0.6750
INFO:root:20:15:45 Time cost=4.98s, throughput=401.23 samples/s
INFO:root:20:15:48 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:20:15:48 Time cost=32.60s
INFO:root:20:15:52 [Epoch 9 Batch 40/254] loss=0.6492, lr=0.0000381, metrics:accuracy:0.6619
INFO:root:20:15:56 [Epoch 9 Batch 80/254] loss=0.6497, lr=0.0000346, metrics:accuracy:0.6614
INFO:root:20:16:00 [Epoch 9 Batch 120/254] loss=0.6323, lr=0.0000310, metrics:accuracy:0.6678
INFO:root:20:16:04 [Epoch 9 Batch 160/254] loss=0.6524, lr=0.0000275, metrics:accuracy:0.6642
INFO:root:20:16:07 [Epoch 9 Batch 200/254] loss=0.6382, lr=0.0000239, metrics:accuracy:0.6661
INFO:root:20:16:11 [Epoch 9 Batch 240/254] loss=0.6309, lr=0.0000204, metrics:accuracy:0.6659
INFO:root:20:16:13 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:16:13 [Batch 40/250] loss=0.6316, metrics:accuracy:2040.0000
INFO:root:20:16:14 [Batch 80/250] loss=0.6196, metrics:accuracy:2080.0000
INFO:root:20:16:15 [Batch 120/250] loss=0.6535, metrics:accuracy:2120.0000
INFO:root:20:16:16 [Batch 160/250] loss=0.6395, metrics:accuracy:2160.0000
INFO:root:20:16:17 [Batch 200/250] loss=0.6176, metrics:accuracy:2200.0000
INFO:root:20:16:17 [Batch 240/250] loss=0.6355, metrics:accuracy:2240.0000
INFO:root:20:16:18 validation metrics:accuracy:0.6750
INFO:root:20:16:18 Time cost=5.01s, throughput=399.20 samples/s
INFO:root:20:16:19 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:20:16:19 Time cost=30.87s
INFO:root:20:16:23 [Epoch 10 Batch 40/254] loss=0.6456, lr=0.0000156, metrics:accuracy:0.6598
INFO:root:20:16:27 [Epoch 10 Batch 80/254] loss=0.6155, lr=0.0000120, metrics:accuracy:0.6782
INFO:root:20:16:31 [Epoch 10 Batch 120/254] loss=0.6389, lr=0.0000084, metrics:accuracy:0.6735
INFO:root:20:16:35 [Epoch 10 Batch 160/254] loss=0.6522, lr=0.0000049, metrics:accuracy:0.6657
INFO:root:20:16:39 [Epoch 10 Batch 200/254] loss=0.6499, lr=0.0000013, metrics:accuracy:0.6634
INFO:root:20:16:40 Finish training step: 2500
INFO:root:20:16:40 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:16:41 [Batch 40/250] loss=0.6324, metrics:accuracy:2290.0000
INFO:root:20:16:42 [Batch 80/250] loss=0.6211, metrics:accuracy:2330.0000
INFO:root:20:16:43 [Batch 120/250] loss=0.6531, metrics:accuracy:2370.0000
INFO:root:20:16:44 [Batch 160/250] loss=0.6400, metrics:accuracy:2410.0000
INFO:root:20:16:44 [Batch 200/250] loss=0.6193, metrics:accuracy:2450.0000
INFO:root:20:16:45 [Batch 240/250] loss=0.6362, metrics:accuracy:2490.0000
INFO:root:20:16:45 validation metrics:accuracy:0.6750
INFO:root:20:16:45 Time cost=5.35s, throughput=373.67 samples/s
INFO:root:20:16:47 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:20:16:47 Time cost=27.73s
INFO:root:20:16:47 Best model at epoch 0. Validation metrics:accuracy:0.6750
INFO:root:20:16:47 Now we are doing testing on test with gpu(0).
INFO:root:20:16:52 Time cost=4.95s, throughput=402.37 samples/s
INFO:root:20:17:16 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=1e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:20:17:20 processing dataset...
INFO:root:20:17:21 Now we are doing BERT classification training on gpu(0)!
INFO:root:20:17:21 training steps=2500
INFO:root:20:17:26 [Epoch 1 Batch 40/254] loss=0.6866, lr=0.0000016, metrics:accuracy:0.5541
INFO:root:20:17:29 [Epoch 1 Batch 80/254] loss=0.5852, lr=0.0000032, metrics:accuracy:0.6028
INFO:root:20:17:33 [Epoch 1 Batch 120/254] loss=0.5756, lr=0.0000048, metrics:accuracy:0.6327
INFO:root:20:17:36 [Epoch 1 Batch 160/254] loss=0.5737, lr=0.0000064, metrics:accuracy:0.6518
INFO:root:20:17:40 [Epoch 1 Batch 200/254] loss=0.6048, lr=0.0000080, metrics:accuracy:0.6611
INFO:root:20:17:43 [Epoch 1 Batch 240/254] loss=0.5502, lr=0.0000096, metrics:accuracy:0.6737
INFO:root:20:17:45 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:17:45 [Batch 40/250] loss=0.5413, metrics:accuracy:40.0000
INFO:root:20:17:46 [Batch 80/250] loss=0.5435, metrics:accuracy:80.0000
INFO:root:20:17:47 [Batch 120/250] loss=0.5124, metrics:accuracy:120.0000
INFO:root:20:17:48 [Batch 160/250] loss=0.5557, metrics:accuracy:160.0000
INFO:root:20:17:49 [Batch 200/250] loss=0.5532, metrics:accuracy:200.0000
INFO:root:20:17:49 [Batch 240/250] loss=0.5424, metrics:accuracy:240.0000
INFO:root:20:17:50 validation metrics:accuracy:0.7245
INFO:root:20:17:50 Time cost=4.91s, throughput=407.49 samples/s
INFO:root:20:17:51 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:20:17:51 Time cost=29.73s
INFO:root:20:17:55 [Epoch 2 Batch 40/254] loss=0.5401, lr=0.0000098, metrics:accuracy:0.7417
INFO:root:20:17:58 [Epoch 2 Batch 80/254] loss=0.5351, lr=0.0000096, metrics:accuracy:0.7372
INFO:root:20:18:02 [Epoch 2 Batch 120/254] loss=0.5474, lr=0.0000095, metrics:accuracy:0.7315
INFO:root:20:18:06 [Epoch 2 Batch 160/254] loss=0.5396, lr=0.0000093, metrics:accuracy:0.7297
INFO:root:20:18:09 [Epoch 2 Batch 200/254] loss=0.5234, lr=0.0000091, metrics:accuracy:0.7341
INFO:root:20:18:13 [Epoch 2 Batch 240/254] loss=0.5307, lr=0.0000089, metrics:accuracy:0.7358
INFO:root:20:18:14 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:18:15 [Batch 40/250] loss=0.4981, metrics:accuracy:290.0000
INFO:root:20:18:16 [Batch 80/250] loss=0.5010, metrics:accuracy:330.0000
INFO:root:20:18:17 [Batch 120/250] loss=0.4857, metrics:accuracy:370.0000
INFO:root:20:18:18 [Batch 160/250] loss=0.5229, metrics:accuracy:410.0000
INFO:root:20:18:18 [Batch 200/250] loss=0.4829, metrics:accuracy:450.0000
INFO:root:20:18:19 [Batch 240/250] loss=0.5123, metrics:accuracy:490.0000
INFO:root:20:18:19 validation metrics:accuracy:0.7615
INFO:root:20:18:19 Time cost=4.99s, throughput=400.56 samples/s
INFO:root:20:18:21 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:20:18:21 Time cost=30.06s
INFO:root:20:18:25 [Epoch 3 Batch 40/254] loss=0.4916, lr=0.0000087, metrics:accuracy:0.7528
INFO:root:20:18:28 [Epoch 3 Batch 80/254] loss=0.5010, lr=0.0000085, metrics:accuracy:0.7498
INFO:root:20:18:32 [Epoch 3 Batch 120/254] loss=0.4693, lr=0.0000083, metrics:accuracy:0.7582
INFO:root:20:18:36 [Epoch 3 Batch 160/254] loss=0.4746, lr=0.0000081, metrics:accuracy:0.7672
INFO:root:20:18:40 [Epoch 3 Batch 200/254] loss=0.4429, lr=0.0000080, metrics:accuracy:0.7723
INFO:root:20:18:43 [Epoch 3 Batch 240/254] loss=0.4874, lr=0.0000078, metrics:accuracy:0.7712
INFO:root:20:18:44 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:18:45 [Batch 40/250] loss=0.4846, metrics:accuracy:540.0000
INFO:root:20:18:46 [Batch 80/250] loss=0.4585, metrics:accuracy:580.0000
INFO:root:20:18:47 [Batch 120/250] loss=0.4756, metrics:accuracy:620.0000
INFO:root:20:18:48 [Batch 160/250] loss=0.4935, metrics:accuracy:660.0000
INFO:root:20:18:48 [Batch 200/250] loss=0.4935, metrics:accuracy:700.0000
INFO:root:20:18:49 [Batch 240/250] loss=0.5459, metrics:accuracy:740.0000
INFO:root:20:18:49 validation metrics:accuracy:0.7700
INFO:root:20:18:49 Time cost=4.95s, throughput=404.34 samples/s
INFO:root:20:18:51 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:20:18:51 Time cost=29.90s
INFO:root:20:18:55 [Epoch 4 Batch 40/254] loss=0.4459, lr=0.0000076, metrics:accuracy:0.7984
INFO:root:20:18:59 [Epoch 4 Batch 80/254] loss=0.4359, lr=0.0000074, metrics:accuracy:0.7974
INFO:root:20:19:02 [Epoch 4 Batch 120/254] loss=0.4565, lr=0.0000072, metrics:accuracy:0.7935
INFO:root:20:19:06 [Epoch 4 Batch 160/254] loss=0.4723, lr=0.0000070, metrics:accuracy:0.7886
INFO:root:20:19:10 [Epoch 4 Batch 200/254] loss=0.4480, lr=0.0000068, metrics:accuracy:0.7883
INFO:root:20:19:13 [Epoch 4 Batch 240/254] loss=0.4449, lr=0.0000067, metrics:accuracy:0.7900
INFO:root:20:19:14 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:19:15 [Batch 40/250] loss=0.4917, metrics:accuracy:790.0000
INFO:root:20:19:16 [Batch 80/250] loss=0.4854, metrics:accuracy:830.0000
INFO:root:20:19:17 [Batch 120/250] loss=0.4518, metrics:accuracy:870.0000
INFO:root:20:19:18 [Batch 160/250] loss=0.4837, metrics:accuracy:910.0000
INFO:root:20:19:19 [Batch 200/250] loss=0.4832, metrics:accuracy:950.0000
INFO:root:20:19:19 [Batch 240/250] loss=0.5415, metrics:accuracy:990.0000
INFO:root:20:19:19 validation metrics:accuracy:0.7735
INFO:root:20:19:19 Time cost=5.05s, throughput=396.07 samples/s
INFO:root:20:19:21 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:20:19:21 Time cost=29.99s
INFO:root:20:19:25 [Epoch 5 Batch 40/254] loss=0.4053, lr=0.0000064, metrics:accuracy:0.8211
INFO:root:20:19:29 [Epoch 5 Batch 80/254] loss=0.4209, lr=0.0000062, metrics:accuracy:0.8127
INFO:root:20:19:32 [Epoch 5 Batch 120/254] loss=0.4508, lr=0.0000061, metrics:accuracy:0.8080
INFO:root:20:19:36 [Epoch 5 Batch 160/254] loss=0.4455, lr=0.0000059, metrics:accuracy:0.8041
INFO:root:20:19:39 [Epoch 5 Batch 200/254] loss=0.4597, lr=0.0000057, metrics:accuracy:0.8004
INFO:root:20:19:43 [Epoch 5 Batch 240/254] loss=0.3931, lr=0.0000055, metrics:accuracy:0.8032
INFO:root:20:19:44 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:19:45 [Batch 40/250] loss=0.4778, metrics:accuracy:1040.0000
INFO:root:20:19:46 [Batch 80/250] loss=0.4699, metrics:accuracy:1080.0000
INFO:root:20:19:47 [Batch 120/250] loss=0.4664, metrics:accuracy:1120.0000
INFO:root:20:19:47 [Batch 160/250] loss=0.4887, metrics:accuracy:1160.0000
INFO:root:20:19:48 [Batch 200/250] loss=0.4732, metrics:accuracy:1200.0000
INFO:root:20:19:49 [Batch 240/250] loss=0.5140, metrics:accuracy:1240.0000
INFO:root:20:19:49 validation metrics:accuracy:0.7815
INFO:root:20:19:49 Time cost=4.86s, throughput=411.47 samples/s
INFO:root:20:19:51 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:20:19:51 Time cost=29.67s
INFO:root:20:19:54 [Epoch 6 Batch 40/254] loss=0.4169, lr=0.0000053, metrics:accuracy:0.8147
INFO:root:20:19:58 [Epoch 6 Batch 80/254] loss=0.4065, lr=0.0000051, metrics:accuracy:0.8203
INFO:root:20:20:02 [Epoch 6 Batch 120/254] loss=0.4158, lr=0.0000049, metrics:accuracy:0.8161
INFO:root:20:20:05 [Epoch 6 Batch 160/254] loss=0.3802, lr=0.0000048, metrics:accuracy:0.8190
INFO:root:20:20:09 [Epoch 6 Batch 200/254] loss=0.4021, lr=0.0000046, metrics:accuracy:0.8179
INFO:root:20:20:13 [Epoch 6 Batch 240/254] loss=0.3968, lr=0.0000044, metrics:accuracy:0.8176
INFO:root:20:20:14 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:20:15 [Batch 40/250] loss=0.4823, metrics:accuracy:1290.0000
INFO:root:20:20:15 [Batch 80/250] loss=0.4551, metrics:accuracy:1330.0000
INFO:root:20:20:16 [Batch 120/250] loss=0.4663, metrics:accuracy:1370.0000
INFO:root:20:20:17 [Batch 160/250] loss=0.4728, metrics:accuracy:1410.0000
INFO:root:20:20:18 [Batch 200/250] loss=0.4687, metrics:accuracy:1450.0000
INFO:root:20:20:19 [Batch 240/250] loss=0.5239, metrics:accuracy:1490.0000
INFO:root:20:20:19 validation metrics:accuracy:0.7835
INFO:root:20:20:19 Time cost=4.97s, throughput=402.51 samples/s
INFO:root:20:20:20 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:20:20:20 Time cost=29.72s
INFO:root:20:20:24 [Epoch 7 Batch 40/254] loss=0.3950, lr=0.0000042, metrics:accuracy:0.8153
INFO:root:20:20:28 [Epoch 7 Batch 80/254] loss=0.3935, lr=0.0000040, metrics:accuracy:0.8154
INFO:root:20:20:32 [Epoch 7 Batch 120/254] loss=0.4168, lr=0.0000038, metrics:accuracy:0.8178
INFO:root:20:20:36 [Epoch 7 Batch 160/254] loss=0.3623, lr=0.0000036, metrics:accuracy:0.8230
INFO:root:20:20:40 [Epoch 7 Batch 200/254] loss=0.3997, lr=0.0000035, metrics:accuracy:0.8240
INFO:root:20:20:44 [Epoch 7 Batch 240/254] loss=0.3835, lr=0.0000033, metrics:accuracy:0.8234
INFO:root:20:20:45 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:20:46 [Batch 40/250] loss=0.4833, metrics:accuracy:1540.0000
INFO:root:20:20:47 [Batch 80/250] loss=0.4544, metrics:accuracy:1580.0000
INFO:root:20:20:48 [Batch 120/250] loss=0.5038, metrics:accuracy:1620.0000
INFO:root:20:20:49 [Batch 160/250] loss=0.4834, metrics:accuracy:1660.0000
INFO:root:20:20:49 [Batch 200/250] loss=0.4697, metrics:accuracy:1700.0000
INFO:root:20:20:50 [Batch 240/250] loss=0.5014, metrics:accuracy:1740.0000
INFO:root:20:20:50 validation metrics:accuracy:0.7915
INFO:root:20:20:50 Time cost=5.40s, throughput=370.60 samples/s
INFO:root:20:20:52 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:20:20:52 Time cost=31.55s
INFO:root:20:20:56 [Epoch 8 Batch 40/254] loss=0.4245, lr=0.0000030, metrics:accuracy:0.8068
INFO:root:20:21:00 [Epoch 8 Batch 80/254] loss=0.4162, lr=0.0000029, metrics:accuracy:0.8139
INFO:root:20:21:04 [Epoch 8 Batch 120/254] loss=0.3352, lr=0.0000027, metrics:accuracy:0.8276
INFO:root:20:21:08 [Epoch 8 Batch 160/254] loss=0.3815, lr=0.0000025, metrics:accuracy:0.8293
INFO:root:20:21:12 [Epoch 8 Batch 200/254] loss=0.3683, lr=0.0000023, metrics:accuracy:0.8300
INFO:root:20:21:16 [Epoch 8 Batch 240/254] loss=0.3719, lr=0.0000021, metrics:accuracy:0.8300
INFO:root:20:21:17 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:21:18 [Batch 40/250] loss=0.4836, metrics:accuracy:1790.0000
INFO:root:20:21:19 [Batch 80/250] loss=0.4545, metrics:accuracy:1830.0000
INFO:root:20:21:19 [Batch 120/250] loss=0.4974, metrics:accuracy:1870.0000
INFO:root:20:21:20 [Batch 160/250] loss=0.4899, metrics:accuracy:1910.0000
INFO:root:20:21:21 [Batch 200/250] loss=0.4732, metrics:accuracy:1950.0000
INFO:root:20:21:22 [Batch 240/250] loss=0.5142, metrics:accuracy:1990.0000
INFO:root:20:21:22 validation metrics:accuracy:0.7875
INFO:root:20:21:22 Time cost=5.24s, throughput=381.47 samples/s
INFO:root:20:21:24 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:20:21:24 Time cost=31.65s
INFO:root:20:21:28 [Epoch 9 Batch 40/254] loss=0.3727, lr=0.0000019, metrics:accuracy:0.8373
INFO:root:20:21:32 [Epoch 9 Batch 80/254] loss=0.4133, lr=0.0000017, metrics:accuracy:0.8240
INFO:root:20:21:36 [Epoch 9 Batch 120/254] loss=0.3577, lr=0.0000016, metrics:accuracy:0.8296
INFO:root:20:21:39 [Epoch 9 Batch 160/254] loss=0.3671, lr=0.0000014, metrics:accuracy:0.8308
INFO:root:20:21:43 [Epoch 9 Batch 200/254] loss=0.3803, lr=0.0000012, metrics:accuracy:0.8281
INFO:root:20:21:47 [Epoch 9 Batch 240/254] loss=0.3548, lr=0.0000010, metrics:accuracy:0.8288
INFO:root:20:21:49 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:21:49 [Batch 40/250] loss=0.4845, metrics:accuracy:2040.0000
INFO:root:20:21:50 [Batch 80/250] loss=0.4521, metrics:accuracy:2080.0000
INFO:root:20:21:51 [Batch 120/250] loss=0.4944, metrics:accuracy:2120.0000
INFO:root:20:21:52 [Batch 160/250] loss=0.4853, metrics:accuracy:2160.0000
INFO:root:20:21:53 [Batch 200/250] loss=0.4740, metrics:accuracy:2200.0000
INFO:root:20:21:54 [Batch 240/250] loss=0.5269, metrics:accuracy:2240.0000
INFO:root:20:21:54 validation metrics:accuracy:0.7895
INFO:root:20:21:54 Time cost=5.38s, throughput=372.05 samples/s
INFO:root:20:22:00 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:20:22:00 Time cost=35.98s
INFO:root:20:22:04 [Epoch 10 Batch 40/254] loss=0.3543, lr=0.0000008, metrics:accuracy:0.8351
INFO:root:20:22:08 [Epoch 10 Batch 80/254] loss=0.3455, lr=0.0000006, metrics:accuracy:0.8415
INFO:root:20:22:11 [Epoch 10 Batch 120/254] loss=0.3529, lr=0.0000004, metrics:accuracy:0.8447
INFO:root:20:22:15 [Epoch 10 Batch 160/254] loss=0.4009, lr=0.0000002, metrics:accuracy:0.8378
INFO:root:20:22:19 [Epoch 10 Batch 200/254] loss=0.3646, lr=0.0000001, metrics:accuracy:0.8373
INFO:root:20:22:20 Finish training step: 2500
INFO:root:20:22:20 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:22:21 [Batch 40/250] loss=0.4882, metrics:accuracy:2290.0000
INFO:root:20:22:22 [Batch 80/250] loss=0.4577, metrics:accuracy:2330.0000
INFO:root:20:22:22 [Batch 120/250] loss=0.4969, metrics:accuracy:2370.0000
INFO:root:20:22:23 [Batch 160/250] loss=0.4868, metrics:accuracy:2410.0000
INFO:root:20:22:24 [Batch 200/250] loss=0.4778, metrics:accuracy:2450.0000
INFO:root:20:22:25 [Batch 240/250] loss=0.5303, metrics:accuracy:2490.0000
INFO:root:20:22:25 validation metrics:accuracy:0.7875
INFO:root:20:22:25 Time cost=5.15s, throughput=388.54 samples/s
INFO:root:20:22:26 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:20:22:26 Time cost=26.90s
INFO:root:20:22:27 Best model at epoch 6. Validation metrics:accuracy:0.7915
INFO:root:20:22:27 Now we are doing testing on test with gpu(0).
INFO:root:20:22:32 Time cost=4.83s, throughput=412.69 samples/s
INFO:root:20:25:18 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.2)
INFO:root:20:25:24 processing dataset...
INFO:root:20:25:25 Now we are doing BERT classification training on gpu(0)!
INFO:root:20:25:25 training steps=2500
INFO:root:20:25:31 [Epoch 1 Batch 40/254] loss=0.6866, lr=0.0000016, metrics:accuracy:0.5541
INFO:root:20:25:34 [Epoch 1 Batch 80/254] loss=0.5852, lr=0.0000032, metrics:accuracy:0.6028
INFO:root:20:25:38 [Epoch 1 Batch 120/254] loss=0.5756, lr=0.0000048, metrics:accuracy:0.6327
INFO:root:20:25:42 [Epoch 1 Batch 160/254] loss=0.5737, lr=0.0000064, metrics:accuracy:0.6518
INFO:root:20:25:45 [Epoch 1 Batch 200/254] loss=0.6048, lr=0.0000080, metrics:accuracy:0.6611
INFO:root:20:25:49 [Epoch 1 Batch 240/254] loss=0.5502, lr=0.0000096, metrics:accuracy:0.6737
INFO:root:20:25:51 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:25:51 [Batch 40/250] loss=0.5415, metrics:accuracy:40.0000
INFO:root:20:25:52 [Batch 80/250] loss=0.5437, metrics:accuracy:80.0000
INFO:root:20:25:53 [Batch 120/250] loss=0.5126, metrics:accuracy:120.0000
INFO:root:20:25:54 [Batch 160/250] loss=0.5560, metrics:accuracy:160.0000
INFO:root:20:25:55 [Batch 200/250] loss=0.5534, metrics:accuracy:200.0000
INFO:root:20:25:55 [Batch 240/250] loss=0.5425, metrics:accuracy:240.0000
INFO:root:20:25:56 validation metrics:accuracy:0.7250
INFO:root:20:25:56 Time cost=5.02s, throughput=398.44 samples/s
INFO:root:20:25:59 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:20:25:59 Time cost=33.45s
INFO:root:20:26:03 [Epoch 2 Batch 40/254] loss=0.5397, lr=0.0000117, metrics:accuracy:0.7385
INFO:root:20:26:07 [Epoch 2 Batch 80/254] loss=0.5387, lr=0.0000133, metrics:accuracy:0.7337
INFO:root:20:26:10 [Epoch 2 Batch 120/254] loss=0.5461, lr=0.0000149, metrics:accuracy:0.7254
INFO:root:20:26:14 [Epoch 2 Batch 160/254] loss=0.5367, lr=0.0000165, metrics:accuracy:0.7257
INFO:root:20:26:18 [Epoch 2 Batch 200/254] loss=0.5346, lr=0.0000181, metrics:accuracy:0.7300
INFO:root:20:26:22 [Epoch 2 Batch 240/254] loss=0.5419, lr=0.0000197, metrics:accuracy:0.7302
INFO:root:20:26:23 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:26:24 [Batch 40/250] loss=0.4944, metrics:accuracy:290.0000
INFO:root:20:26:24 [Batch 80/250] loss=0.4885, metrics:accuracy:330.0000
INFO:root:20:26:25 [Batch 120/250] loss=0.4783, metrics:accuracy:370.0000
INFO:root:20:26:26 [Batch 160/250] loss=0.5178, metrics:accuracy:410.0000
INFO:root:20:26:27 [Batch 200/250] loss=0.4902, metrics:accuracy:450.0000
INFO:root:20:26:28 [Batch 240/250] loss=0.5123, metrics:accuracy:490.0000
INFO:root:20:26:28 validation metrics:accuracy:0.7650
INFO:root:20:26:28 Time cost=5.05s, throughput=395.89 samples/s
INFO:root:20:26:30 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:20:26:30 Time cost=31.46s
INFO:root:20:26:34 [Epoch 3 Batch 40/254] loss=0.5107, lr=0.0000195, metrics:accuracy:0.7472
INFO:root:20:26:38 [Epoch 3 Batch 80/254] loss=0.5082, lr=0.0000191, metrics:accuracy:0.7474
INFO:root:20:26:42 [Epoch 3 Batch 120/254] loss=0.4819, lr=0.0000187, metrics:accuracy:0.7560
INFO:root:20:26:45 [Epoch 3 Batch 160/254] loss=0.4891, lr=0.0000183, metrics:accuracy:0.7630
INFO:root:20:26:50 [Epoch 3 Batch 200/254] loss=0.4656, lr=0.0000179, metrics:accuracy:0.7683
INFO:root:20:26:53 [Epoch 3 Batch 240/254] loss=0.4893, lr=0.0000175, metrics:accuracy:0.7688
INFO:root:20:26:55 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:26:55 [Batch 40/250] loss=0.4753, metrics:accuracy:540.0000
INFO:root:20:26:56 [Batch 80/250] loss=0.4752, metrics:accuracy:580.0000
INFO:root:20:26:57 [Batch 120/250] loss=0.4697, metrics:accuracy:620.0000
INFO:root:20:26:58 [Batch 160/250] loss=0.5061, metrics:accuracy:660.0000
INFO:root:20:26:59 [Batch 200/250] loss=0.5059, metrics:accuracy:700.0000
INFO:root:20:26:59 [Batch 240/250] loss=0.5347, metrics:accuracy:740.0000
INFO:root:20:27:00 validation metrics:accuracy:0.7705
INFO:root:20:27:00 Time cost=5.01s, throughput=399.08 samples/s
INFO:root:20:27:01 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:20:27:01 Time cost=30.92s
INFO:root:20:27:06 [Epoch 4 Batch 40/254] loss=0.4397, lr=0.0000170, metrics:accuracy:0.8070
INFO:root:20:27:09 [Epoch 4 Batch 80/254] loss=0.4486, lr=0.0000166, metrics:accuracy:0.8006
INFO:root:20:27:13 [Epoch 4 Batch 120/254] loss=0.4623, lr=0.0000162, metrics:accuracy:0.7932
INFO:root:20:27:16 [Epoch 4 Batch 160/254] loss=0.4678, lr=0.0000158, metrics:accuracy:0.7882
INFO:root:20:27:20 [Epoch 4 Batch 200/254] loss=0.4501, lr=0.0000154, metrics:accuracy:0.7910
INFO:root:20:27:24 [Epoch 4 Batch 240/254] loss=0.4488, lr=0.0000150, metrics:accuracy:0.7912
INFO:root:20:27:25 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:27:26 [Batch 40/250] loss=0.4677, metrics:accuracy:790.0000
INFO:root:20:27:27 [Batch 80/250] loss=0.4746, metrics:accuracy:830.0000
INFO:root:20:27:27 [Batch 120/250] loss=0.4332, metrics:accuracy:870.0000
INFO:root:20:27:28 [Batch 160/250] loss=0.4715, metrics:accuracy:910.0000
INFO:root:20:27:29 [Batch 200/250] loss=0.4854, metrics:accuracy:950.0000
INFO:root:20:27:30 [Batch 240/250] loss=0.5225, metrics:accuracy:990.0000
INFO:root:20:27:30 validation metrics:accuracy:0.7815
INFO:root:20:27:30 Time cost=4.98s, throughput=401.96 samples/s
INFO:root:20:27:33 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:20:27:33 Time cost=31.79s
INFO:root:20:27:37 [Epoch 5 Batch 40/254] loss=0.4061, lr=0.0000145, metrics:accuracy:0.8266
INFO:root:20:27:41 [Epoch 5 Batch 80/254] loss=0.4111, lr=0.0000141, metrics:accuracy:0.8167
INFO:root:20:27:44 [Epoch 5 Batch 120/254] loss=0.4392, lr=0.0000137, metrics:accuracy:0.8106
INFO:root:20:27:48 [Epoch 5 Batch 160/254] loss=0.4328, lr=0.0000133, metrics:accuracy:0.8075
INFO:root:20:27:51 [Epoch 5 Batch 200/254] loss=0.4461, lr=0.0000129, metrics:accuracy:0.8061
INFO:root:20:27:55 [Epoch 5 Batch 240/254] loss=0.3900, lr=0.0000125, metrics:accuracy:0.8088
INFO:root:20:27:56 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:27:57 [Batch 40/250] loss=0.5042, metrics:accuracy:1040.0000
INFO:root:20:27:58 [Batch 80/250] loss=0.4747, metrics:accuracy:1080.0000
INFO:root:20:27:59 [Batch 120/250] loss=0.4598, metrics:accuracy:1120.0000
INFO:root:20:28:00 [Batch 160/250] loss=0.5075, metrics:accuracy:1160.0000
INFO:root:20:28:00 [Batch 200/250] loss=0.4862, metrics:accuracy:1200.0000
INFO:root:20:28:01 [Batch 240/250] loss=0.5214, metrics:accuracy:1240.0000
INFO:root:20:28:01 validation metrics:accuracy:0.7890
INFO:root:20:28:01 Time cost=4.89s, throughput=409.34 samples/s
INFO:root:20:28:04 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:20:28:04 Time cost=30.57s
INFO:root:20:28:07 [Epoch 6 Batch 40/254] loss=0.3956, lr=0.0000119, metrics:accuracy:0.8236
INFO:root:20:28:11 [Epoch 6 Batch 80/254] loss=0.3798, lr=0.0000115, metrics:accuracy:0.8271
INFO:root:20:28:15 [Epoch 6 Batch 120/254] loss=0.4060, lr=0.0000111, metrics:accuracy:0.8230
INFO:root:20:28:18 [Epoch 6 Batch 160/254] loss=0.3610, lr=0.0000107, metrics:accuracy:0.8256
INFO:root:20:28:22 [Epoch 6 Batch 200/254] loss=0.3719, lr=0.0000103, metrics:accuracy:0.8276
INFO:root:20:28:26 [Epoch 6 Batch 240/254] loss=0.3903, lr=0.0000099, metrics:accuracy:0.8260
INFO:root:20:28:27 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:28:27 [Batch 40/250] loss=0.4988, metrics:accuracy:1290.0000
INFO:root:20:28:28 [Batch 80/250] loss=0.5131, metrics:accuracy:1330.0000
INFO:root:20:28:29 [Batch 120/250] loss=0.4643, metrics:accuracy:1370.0000
INFO:root:20:28:30 [Batch 160/250] loss=0.4945, metrics:accuracy:1410.0000
INFO:root:20:28:31 [Batch 200/250] loss=0.5177, metrics:accuracy:1450.0000
INFO:root:20:28:31 [Batch 240/250] loss=0.5600, metrics:accuracy:1490.0000
INFO:root:20:28:32 validation metrics:accuracy:0.7700
INFO:root:20:28:32 Time cost=5.01s, throughput=399.01 samples/s
INFO:root:20:28:33 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:20:28:33 Time cost=29.73s
INFO:root:20:28:37 [Epoch 7 Batch 40/254] loss=0.3760, lr=0.0000094, metrics:accuracy:0.8225
INFO:root:20:28:41 [Epoch 7 Batch 80/254] loss=0.3580, lr=0.0000090, metrics:accuracy:0.8296
INFO:root:20:28:44 [Epoch 7 Batch 120/254] loss=0.3749, lr=0.0000086, metrics:accuracy:0.8299
INFO:root:20:28:48 [Epoch 7 Batch 160/254] loss=0.3343, lr=0.0000082, metrics:accuracy:0.8365
INFO:root:20:28:52 [Epoch 7 Batch 200/254] loss=0.3708, lr=0.0000078, metrics:accuracy:0.8370
INFO:root:20:28:55 [Epoch 7 Batch 240/254] loss=0.3582, lr=0.0000074, metrics:accuracy:0.8359
INFO:root:20:28:56 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:28:57 [Batch 40/250] loss=0.4852, metrics:accuracy:1540.0000
INFO:root:20:28:58 [Batch 80/250] loss=0.4968, metrics:accuracy:1580.0000
INFO:root:20:28:59 [Batch 120/250] loss=0.4921, metrics:accuracy:1620.0000
INFO:root:20:29:00 [Batch 160/250] loss=0.4803, metrics:accuracy:1660.0000
INFO:root:20:29:00 [Batch 200/250] loss=0.4913, metrics:accuracy:1700.0000
INFO:root:20:29:01 [Batch 240/250] loss=0.5223, metrics:accuracy:1740.0000
INFO:root:20:29:01 validation metrics:accuracy:0.7905
INFO:root:20:29:01 Time cost=4.94s, throughput=404.94 samples/s
INFO:root:20:29:03 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:20:29:03 Time cost=29.63s
INFO:root:20:29:07 [Epoch 8 Batch 40/254] loss=0.3945, lr=0.0000068, metrics:accuracy:0.8178
INFO:root:20:29:10 [Epoch 8 Batch 80/254] loss=0.3851, lr=0.0000064, metrics:accuracy:0.8263
INFO:root:20:29:14 [Epoch 8 Batch 120/254] loss=0.3022, lr=0.0000060, metrics:accuracy:0.8393
INFO:root:20:29:17 [Epoch 8 Batch 160/254] loss=0.3387, lr=0.0000056, metrics:accuracy:0.8431
INFO:root:20:29:21 [Epoch 8 Batch 200/254] loss=0.3288, lr=0.0000052, metrics:accuracy:0.8459
INFO:root:20:29:25 [Epoch 8 Batch 240/254] loss=0.3192, lr=0.0000048, metrics:accuracy:0.8481
INFO:root:20:29:26 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:29:27 [Batch 40/250] loss=0.5136, metrics:accuracy:1790.0000
INFO:root:20:29:28 [Batch 80/250] loss=0.5176, metrics:accuracy:1830.0000
INFO:root:20:29:29 [Batch 120/250] loss=0.5120, metrics:accuracy:1870.0000
INFO:root:20:29:30 [Batch 160/250] loss=0.4994, metrics:accuracy:1910.0000
INFO:root:20:29:30 [Batch 200/250] loss=0.4977, metrics:accuracy:1950.0000
INFO:root:20:29:31 [Batch 240/250] loss=0.5609, metrics:accuracy:1990.0000
INFO:root:20:29:31 validation metrics:accuracy:0.7880
INFO:root:20:29:31 Time cost=5.05s, throughput=395.81 samples/s
INFO:root:20:29:33 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:20:29:33 Time cost=29.85s
INFO:root:20:29:37 [Epoch 9 Batch 40/254] loss=0.3298, lr=0.0000043, metrics:accuracy:0.8641
INFO:root:20:29:40 [Epoch 9 Batch 80/254] loss=0.3483, lr=0.0000039, metrics:accuracy:0.8555
INFO:root:20:29:44 [Epoch 9 Batch 120/254] loss=0.3085, lr=0.0000035, metrics:accuracy:0.8607
INFO:root:20:29:47 [Epoch 9 Batch 160/254] loss=0.3113, lr=0.0000031, metrics:accuracy:0.8610
INFO:root:20:29:51 [Epoch 9 Batch 200/254] loss=0.3322, lr=0.0000027, metrics:accuracy:0.8591
INFO:root:20:29:55 [Epoch 9 Batch 240/254] loss=0.2907, lr=0.0000023, metrics:accuracy:0.8599
INFO:root:20:29:56 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:29:57 [Batch 40/250] loss=0.5223, metrics:accuracy:2040.0000
INFO:root:20:29:58 [Batch 80/250] loss=0.5269, metrics:accuracy:2080.0000
INFO:root:20:29:58 [Batch 120/250] loss=0.5051, metrics:accuracy:2120.0000
INFO:root:20:29:59 [Batch 160/250] loss=0.4999, metrics:accuracy:2160.0000
INFO:root:20:30:00 [Batch 200/250] loss=0.5149, metrics:accuracy:2200.0000
INFO:root:20:30:01 [Batch 240/250] loss=0.5658, metrics:accuracy:2240.0000
INFO:root:20:30:01 validation metrics:accuracy:0.7850
INFO:root:20:30:01 Time cost=5.02s, throughput=398.60 samples/s
INFO:root:20:30:02 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:20:30:02 Time cost=29.62s
INFO:root:20:30:06 [Epoch 10 Batch 40/254] loss=0.3029, lr=0.0000018, metrics:accuracy:0.8604
INFO:root:20:30:10 [Epoch 10 Batch 80/254] loss=0.2829, lr=0.0000013, metrics:accuracy:0.8748
INFO:root:20:30:14 [Epoch 10 Batch 120/254] loss=0.3013, lr=0.0000009, metrics:accuracy:0.8733
INFO:root:20:30:17 [Epoch 10 Batch 160/254] loss=0.3453, lr=0.0000005, metrics:accuracy:0.8664
INFO:root:20:30:21 [Epoch 10 Batch 200/254] loss=0.3070, lr=0.0000002, metrics:accuracy:0.8661
INFO:root:20:30:22 Finish training step: 2500
INFO:root:20:30:22 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:30:23 [Batch 40/250] loss=0.5257, metrics:accuracy:2290.0000
INFO:root:20:30:24 [Batch 80/250] loss=0.5342, metrics:accuracy:2330.0000
INFO:root:20:30:25 [Batch 120/250] loss=0.5163, metrics:accuracy:2370.0000
INFO:root:20:30:25 [Batch 160/250] loss=0.4970, metrics:accuracy:2410.0000
INFO:root:20:30:26 [Batch 200/250] loss=0.5177, metrics:accuracy:2450.0000
INFO:root:20:30:27 [Batch 240/250] loss=0.5671, metrics:accuracy:2490.0000
INFO:root:20:30:27 validation metrics:accuracy:0.7865
INFO:root:20:30:27 Time cost=5.09s, throughput=392.94 samples/s
INFO:root:20:30:29 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:20:30:29 Time cost=26.32s
INFO:root:20:30:29 Best model at epoch 6. Validation metrics:accuracy:0.7905
INFO:root:20:30:29 Now we are doing testing on test with gpu(0).
INFO:root:20:30:34 Time cost=4.84s, throughput=411.76 samples/s
INFO:root:20:35:48 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.3)
INFO:root:20:36:05 Namespace(accumulate=None, batch_size=32, bert_dataset='book_corpus_wiki_en_uncased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.05)
INFO:root:20:36:10 processing dataset...
INFO:root:20:36:11 Now we are doing BERT classification training on gpu(0)!
INFO:root:20:36:11 training steps=2500
INFO:root:20:36:16 [Epoch 1 Batch 40/254] loss=0.6794, lr=0.0000062, metrics:accuracy:0.5987
INFO:root:20:36:19 [Epoch 1 Batch 80/254] loss=0.6002, lr=0.0000126, metrics:accuracy:0.6188
INFO:root:20:36:23 [Epoch 1 Batch 120/254] loss=0.5964, lr=0.0000190, metrics:accuracy:0.6396
INFO:root:20:36:26 [Epoch 1 Batch 160/254] loss=0.5732, lr=0.0000197, metrics:accuracy:0.6548
INFO:root:20:36:30 [Epoch 1 Batch 200/254] loss=0.5942, lr=0.0000194, metrics:accuracy:0.6668
INFO:root:20:36:33 [Epoch 1 Batch 240/254] loss=0.5599, lr=0.0000190, metrics:accuracy:0.6741
INFO:root:20:36:34 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:36:35 [Batch 40/250] loss=0.5910, metrics:accuracy:40.0000
INFO:root:20:36:36 [Batch 80/250] loss=0.6168, metrics:accuracy:80.0000
INFO:root:20:36:37 [Batch 120/250] loss=0.5611, metrics:accuracy:120.0000
INFO:root:20:36:38 [Batch 160/250] loss=0.6188, metrics:accuracy:160.0000
INFO:root:20:36:38 [Batch 200/250] loss=0.6025, metrics:accuracy:200.0000
INFO:root:20:36:39 [Batch 240/250] loss=0.6241, metrics:accuracy:240.0000
INFO:root:20:36:39 validation metrics:accuracy:0.6980
INFO:root:20:36:39 Time cost=4.98s, throughput=401.33 samples/s
INFO:root:20:36:41 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:20:36:41 Time cost=29.89s
INFO:root:20:36:45 [Epoch 2 Batch 40/254] loss=0.5179, lr=0.0000186, metrics:accuracy:0.7441
INFO:root:20:36:48 [Epoch 2 Batch 80/254] loss=0.5465, lr=0.0000182, metrics:accuracy:0.7384
INFO:root:20:36:52 [Epoch 2 Batch 120/254] loss=0.5266, lr=0.0000179, metrics:accuracy:0.7365
INFO:root:20:36:56 [Epoch 2 Batch 160/254] loss=0.5362, lr=0.0000176, metrics:accuracy:0.7308
INFO:root:20:36:59 [Epoch 2 Batch 200/254] loss=0.5225, lr=0.0000172, metrics:accuracy:0.7320
INFO:root:20:37:03 [Epoch 2 Batch 240/254] loss=0.5267, lr=0.0000169, metrics:accuracy:0.7350
INFO:root:20:37:05 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:37:05 [Batch 40/250] loss=0.4918, metrics:accuracy:290.0000
INFO:root:20:37:06 [Batch 80/250] loss=0.4609, metrics:accuracy:330.0000
INFO:root:20:37:07 [Batch 120/250] loss=0.4686, metrics:accuracy:370.0000
INFO:root:20:37:08 [Batch 160/250] loss=0.5285, metrics:accuracy:410.0000
INFO:root:20:37:09 [Batch 200/250] loss=0.4925, metrics:accuracy:450.0000
INFO:root:20:37:09 [Batch 240/250] loss=0.5091, metrics:accuracy:490.0000
INFO:root:20:37:10 validation metrics:accuracy:0.7585
INFO:root:20:37:10 Time cost=4.99s, throughput=400.52 samples/s
INFO:root:20:37:11 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:20:37:11 Time cost=30.13s
INFO:root:20:37:15 [Epoch 3 Batch 40/254] loss=0.4900, lr=0.0000164, metrics:accuracy:0.7616
INFO:root:20:37:18 [Epoch 3 Batch 80/254] loss=0.4840, lr=0.0000161, metrics:accuracy:0.7579
INFO:root:20:37:22 [Epoch 3 Batch 120/254] loss=0.4811, lr=0.0000158, metrics:accuracy:0.7624
INFO:root:20:37:26 [Epoch 3 Batch 160/254] loss=0.4834, lr=0.0000154, metrics:accuracy:0.7668
INFO:root:20:37:30 [Epoch 3 Batch 200/254] loss=0.4468, lr=0.0000151, metrics:accuracy:0.7714
INFO:root:20:37:33 [Epoch 3 Batch 240/254] loss=0.4797, lr=0.0000148, metrics:accuracy:0.7722
INFO:root:20:37:35 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:37:35 [Batch 40/250] loss=0.4751, metrics:accuracy:540.0000
INFO:root:20:37:36 [Batch 80/250] loss=0.4658, metrics:accuracy:580.0000
INFO:root:20:37:37 [Batch 120/250] loss=0.4595, metrics:accuracy:620.0000
INFO:root:20:37:38 [Batch 160/250] loss=0.5075, metrics:accuracy:660.0000
INFO:root:20:37:38 [Batch 200/250] loss=0.5177, metrics:accuracy:700.0000
INFO:root:20:37:39 [Batch 240/250] loss=0.5319, metrics:accuracy:740.0000
INFO:root:20:37:39 validation metrics:accuracy:0.7655
INFO:root:20:37:39 Time cost=4.89s, throughput=408.72 samples/s
INFO:root:20:37:41 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:20:37:41 Time cost=30.03s
INFO:root:20:37:45 [Epoch 4 Batch 40/254] loss=0.4404, lr=0.0000143, metrics:accuracy:0.8156
INFO:root:20:37:49 [Epoch 4 Batch 80/254] loss=0.4423, lr=0.0000140, metrics:accuracy:0.8037
INFO:root:20:37:53 [Epoch 4 Batch 120/254] loss=0.4471, lr=0.0000136, metrics:accuracy:0.7983
INFO:root:20:37:56 [Epoch 4 Batch 160/254] loss=0.4635, lr=0.0000133, metrics:accuracy:0.7936
INFO:root:20:37:59 [Epoch 4 Batch 200/254] loss=0.4387, lr=0.0000130, metrics:accuracy:0.7952
INFO:root:20:38:03 [Epoch 4 Batch 240/254] loss=0.4488, lr=0.0000126, metrics:accuracy:0.7961
INFO:root:20:38:04 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:38:05 [Batch 40/250] loss=0.4695, metrics:accuracy:790.0000
INFO:root:20:38:06 [Batch 80/250] loss=0.4840, metrics:accuracy:830.0000
INFO:root:20:38:07 [Batch 120/250] loss=0.4433, metrics:accuracy:870.0000
INFO:root:20:38:08 [Batch 160/250] loss=0.5251, metrics:accuracy:910.0000
INFO:root:20:38:08 [Batch 200/250] loss=0.5229, metrics:accuracy:950.0000
INFO:root:20:38:09 [Batch 240/250] loss=0.5358, metrics:accuracy:990.0000
INFO:root:20:38:09 validation metrics:accuracy:0.7750
INFO:root:20:38:09 Time cost=4.91s, throughput=407.45 samples/s
INFO:root:20:38:11 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:20:38:11 Time cost=29.67s
INFO:root:20:38:15 [Epoch 5 Batch 40/254] loss=0.3887, lr=0.0000122, metrics:accuracy:0.8297
INFO:root:20:38:19 [Epoch 5 Batch 80/254] loss=0.3937, lr=0.0000118, metrics:accuracy:0.8250
INFO:root:20:38:22 [Epoch 5 Batch 120/254] loss=0.4400, lr=0.0000115, metrics:accuracy:0.8164
INFO:root:20:38:26 [Epoch 5 Batch 160/254] loss=0.4209, lr=0.0000112, metrics:accuracy:0.8126
INFO:root:20:38:29 [Epoch 5 Batch 200/254] loss=0.4503, lr=0.0000108, metrics:accuracy:0.8102
INFO:root:20:38:33 [Epoch 5 Batch 240/254] loss=0.3884, lr=0.0000105, metrics:accuracy:0.8114
INFO:root:20:38:35 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:38:35 [Batch 40/250] loss=0.4578, metrics:accuracy:1040.0000
INFO:root:20:38:36 [Batch 80/250] loss=0.4606, metrics:accuracy:1080.0000
INFO:root:20:38:37 [Batch 120/250] loss=0.4576, metrics:accuracy:1120.0000
INFO:root:20:38:38 [Batch 160/250] loss=0.5217, metrics:accuracy:1160.0000
INFO:root:20:38:39 [Batch 200/250] loss=0.4919, metrics:accuracy:1200.0000
INFO:root:20:38:40 [Batch 240/250] loss=0.5439, metrics:accuracy:1240.0000
INFO:root:20:38:40 validation metrics:accuracy:0.7845
INFO:root:20:38:40 Time cost=5.04s, throughput=396.80 samples/s
INFO:root:20:38:42 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:20:38:42 Time cost=31.62s
INFO:root:20:38:47 [Epoch 6 Batch 40/254] loss=0.4113, lr=0.0000100, metrics:accuracy:0.8220
INFO:root:20:38:50 [Epoch 6 Batch 80/254] loss=0.3834, lr=0.0000097, metrics:accuracy:0.8247
INFO:root:20:38:54 [Epoch 6 Batch 120/254] loss=0.4037, lr=0.0000094, metrics:accuracy:0.8251
INFO:root:20:38:58 [Epoch 6 Batch 160/254] loss=0.3641, lr=0.0000090, metrics:accuracy:0.8272
INFO:root:20:39:02 [Epoch 6 Batch 200/254] loss=0.3791, lr=0.0000087, metrics:accuracy:0.8271
INFO:root:20:39:06 [Epoch 6 Batch 240/254] loss=0.3880, lr=0.0000083, metrics:accuracy:0.8271
INFO:root:20:39:07 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:39:08 [Batch 40/250] loss=0.4588, metrics:accuracy:1290.0000
INFO:root:20:39:09 [Batch 80/250] loss=0.4569, metrics:accuracy:1330.0000
INFO:root:20:39:09 [Batch 120/250] loss=0.4541, metrics:accuracy:1370.0000
INFO:root:20:39:10 [Batch 160/250] loss=0.5075, metrics:accuracy:1410.0000
INFO:root:20:39:11 [Batch 200/250] loss=0.4980, metrics:accuracy:1450.0000
INFO:root:20:39:12 [Batch 240/250] loss=0.5428, metrics:accuracy:1490.0000
INFO:root:20:39:12 validation metrics:accuracy:0.7860
INFO:root:20:39:12 Time cost=5.15s, throughput=388.19 samples/s
INFO:root:20:39:14 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:20:39:14 Time cost=31.15s
INFO:root:20:39:18 [Epoch 7 Batch 40/254] loss=0.3731, lr=0.0000079, metrics:accuracy:0.8273
INFO:root:20:39:22 [Epoch 7 Batch 80/254] loss=0.3625, lr=0.0000076, metrics:accuracy:0.8296
INFO:root:20:39:26 [Epoch 7 Batch 120/254] loss=0.3904, lr=0.0000072, metrics:accuracy:0.8312
INFO:root:20:39:29 [Epoch 7 Batch 160/254] loss=0.3411, lr=0.0000069, metrics:accuracy:0.8353
INFO:root:20:39:33 [Epoch 7 Batch 200/254] loss=0.3705, lr=0.0000065, metrics:accuracy:0.8378
INFO:root:20:39:37 [Epoch 7 Batch 240/254] loss=0.3734, lr=0.0000062, metrics:accuracy:0.8341
INFO:root:20:39:38 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:39:39 [Batch 40/250] loss=0.4670, metrics:accuracy:1540.0000
INFO:root:20:39:40 [Batch 80/250] loss=0.4613, metrics:accuracy:1580.0000
INFO:root:20:39:41 [Batch 120/250] loss=0.4857, metrics:accuracy:1620.0000
INFO:root:20:39:41 [Batch 160/250] loss=0.5138, metrics:accuracy:1660.0000
INFO:root:20:39:42 [Batch 200/250] loss=0.4863, metrics:accuracy:1700.0000
INFO:root:20:39:43 [Batch 240/250] loss=0.5585, metrics:accuracy:1740.0000
INFO:root:20:39:43 validation metrics:accuracy:0.7860
INFO:root:20:39:43 Time cost=5.11s, throughput=391.58 samples/s
INFO:root:20:39:48 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:20:39:48 Time cost=34.30s
INFO:root:20:39:52 [Epoch 8 Batch 40/254] loss=0.3967, lr=0.0000058, metrics:accuracy:0.8178
INFO:root:20:39:56 [Epoch 8 Batch 80/254] loss=0.3725, lr=0.0000054, metrics:accuracy:0.8247
INFO:root:20:40:00 [Epoch 8 Batch 120/254] loss=0.3037, lr=0.0000051, metrics:accuracy:0.8367
INFO:root:20:40:04 [Epoch 8 Batch 160/254] loss=0.3500, lr=0.0000047, metrics:accuracy:0.8389
INFO:root:20:40:08 [Epoch 8 Batch 200/254] loss=0.3517, lr=0.0000044, metrics:accuracy:0.8383
INFO:root:20:40:12 [Epoch 8 Batch 240/254] loss=0.3458, lr=0.0000041, metrics:accuracy:0.8392
INFO:root:20:40:14 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:40:14 [Batch 40/250] loss=0.4713, metrics:accuracy:1790.0000
INFO:root:20:40:15 [Batch 80/250] loss=0.4724, metrics:accuracy:1830.0000
INFO:root:20:40:16 [Batch 120/250] loss=0.4900, metrics:accuracy:1870.0000
INFO:root:20:40:17 [Batch 160/250] loss=0.5330, metrics:accuracy:1910.0000
INFO:root:20:40:18 [Batch 200/250] loss=0.4922, metrics:accuracy:1950.0000
INFO:root:20:40:19 [Batch 240/250] loss=0.5780, metrics:accuracy:1990.0000
INFO:root:20:40:19 validation metrics:accuracy:0.7845
INFO:root:20:40:19 Time cost=5.32s, throughput=376.21 samples/s
INFO:root:20:40:20 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:20:40:20 Time cost=32.39s
INFO:root:20:40:25 [Epoch 9 Batch 40/254] loss=0.3446, lr=0.0000036, metrics:accuracy:0.8460
INFO:root:20:40:28 [Epoch 9 Batch 80/254] loss=0.3660, lr=0.0000033, metrics:accuracy:0.8366
INFO:root:20:40:32 [Epoch 9 Batch 120/254] loss=0.3158, lr=0.0000029, metrics:accuracy:0.8497
INFO:root:20:40:36 [Epoch 9 Batch 160/254] loss=0.3099, lr=0.0000026, metrics:accuracy:0.8533
INFO:root:20:40:40 [Epoch 9 Batch 200/254] loss=0.3472, lr=0.0000023, metrics:accuracy:0.8512
INFO:root:20:40:44 [Epoch 9 Batch 240/254] loss=0.3128, lr=0.0000019, metrics:accuracy:0.8510
INFO:root:20:40:45 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:40:46 [Batch 40/250] loss=0.4942, metrics:accuracy:2040.0000
INFO:root:20:40:46 [Batch 80/250] loss=0.4916, metrics:accuracy:2080.0000
INFO:root:20:40:47 [Batch 120/250] loss=0.5029, metrics:accuracy:2120.0000
INFO:root:20:40:48 [Batch 160/250] loss=0.5585, metrics:accuracy:2160.0000
INFO:root:20:40:49 [Batch 200/250] loss=0.5141, metrics:accuracy:2200.0000
INFO:root:20:40:50 [Batch 240/250] loss=0.6070, metrics:accuracy:2240.0000
INFO:root:20:40:50 validation metrics:accuracy:0.7900
INFO:root:20:40:50 Time cost=5.04s, throughput=396.88 samples/s
INFO:root:20:40:53 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:20:40:53 Time cost=32.85s
INFO:root:20:40:57 [Epoch 10 Batch 40/254] loss=0.3254, lr=0.0000015, metrics:accuracy:0.8525
INFO:root:20:41:01 [Epoch 10 Batch 80/254] loss=0.2920, lr=0.0000011, metrics:accuracy:0.8644
INFO:root:20:41:05 [Epoch 10 Batch 120/254] loss=0.3219, lr=0.0000008, metrics:accuracy:0.8638
INFO:root:20:41:08 [Epoch 10 Batch 160/254] loss=0.3493, lr=0.0000005, metrics:accuracy:0.8593
INFO:root:20:41:12 [Epoch 10 Batch 200/254] loss=0.3307, lr=0.0000001, metrics:accuracy:0.8587
INFO:root:20:41:13 Finish training step: 2500
INFO:root:20:41:13 Now we are doing evaluation on dev with gpu(0).
INFO:root:20:41:14 [Batch 40/250] loss=0.4953, metrics:accuracy:2290.0000
INFO:root:20:41:15 [Batch 80/250] loss=0.4920, metrics:accuracy:2330.0000
INFO:root:20:41:16 [Batch 120/250] loss=0.4974, metrics:accuracy:2370.0000
INFO:root:20:41:17 [Batch 160/250] loss=0.5486, metrics:accuracy:2410.0000
INFO:root:20:41:17 [Batch 200/250] loss=0.5189, metrics:accuracy:2450.0000
INFO:root:20:41:18 [Batch 240/250] loss=0.6083, metrics:accuracy:2490.0000
INFO:root:20:41:18 validation metrics:accuracy:0.7830
INFO:root:20:41:18 Time cost=5.02s, throughput=398.62 samples/s
INFO:root:20:41:22 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:20:41:22 Time cost=28.80s
INFO:root:20:41:22 Best model at epoch 8. Validation metrics:accuracy:0.7900
INFO:root:20:41:22 Now we are doing testing on test with gpu(0).
INFO:root:20:41:27 Time cost=4.85s, throughput=410.36 samples/s
INFO:root:10:36:20 Namespace(accumulate=None, batch_size=32, bert_dataset='wiki_cn_cased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:10:36:59 processing dataset...
INFO:root:10:37:05 Now we are doing BERT classification training on gpu(0)!
INFO:root:10:37:05 training steps=2500
INFO:root:10:37:16 [Epoch 1 Batch 40/254] loss=0.5871, lr=0.0000031, metrics:accuracy:0.6886
INFO:root:10:37:22 [Epoch 1 Batch 80/254] loss=0.3855, lr=0.0000063, metrics:accuracy:0.7669
INFO:root:10:37:30 [Epoch 1 Batch 120/254] loss=0.3658, lr=0.0000095, metrics:accuracy:0.7979
INFO:root:10:37:34 [Epoch 1 Batch 160/254] loss=0.3138, lr=0.0000127, metrics:accuracy:0.8181
INFO:root:10:37:39 [Epoch 1 Batch 200/254] loss=0.2942, lr=0.0000159, metrics:accuracy:0.8321
INFO:root:10:37:43 [Epoch 1 Batch 240/254] loss=0.2984, lr=0.0000191, metrics:accuracy:0.8403
INFO:root:10:37:45 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:37:46 [Batch 40/250] loss=0.2239, metrics:accuracy:0.9187
INFO:root:10:37:47 [Batch 80/250] loss=0.3114, metrics:accuracy:0.9000
INFO:root:10:37:47 [Batch 120/250] loss=0.2377, metrics:accuracy:0.9042
INFO:root:10:37:48 [Batch 160/250] loss=0.3354, metrics:accuracy:0.9008
INFO:root:10:37:50 [Batch 200/250] loss=0.3195, metrics:accuracy:0.8956
INFO:root:10:37:51 [Batch 240/250] loss=0.3057, metrics:accuracy:0.8964
INFO:root:10:37:52 validation metrics:accuracy:0.8975
INFO:root:10:37:52 Time cost=7.02s, throughput=285.00 samples/s
INFO:root:10:37:53 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:10:37:53 Time cost=48.05s
INFO:root:10:38:01 [Epoch 2 Batch 40/254] loss=0.2708, lr=0.0000196, metrics:accuracy:0.9000
INFO:root:10:38:09 [Epoch 2 Batch 80/254] loss=0.2483, lr=0.0000193, metrics:accuracy:0.9093
INFO:root:10:38:14 [Epoch 2 Batch 120/254] loss=0.2293, lr=0.0000189, metrics:accuracy:0.9126
INFO:root:10:38:18 [Epoch 2 Batch 160/254] loss=0.2230, lr=0.0000186, metrics:accuracy:0.9136
INFO:root:10:38:24 [Epoch 2 Batch 200/254] loss=0.2542, lr=0.0000182, metrics:accuracy:0.9133
INFO:root:10:38:28 [Epoch 2 Batch 240/254] loss=0.2433, lr=0.0000178, metrics:accuracy:0.9129
INFO:root:10:38:29 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:38:30 [Batch 40/250] loss=0.2113, metrics:accuracy:0.9187
INFO:root:10:38:31 [Batch 80/250] loss=0.2444, metrics:accuracy:0.9141
INFO:root:10:38:32 [Batch 120/250] loss=0.2331, metrics:accuracy:0.9146
INFO:root:10:38:33 [Batch 160/250] loss=0.2180, metrics:accuracy:0.9148
INFO:root:10:38:35 [Batch 200/250] loss=0.2397, metrics:accuracy:0.9144
INFO:root:10:38:36 [Batch 240/250] loss=0.3279, metrics:accuracy:0.9094
INFO:root:10:38:36 validation metrics:accuracy:0.9095
INFO:root:10:38:36 Time cost=6.90s, throughput=289.81 samples/s
INFO:root:10:38:38 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:10:38:38 Time cost=45.35s
INFO:root:10:38:49 [Epoch 3 Batch 40/254] loss=0.1950, lr=0.0000174, metrics:accuracy:0.9288
INFO:root:10:38:55 [Epoch 3 Batch 80/254] loss=0.1752, lr=0.0000170, metrics:accuracy:0.9348
INFO:root:10:38:59 [Epoch 3 Batch 120/254] loss=0.2214, lr=0.0000166, metrics:accuracy:0.9312
INFO:root:10:39:04 [Epoch 3 Batch 160/254] loss=0.1725, lr=0.0000163, metrics:accuracy:0.9326
INFO:root:10:39:08 [Epoch 3 Batch 200/254] loss=0.1739, lr=0.0000159, metrics:accuracy:0.9344
INFO:root:10:39:13 [Epoch 3 Batch 240/254] loss=0.1681, lr=0.0000156, metrics:accuracy:0.9360
INFO:root:10:39:15 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:39:16 [Batch 40/250] loss=0.2265, metrics:accuracy:0.9187
INFO:root:10:39:17 [Batch 80/250] loss=0.3016, metrics:accuracy:0.9016
INFO:root:10:39:18 [Batch 120/250] loss=0.2759, metrics:accuracy:0.9062
INFO:root:10:39:19 [Batch 160/250] loss=0.2935, metrics:accuracy:0.9062
INFO:root:10:39:20 [Batch 200/250] loss=0.2648, metrics:accuracy:0.9081
INFO:root:10:39:21 [Batch 240/250] loss=0.3479, metrics:accuracy:0.9042
INFO:root:10:39:22 validation metrics:accuracy:0.9050
INFO:root:10:39:22 Time cost=6.76s, throughput=295.93 samples/s
INFO:root:10:39:24 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:10:39:24 Time cost=45.53s
INFO:root:10:39:35 [Epoch 4 Batch 40/254] loss=0.1153, lr=0.0000151, metrics:accuracy:0.9635
INFO:root:10:39:43 [Epoch 4 Batch 80/254] loss=0.1291, lr=0.0000147, metrics:accuracy:0.9620
INFO:root:10:39:47 [Epoch 4 Batch 120/254] loss=0.1194, lr=0.0000144, metrics:accuracy:0.9625
INFO:root:10:39:51 [Epoch 4 Batch 160/254] loss=0.1486, lr=0.0000140, metrics:accuracy:0.9616
INFO:root:10:39:55 [Epoch 4 Batch 200/254] loss=0.1086, lr=0.0000137, metrics:accuracy:0.9632
INFO:root:10:40:03 [Epoch 4 Batch 240/254] loss=0.1248, lr=0.0000133, metrics:accuracy:0.9636
INFO:root:10:40:05 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:40:06 [Batch 40/250] loss=0.2394, metrics:accuracy:0.9250
INFO:root:10:40:07 [Batch 80/250] loss=0.3352, metrics:accuracy:0.9062
INFO:root:10:40:08 [Batch 120/250] loss=0.3174, metrics:accuracy:0.9052
INFO:root:10:40:09 [Batch 160/250] loss=0.3319, metrics:accuracy:0.9047
INFO:root:10:40:11 [Batch 200/250] loss=0.3306, metrics:accuracy:0.9056
INFO:root:10:40:13 [Batch 240/250] loss=0.4057, metrics:accuracy:0.8995
INFO:root:10:40:13 validation metrics:accuracy:0.9000
INFO:root:10:40:13 Time cost=8.28s, throughput=241.56 samples/s
INFO:root:10:40:15 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:10:40:15 Time cost=51.27s
INFO:root:10:40:24 [Epoch 5 Batch 40/254] loss=0.1017, lr=0.0000128, metrics:accuracy:0.9688
INFO:root:10:40:30 [Epoch 5 Batch 80/254] loss=0.0891, lr=0.0000125, metrics:accuracy:0.9728
INFO:root:10:40:37 [Epoch 5 Batch 120/254] loss=0.0807, lr=0.0000121, metrics:accuracy:0.9751
INFO:root:10:40:41 [Epoch 5 Batch 160/254] loss=0.0913, lr=0.0000118, metrics:accuracy:0.9745
INFO:root:10:40:46 [Epoch 5 Batch 200/254] loss=0.0775, lr=0.0000114, metrics:accuracy:0.9747
INFO:root:10:40:49 [Epoch 5 Batch 240/254] loss=0.0962, lr=0.0000111, metrics:accuracy:0.9746
INFO:root:10:40:51 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:40:52 [Batch 40/250] loss=0.2898, metrics:accuracy:0.9219
INFO:root:10:40:53 [Batch 80/250] loss=0.4505, metrics:accuracy:0.9062
INFO:root:10:40:53 [Batch 120/250] loss=0.4598, metrics:accuracy:0.8990
INFO:root:10:40:54 [Batch 160/250] loss=0.3804, metrics:accuracy:0.9000
INFO:root:10:40:56 [Batch 200/250] loss=0.4260, metrics:accuracy:0.8981
INFO:root:10:40:58 [Batch 240/250] loss=0.5050, metrics:accuracy:0.8932
INFO:root:10:40:59 validation metrics:accuracy:0.8945
INFO:root:10:40:59 Time cost=7.82s, throughput=255.88 samples/s
INFO:root:10:41:00 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:10:41:00 Time cost=45.07s
INFO:root:10:41:10 [Epoch 6 Batch 40/254] loss=0.0770, lr=0.0000106, metrics:accuracy:0.9773
INFO:root:10:41:14 [Epoch 6 Batch 80/254] loss=0.0594, lr=0.0000102, metrics:accuracy:0.9812
INFO:root:10:41:18 [Epoch 6 Batch 120/254] loss=0.0489, lr=0.0000099, metrics:accuracy:0.9819
INFO:root:10:41:24 [Epoch 6 Batch 160/254] loss=0.0633, lr=0.0000095, metrics:accuracy:0.9817
INFO:root:10:41:28 [Epoch 6 Batch 200/254] loss=0.0655, lr=0.0000092, metrics:accuracy:0.9821
INFO:root:10:41:33 [Epoch 6 Batch 240/254] loss=0.0615, lr=0.0000088, metrics:accuracy:0.9821
INFO:root:10:41:34 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:41:35 [Batch 40/250] loss=0.3715, metrics:accuracy:0.9156
INFO:root:10:41:36 [Batch 80/250] loss=0.4897, metrics:accuracy:0.9016
INFO:root:10:41:37 [Batch 120/250] loss=0.5027, metrics:accuracy:0.8979
INFO:root:10:41:38 [Batch 160/250] loss=0.4241, metrics:accuracy:0.9023
INFO:root:10:41:39 [Batch 200/250] loss=0.4873, metrics:accuracy:0.9019
INFO:root:10:41:40 [Batch 240/250] loss=0.5461, metrics:accuracy:0.8969
INFO:root:10:41:40 validation metrics:accuracy:0.8965
INFO:root:10:41:40 Time cost=6.19s, throughput=322.92 samples/s
INFO:root:10:41:42 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:10:41:42 Time cost=41.86s
INFO:root:10:41:51 [Epoch 7 Batch 40/254] loss=0.0563, lr=0.0000083, metrics:accuracy:0.9833
INFO:root:10:41:58 [Epoch 7 Batch 80/254] loss=0.0328, lr=0.0000080, metrics:accuracy:0.9881
INFO:root:10:42:06 [Epoch 7 Batch 120/254] loss=0.0506, lr=0.0000076, metrics:accuracy:0.9879
INFO:root:10:42:10 [Epoch 7 Batch 160/254] loss=0.0540, lr=0.0000073, metrics:accuracy:0.9869
INFO:root:10:42:14 [Epoch 7 Batch 200/254] loss=0.0366, lr=0.0000069, metrics:accuracy:0.9875
INFO:root:10:42:19 [Epoch 7 Batch 240/254] loss=0.0399, lr=0.0000066, metrics:accuracy:0.9879
INFO:root:10:42:21 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:42:22 [Batch 40/250] loss=0.3680, metrics:accuracy:0.9281
INFO:root:10:42:23 [Batch 80/250] loss=0.5758, metrics:accuracy:0.9125
INFO:root:10:42:24 [Batch 120/250] loss=0.6096, metrics:accuracy:0.9062
INFO:root:10:42:25 [Batch 160/250] loss=0.4650, metrics:accuracy:0.9102
INFO:root:10:42:26 [Batch 200/250] loss=0.6028, metrics:accuracy:0.9075
INFO:root:10:42:27 [Batch 240/250] loss=0.6633, metrics:accuracy:0.9021
INFO:root:10:42:27 validation metrics:accuracy:0.9025
INFO:root:10:42:27 Time cost=5.93s, throughput=337.27 samples/s
INFO:root:10:42:29 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:10:42:29 Time cost=46.54s
INFO:root:10:42:38 [Epoch 8 Batch 40/254] loss=0.0272, lr=0.0000061, metrics:accuracy:0.9904
INFO:root:10:42:42 [Epoch 8 Batch 80/254] loss=0.0289, lr=0.0000057, metrics:accuracy:0.9912
INFO:root:10:42:47 [Epoch 8 Batch 120/254] loss=0.0284, lr=0.0000054, metrics:accuracy:0.9917
INFO:root:10:42:50 [Epoch 8 Batch 160/254] loss=0.0240, lr=0.0000050, metrics:accuracy:0.9921
INFO:root:10:42:55 [Epoch 8 Batch 200/254] loss=0.0328, lr=0.0000046, metrics:accuracy:0.9922
INFO:root:10:42:59 [Epoch 8 Batch 240/254] loss=0.0378, lr=0.0000043, metrics:accuracy:0.9921
INFO:root:10:43:01 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:43:02 [Batch 40/250] loss=0.4525, metrics:accuracy:0.9250
INFO:root:10:43:03 [Batch 80/250] loss=0.7229, metrics:accuracy:0.9047
INFO:root:10:43:04 [Batch 120/250] loss=0.6926, metrics:accuracy:0.8990
INFO:root:10:43:05 [Batch 160/250] loss=0.5405, metrics:accuracy:0.9023
INFO:root:10:43:06 [Batch 200/250] loss=0.6464, metrics:accuracy:0.9031
INFO:root:10:43:07 [Batch 240/250] loss=0.7374, metrics:accuracy:0.8984
INFO:root:10:43:07 validation metrics:accuracy:0.8980
INFO:root:10:43:07 Time cost=6.67s, throughput=300.02 samples/s
INFO:root:10:43:09 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:10:43:09 Time cost=40.32s
INFO:root:10:43:18 [Epoch 9 Batch 40/254] loss=0.0345, lr=0.0000038, metrics:accuracy:0.9887
INFO:root:10:43:22 [Epoch 9 Batch 80/254] loss=0.0191, lr=0.0000035, metrics:accuracy:0.9924
INFO:root:10:43:28 [Epoch 9 Batch 120/254] loss=0.0120, lr=0.0000031, metrics:accuracy:0.9939
INFO:root:10:43:34 [Epoch 9 Batch 160/254] loss=0.0352, lr=0.0000027, metrics:accuracy:0.9933
INFO:root:10:43:40 [Epoch 9 Batch 200/254] loss=0.0145, lr=0.0000024, metrics:accuracy:0.9935
INFO:root:10:43:44 [Epoch 9 Batch 240/254] loss=0.0129, lr=0.0000020, metrics:accuracy:0.9941
INFO:root:10:43:47 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:43:48 [Batch 40/250] loss=0.4509, metrics:accuracy:0.9281
INFO:root:10:43:48 [Batch 80/250] loss=0.7437, metrics:accuracy:0.9016
INFO:root:10:43:49 [Batch 120/250] loss=0.7336, metrics:accuracy:0.8969
INFO:root:10:43:50 [Batch 160/250] loss=0.5502, metrics:accuracy:0.9016
INFO:root:10:43:51 [Batch 200/250] loss=0.6640, metrics:accuracy:0.9025
INFO:root:10:43:53 [Batch 240/250] loss=0.8310, metrics:accuracy:0.8979
INFO:root:10:43:53 validation metrics:accuracy:0.8975
INFO:root:10:43:53 Time cost=6.51s, throughput=307.03 samples/s
INFO:root:10:43:59 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:10:43:59 Time cost=50.26s
INFO:root:10:44:12 [Epoch 10 Batch 40/254] loss=0.0141, lr=0.0000016, metrics:accuracy:0.9961
INFO:root:10:44:21 [Epoch 10 Batch 80/254] loss=0.0264, lr=0.0000012, metrics:accuracy:0.9937
INFO:root:10:44:28 [Epoch 10 Batch 120/254] loss=0.0084, lr=0.0000008, metrics:accuracy:0.9952
INFO:root:10:44:32 [Epoch 10 Batch 160/254] loss=0.0095, lr=0.0000005, metrics:accuracy:0.9958
INFO:root:10:44:38 [Epoch 10 Batch 200/254] loss=0.0073, lr=0.0000001, metrics:accuracy:0.9960
INFO:root:10:44:39 Finish training step: 2500
INFO:root:10:44:39 Now we are doing evaluation on dev with gpu(0).
INFO:root:10:44:40 [Batch 40/250] loss=0.4566, metrics:accuracy:0.9313
INFO:root:10:44:41 [Batch 80/250] loss=0.7605, metrics:accuracy:0.9047
INFO:root:10:44:42 [Batch 120/250] loss=0.7516, metrics:accuracy:0.8990
INFO:root:10:44:43 [Batch 160/250] loss=0.5514, metrics:accuracy:0.9039
INFO:root:10:44:44 [Batch 200/250] loss=0.6632, metrics:accuracy:0.9050
INFO:root:10:44:45 [Batch 240/250] loss=0.8339, metrics:accuracy:0.9000
INFO:root:10:44:45 validation metrics:accuracy:0.8995
INFO:root:10:44:45 Time cost=6.35s, throughput=314.91 samples/s
INFO:root:10:44:46 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:10:44:46 Time cost=47.19s
INFO:root:10:44:47 Best model at epoch 1. Validation metrics:accuracy:0.9095
INFO:root:10:44:47 Now we are doing testing on test with gpu(0).
INFO:root:10:44:56 Time cost=8.91s, throughput=223.68 samples/s
INFO:root:11:18:43 Namespace(accumulate=None, batch_size=32, bert_dataset='wiki_cn_cased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.05)
INFO:root:11:18:47 processing dataset...
INFO:root:11:18:49 Now we are doing BERT classification training on gpu(0)!
INFO:root:11:18:49 training steps=2500
INFO:root:11:18:53 [Epoch 1 Batch 40/254] loss=0.5402, lr=0.0000062, metrics:accuracy:0.7199
INFO:root:11:18:57 [Epoch 1 Batch 80/254] loss=0.3034, lr=0.0000126, metrics:accuracy:0.8008
INFO:root:11:19:00 [Epoch 1 Batch 120/254] loss=0.3519, lr=0.0000190, metrics:accuracy:0.8255
INFO:root:11:19:04 [Epoch 1 Batch 160/254] loss=0.3141, lr=0.0000197, metrics:accuracy:0.8413
INFO:root:11:19:07 [Epoch 1 Batch 200/254] loss=0.2899, lr=0.0000194, metrics:accuracy:0.8522
INFO:root:11:19:11 [Epoch 1 Batch 240/254] loss=0.3081, lr=0.0000190, metrics:accuracy:0.8583
INFO:root:11:19:12 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:19:13 [Batch 40/250] loss=0.2018, metrics:accuracy:0.9281
INFO:root:11:19:14 [Batch 80/250] loss=0.2923, metrics:accuracy:0.9078
INFO:root:11:19:15 [Batch 120/250] loss=0.2250, metrics:accuracy:0.9073
INFO:root:11:19:16 [Batch 160/250] loss=0.2769, metrics:accuracy:0.9055
INFO:root:11:19:17 [Batch 200/250] loss=0.3136, metrics:accuracy:0.8988
INFO:root:11:19:17 [Batch 240/250] loss=0.3390, metrics:accuracy:0.8948
INFO:root:11:19:18 validation metrics:accuracy:0.8935
INFO:root:11:19:18 Time cost=5.27s, throughput=379.70 samples/s
INFO:root:11:19:19 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:11:19:19 Time cost=30.60s
INFO:root:11:19:23 [Epoch 2 Batch 40/254] loss=0.2687, lr=0.0000186, metrics:accuracy:0.9094
INFO:root:11:19:27 [Epoch 2 Batch 80/254] loss=0.2226, lr=0.0000182, metrics:accuracy:0.9210
INFO:root:11:19:31 [Epoch 2 Batch 120/254] loss=0.2227, lr=0.0000179, metrics:accuracy:0.9178
INFO:root:11:19:34 [Epoch 2 Batch 160/254] loss=0.1960, lr=0.0000176, metrics:accuracy:0.9195
INFO:root:11:19:38 [Epoch 2 Batch 200/254] loss=0.2421, lr=0.0000172, metrics:accuracy:0.9178
INFO:root:11:19:42 [Epoch 2 Batch 240/254] loss=0.2208, lr=0.0000169, metrics:accuracy:0.9183
INFO:root:11:19:43 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:19:44 [Batch 40/250] loss=0.1802, metrics:accuracy:0.9437
INFO:root:11:19:44 [Batch 80/250] loss=0.2374, metrics:accuracy:0.9297
INFO:root:11:19:45 [Batch 120/250] loss=0.2294, metrics:accuracy:0.9260
INFO:root:11:19:46 [Batch 160/250] loss=0.2470, metrics:accuracy:0.9227
INFO:root:11:19:47 [Batch 200/250] loss=0.2918, metrics:accuracy:0.9181
INFO:root:11:19:48 [Batch 240/250] loss=0.2966, metrics:accuracy:0.9161
INFO:root:11:19:48 validation metrics:accuracy:0.9150
INFO:root:11:19:48 Time cost=5.11s, throughput=391.77 samples/s
INFO:root:11:19:49 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:11:19:49 Time cost=30.19s
INFO:root:11:19:53 [Epoch 3 Batch 40/254] loss=0.1759, lr=0.0000164, metrics:accuracy:0.9480
INFO:root:11:19:57 [Epoch 3 Batch 80/254] loss=0.1720, lr=0.0000161, metrics:accuracy:0.9467
INFO:root:11:20:00 [Epoch 3 Batch 120/254] loss=0.2062, lr=0.0000158, metrics:accuracy:0.9407
INFO:root:11:20:04 [Epoch 3 Batch 160/254] loss=0.1731, lr=0.0000154, metrics:accuracy:0.9397
INFO:root:11:20:08 [Epoch 3 Batch 200/254] loss=0.1502, lr=0.0000151, metrics:accuracy:0.9421
INFO:root:11:20:12 [Epoch 3 Batch 240/254] loss=0.1694, lr=0.0000148, metrics:accuracy:0.9426
INFO:root:11:20:13 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:20:14 [Batch 40/250] loss=0.2169, metrics:accuracy:0.9313
INFO:root:11:20:14 [Batch 80/250] loss=0.2779, metrics:accuracy:0.9156
INFO:root:11:20:15 [Batch 120/250] loss=0.2487, metrics:accuracy:0.9156
INFO:root:11:20:16 [Batch 160/250] loss=0.2709, metrics:accuracy:0.9172
INFO:root:11:20:17 [Batch 200/250] loss=0.2977, metrics:accuracy:0.9131
INFO:root:11:20:18 [Batch 240/250] loss=0.2982, metrics:accuracy:0.9125
INFO:root:11:20:18 validation metrics:accuracy:0.9125
INFO:root:11:20:18 Time cost=5.20s, throughput=384.82 samples/s
INFO:root:11:20:20 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:11:20:20 Time cost=30.16s
INFO:root:11:20:23 [Epoch 4 Batch 40/254] loss=0.1193, lr=0.0000143, metrics:accuracy:0.9611
INFO:root:11:20:27 [Epoch 4 Batch 80/254] loss=0.1287, lr=0.0000140, metrics:accuracy:0.9604
INFO:root:11:20:30 [Epoch 4 Batch 120/254] loss=0.1285, lr=0.0000136, metrics:accuracy:0.9611
INFO:root:11:20:34 [Epoch 4 Batch 160/254] loss=0.1398, lr=0.0000133, metrics:accuracy:0.9606
INFO:root:11:20:38 [Epoch 4 Batch 200/254] loss=0.0950, lr=0.0000130, metrics:accuracy:0.9629
INFO:root:11:20:42 [Epoch 4 Batch 240/254] loss=0.1071, lr=0.0000126, metrics:accuracy:0.9637
INFO:root:11:20:43 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:20:44 [Batch 40/250] loss=0.2470, metrics:accuracy:0.9313
INFO:root:11:20:45 [Batch 80/250] loss=0.3885, metrics:accuracy:0.9062
INFO:root:11:20:46 [Batch 120/250] loss=0.3413, metrics:accuracy:0.9073
INFO:root:11:20:47 [Batch 160/250] loss=0.3371, metrics:accuracy:0.9086
INFO:root:11:20:47 [Batch 200/250] loss=0.3630, metrics:accuracy:0.9087
INFO:root:11:20:48 [Batch 240/250] loss=0.3324, metrics:accuracy:0.9089
INFO:root:11:20:48 validation metrics:accuracy:0.9090
INFO:root:11:20:48 Time cost=5.19s, throughput=385.53 samples/s
INFO:root:11:20:50 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:11:20:50 Time cost=30.51s
INFO:root:11:20:54 [Epoch 5 Batch 40/254] loss=0.0933, lr=0.0000122, metrics:accuracy:0.9703
INFO:root:11:20:58 [Epoch 5 Batch 80/254] loss=0.0852, lr=0.0000118, metrics:accuracy:0.9743
INFO:root:11:21:01 [Epoch 5 Batch 120/254] loss=0.0832, lr=0.0000115, metrics:accuracy:0.9749
INFO:root:11:21:05 [Epoch 5 Batch 160/254] loss=0.0778, lr=0.0000112, metrics:accuracy:0.9755
INFO:root:11:21:09 [Epoch 5 Batch 200/254] loss=0.0620, lr=0.0000108, metrics:accuracy:0.9771
INFO:root:11:21:12 [Epoch 5 Batch 240/254] loss=0.0820, lr=0.0000105, metrics:accuracy:0.9774
INFO:root:11:21:14 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:21:15 [Batch 40/250] loss=0.2984, metrics:accuracy:0.9250
INFO:root:11:21:16 [Batch 80/250] loss=0.4559, metrics:accuracy:0.9078
INFO:root:11:21:16 [Batch 120/250] loss=0.4413, metrics:accuracy:0.9062
INFO:root:11:21:17 [Batch 160/250] loss=0.3740, metrics:accuracy:0.9109
INFO:root:11:21:18 [Batch 200/250] loss=0.4583, metrics:accuracy:0.9094
INFO:root:11:21:19 [Batch 240/250] loss=0.4504, metrics:accuracy:0.9073
INFO:root:11:21:19 validation metrics:accuracy:0.9075
INFO:root:11:21:19 Time cost=5.18s, throughput=386.37 samples/s
INFO:root:11:21:21 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:11:21:21 Time cost=30.56s
INFO:root:11:21:24 [Epoch 6 Batch 40/254] loss=0.0677, lr=0.0000100, metrics:accuracy:0.9820
INFO:root:11:21:28 [Epoch 6 Batch 80/254] loss=0.0725, lr=0.0000097, metrics:accuracy:0.9816
INFO:root:11:21:32 [Epoch 6 Batch 120/254] loss=0.0273, lr=0.0000094, metrics:accuracy:0.9850
INFO:root:11:21:36 [Epoch 6 Batch 160/254] loss=0.0578, lr=0.0000090, metrics:accuracy:0.9850
INFO:root:11:21:39 [Epoch 6 Batch 200/254] loss=0.0698, lr=0.0000087, metrics:accuracy:0.9843
INFO:root:11:21:43 [Epoch 6 Batch 240/254] loss=0.0531, lr=0.0000083, metrics:accuracy:0.9846
INFO:root:11:21:44 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:21:45 [Batch 40/250] loss=0.4395, metrics:accuracy:0.9125
INFO:root:11:21:46 [Batch 80/250] loss=0.5451, metrics:accuracy:0.9078
INFO:root:11:21:47 [Batch 120/250] loss=0.5490, metrics:accuracy:0.9031
INFO:root:11:21:48 [Batch 160/250] loss=0.5368, metrics:accuracy:0.9023
INFO:root:11:21:49 [Batch 200/250] loss=0.5582, metrics:accuracy:0.9019
INFO:root:11:21:49 [Batch 240/250] loss=0.4664, metrics:accuracy:0.9010
INFO:root:11:21:50 validation metrics:accuracy:0.9015
INFO:root:11:21:50 Time cost=5.27s, throughput=379.27 samples/s
INFO:root:11:21:51 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:11:21:51 Time cost=30.47s
INFO:root:11:21:54 [Epoch 7 Batch 40/254] loss=0.0568, lr=0.0000079, metrics:accuracy:0.9841
INFO:root:11:21:58 [Epoch 7 Batch 80/254] loss=0.0348, lr=0.0000076, metrics:accuracy:0.9877
INFO:root:11:22:02 [Epoch 7 Batch 120/254] loss=0.0454, lr=0.0000072, metrics:accuracy:0.9869
INFO:root:11:22:06 [Epoch 7 Batch 160/254] loss=0.0362, lr=0.0000069, metrics:accuracy:0.9871
INFO:root:11:22:10 [Epoch 7 Batch 200/254] loss=0.0502, lr=0.0000065, metrics:accuracy:0.9867
INFO:root:11:22:13 [Epoch 7 Batch 240/254] loss=0.0354, lr=0.0000062, metrics:accuracy:0.9873
INFO:root:11:22:15 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:22:16 [Batch 40/250] loss=0.4267, metrics:accuracy:0.9187
INFO:root:11:22:16 [Batch 80/250] loss=0.5822, metrics:accuracy:0.9062
INFO:root:11:22:17 [Batch 120/250] loss=0.5938, metrics:accuracy:0.9021
INFO:root:11:22:18 [Batch 160/250] loss=0.5274, metrics:accuracy:0.9039
INFO:root:11:22:19 [Batch 200/250] loss=0.5924, metrics:accuracy:0.9031
INFO:root:11:22:20 [Batch 240/250] loss=0.5953, metrics:accuracy:0.9010
INFO:root:11:22:20 validation metrics:accuracy:0.9020
INFO:root:11:22:20 Time cost=5.13s, throughput=389.90 samples/s
INFO:root:11:22:21 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:11:22:21 Time cost=30.34s
INFO:root:11:22:26 [Epoch 8 Batch 40/254] loss=0.0214, lr=0.0000058, metrics:accuracy:0.9928
INFO:root:11:22:29 [Epoch 8 Batch 80/254] loss=0.0337, lr=0.0000054, metrics:accuracy:0.9912
INFO:root:11:22:33 [Epoch 8 Batch 120/254] loss=0.0253, lr=0.0000051, metrics:accuracy:0.9917
INFO:root:11:22:36 [Epoch 8 Batch 160/254] loss=0.0178, lr=0.0000047, metrics:accuracy:0.9928
INFO:root:11:22:40 [Epoch 8 Batch 200/254] loss=0.0349, lr=0.0000044, metrics:accuracy:0.9924
INFO:root:11:22:44 [Epoch 8 Batch 240/254] loss=0.0493, lr=0.0000041, metrics:accuracy:0.9915
INFO:root:11:22:45 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:22:46 [Batch 40/250] loss=0.4677, metrics:accuracy:0.9250
INFO:root:11:22:47 [Batch 80/250] loss=0.5982, metrics:accuracy:0.9156
INFO:root:11:22:47 [Batch 120/250] loss=0.7144, metrics:accuracy:0.9062
INFO:root:11:22:48 [Batch 160/250] loss=0.5444, metrics:accuracy:0.9086
INFO:root:11:22:49 [Batch 200/250] loss=0.6388, metrics:accuracy:0.9081
INFO:root:11:22:50 [Batch 240/250] loss=0.6512, metrics:accuracy:0.9042
INFO:root:11:22:50 validation metrics:accuracy:0.9045
INFO:root:11:22:50 Time cost=5.17s, throughput=386.95 samples/s
INFO:root:11:22:52 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:11:22:52 Time cost=30.23s
INFO:root:11:22:55 [Epoch 9 Batch 40/254] loss=0.0194, lr=0.0000036, metrics:accuracy:0.9943
INFO:root:11:22:59 [Epoch 9 Batch 80/254] loss=0.0186, lr=0.0000033, metrics:accuracy:0.9948
INFO:root:11:23:03 [Epoch 9 Batch 120/254] loss=0.0178, lr=0.0000029, metrics:accuracy:0.9952
INFO:root:11:23:07 [Epoch 9 Batch 160/254] loss=0.0250, lr=0.0000026, metrics:accuracy:0.9947
INFO:root:11:23:11 [Epoch 9 Batch 200/254] loss=0.0228, lr=0.0000023, metrics:accuracy:0.9946
INFO:root:11:23:14 [Epoch 9 Batch 240/254] loss=0.0086, lr=0.0000019, metrics:accuracy:0.9953
INFO:root:11:23:15 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:23:16 [Batch 40/250] loss=0.4783, metrics:accuracy:0.9281
INFO:root:11:23:17 [Batch 80/250] loss=0.6372, metrics:accuracy:0.9156
INFO:root:11:23:18 [Batch 120/250] loss=0.7590, metrics:accuracy:0.9062
INFO:root:11:23:19 [Batch 160/250] loss=0.6017, metrics:accuracy:0.9070
INFO:root:11:23:20 [Batch 200/250] loss=0.7102, metrics:accuracy:0.9056
INFO:root:11:23:20 [Batch 240/250] loss=0.7141, metrics:accuracy:0.9031
INFO:root:11:23:20 validation metrics:accuracy:0.9035
INFO:root:11:23:20 Time cost=5.23s, throughput=382.42 samples/s
INFO:root:11:23:22 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:11:23:22 Time cost=30.30s
INFO:root:11:23:26 [Epoch 10 Batch 40/254] loss=0.0166, lr=0.0000015, metrics:accuracy:0.9953
INFO:root:11:23:29 [Epoch 10 Batch 80/254] loss=0.0271, lr=0.0000011, metrics:accuracy:0.9929
INFO:root:11:23:33 [Epoch 10 Batch 120/254] loss=0.0050, lr=0.0000008, metrics:accuracy:0.9945
INFO:root:11:23:37 [Epoch 10 Batch 160/254] loss=0.0208, lr=0.0000005, metrics:accuracy:0.9944
INFO:root:11:23:41 [Epoch 10 Batch 200/254] loss=0.0024, lr=0.0000001, metrics:accuracy:0.9954
INFO:root:11:23:42 Finish training step: 2500
INFO:root:11:23:42 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:23:43 [Batch 40/250] loss=0.4774, metrics:accuracy:0.9281
INFO:root:11:23:44 [Batch 80/250] loss=0.6616, metrics:accuracy:0.9156
INFO:root:11:23:44 [Batch 120/250] loss=0.7875, metrics:accuracy:0.9062
INFO:root:11:23:45 [Batch 160/250] loss=0.5999, metrics:accuracy:0.9078
INFO:root:11:23:46 [Batch 200/250] loss=0.6884, metrics:accuracy:0.9062
INFO:root:11:23:47 [Batch 240/250] loss=0.7225, metrics:accuracy:0.9021
INFO:root:11:23:47 validation metrics:accuracy:0.9025
INFO:root:11:23:47 Time cost=5.23s, throughput=382.37 samples/s
INFO:root:11:23:49 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:11:23:49 Time cost=27.23s
INFO:root:11:23:49 Best model at epoch 1. Validation metrics:accuracy:0.9150
INFO:root:11:23:49 Now we are doing testing on test with gpu(0).
INFO:root:11:23:55 Time cost=5.02s, throughput=396.86 samples/s
INFO:root:11:25:58 Namespace(accumulate=None, batch_size=32, bert_dataset='wiki_cn_cased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=0.0002, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:11:26:04 processing dataset...
INFO:root:11:26:05 Now we are doing BERT classification training on gpu(0)!
INFO:root:11:26:05 training steps=2500
INFO:root:11:26:10 [Epoch 1 Batch 40/254] loss=0.5723, lr=0.0000312, metrics:accuracy:0.7144
INFO:root:11:26:13 [Epoch 1 Batch 80/254] loss=0.6969, lr=0.0000632, metrics:accuracy:0.6711
INFO:root:11:26:17 [Epoch 1 Batch 120/254] loss=0.6801, lr=0.0000952, metrics:accuracy:0.6465
INFO:root:11:26:20 [Epoch 1 Batch 160/254] loss=0.6795, lr=0.0001272, metrics:accuracy:0.6403
INFO:root:11:26:24 [Epoch 1 Batch 200/254] loss=0.6530, lr=0.0001592, metrics:accuracy:0.6427
INFO:root:11:26:27 [Epoch 1 Batch 240/254] loss=0.6797, lr=0.0001912, metrics:accuracy:0.6388
INFO:root:11:26:29 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:26:30 [Batch 40/250] loss=0.6543, metrics:accuracy:0.6750
INFO:root:11:26:30 [Batch 80/250] loss=0.6316, metrics:accuracy:0.6844
INFO:root:11:26:31 [Batch 120/250] loss=0.6959, metrics:accuracy:0.6698
INFO:root:11:26:32 [Batch 160/250] loss=0.6694, metrics:accuracy:0.6680
INFO:root:11:26:33 [Batch 200/250] loss=0.6278, metrics:accuracy:0.6737
INFO:root:11:26:34 [Batch 240/250] loss=0.6618, metrics:accuracy:0.6729
INFO:root:11:26:34 validation metrics:accuracy:0.6750
INFO:root:11:26:34 Time cost=4.97s, throughput=402.25 samples/s
INFO:root:11:26:36 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:11:26:36 Time cost=30.58s
INFO:root:11:26:39 [Epoch 2 Batch 40/254] loss=0.6713, lr=0.0001962, metrics:accuracy:0.6094
INFO:root:11:26:43 [Epoch 2 Batch 80/254] loss=0.6732, lr=0.0001926, metrics:accuracy:0.6070
INFO:root:11:26:47 [Epoch 2 Batch 120/254] loss=0.6339, lr=0.0001891, metrics:accuracy:0.6294
INFO:root:11:26:51 [Epoch 2 Batch 160/254] loss=0.6310, lr=0.0001855, metrics:accuracy:0.6376
INFO:root:11:26:55 [Epoch 2 Batch 200/254] loss=0.6488, lr=0.0001820, metrics:accuracy:0.6402
INFO:root:11:26:58 [Epoch 2 Batch 240/254] loss=0.6752, lr=0.0001784, metrics:accuracy:0.6400
INFO:root:11:26:59 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:27:00 [Batch 40/250] loss=0.6700, metrics:accuracy:0.6750
INFO:root:11:27:01 [Batch 80/250] loss=0.6672, metrics:accuracy:0.6844
INFO:root:11:27:02 [Batch 120/250] loss=0.6751, metrics:accuracy:0.6698
INFO:root:11:27:03 [Batch 160/250] loss=0.6718, metrics:accuracy:0.6680
INFO:root:11:27:03 [Batch 200/250] loss=0.6668, metrics:accuracy:0.6737
INFO:root:11:27:04 [Batch 240/250] loss=0.6709, metrics:accuracy:0.6729
INFO:root:11:27:05 validation metrics:accuracy:0.6750
INFO:root:11:27:05 Time cost=5.16s, throughput=387.95 samples/s
INFO:root:11:27:06 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:11:27:06 Time cost=30.76s
INFO:root:11:27:10 [Epoch 3 Batch 40/254] loss=0.6809, lr=0.0001736, metrics:accuracy:0.5960
INFO:root:11:27:14 [Epoch 3 Batch 80/254] loss=0.6641, lr=0.0001700, metrics:accuracy:0.6098
INFO:root:11:27:18 [Epoch 3 Batch 120/254] loss=0.6562, lr=0.0001665, metrics:accuracy:0.6289
INFO:root:11:27:22 [Epoch 3 Batch 160/254] loss=0.6524, lr=0.0001629, metrics:accuracy:0.6385
INFO:root:11:27:26 [Epoch 3 Batch 200/254] loss=0.6552, lr=0.0001594, metrics:accuracy:0.6481
INFO:root:11:27:30 [Epoch 3 Batch 240/254] loss=0.6497, lr=0.0001558, metrics:accuracy:0.6500
INFO:root:11:27:32 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:27:32 [Batch 40/250] loss=0.6308, metrics:accuracy:0.6750
INFO:root:11:27:33 [Batch 80/250] loss=0.6178, metrics:accuracy:0.6844
INFO:root:11:27:34 [Batch 120/250] loss=0.6545, metrics:accuracy:0.6698
INFO:root:11:27:35 [Batch 160/250] loss=0.6394, metrics:accuracy:0.6680
INFO:root:11:27:36 [Batch 200/250] loss=0.6156, metrics:accuracy:0.6737
INFO:root:11:27:37 [Batch 240/250] loss=0.6351, metrics:accuracy:0.6729
INFO:root:11:27:37 validation metrics:accuracy:0.6750
INFO:root:11:27:37 Time cost=5.18s, throughput=386.37 samples/s
INFO:root:11:27:38 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:11:27:38 Time cost=31.76s
INFO:root:11:27:42 [Epoch 4 Batch 40/254] loss=0.6592, lr=0.0001510, metrics:accuracy:0.6365
INFO:root:11:27:46 [Epoch 4 Batch 80/254] loss=0.6200, lr=0.0001475, metrics:accuracy:0.6700
INFO:root:11:27:50 [Epoch 4 Batch 120/254] loss=0.6758, lr=0.0001439, metrics:accuracy:0.6534
INFO:root:11:27:54 [Epoch 4 Batch 160/254] loss=0.6663, lr=0.0001404, metrics:accuracy:0.6492
INFO:root:11:27:58 [Epoch 4 Batch 200/254] loss=0.6498, lr=0.0001368, metrics:accuracy:0.6515
INFO:root:11:28:03 [Epoch 4 Batch 240/254] loss=0.6590, lr=0.0001332, metrics:accuracy:0.6517
INFO:root:11:28:04 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:28:05 [Batch 40/250] loss=0.6464, metrics:accuracy:0.6750
INFO:root:11:28:06 [Batch 80/250] loss=0.6254, metrics:accuracy:0.6844
INFO:root:11:28:06 [Batch 120/250] loss=0.6849, metrics:accuracy:0.6698
INFO:root:11:28:07 [Batch 160/250] loss=0.6604, metrics:accuracy:0.6680
INFO:root:11:28:08 [Batch 200/250] loss=0.6219, metrics:accuracy:0.6737
INFO:root:11:28:09 [Batch 240/250] loss=0.6534, metrics:accuracy:0.6729
INFO:root:11:28:09 validation metrics:accuracy:0.6750
INFO:root:11:28:09 Time cost=5.05s, throughput=396.22 samples/s
INFO:root:11:28:12 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:11:28:12 Time cost=34.20s
INFO:root:11:28:16 [Epoch 5 Batch 40/254] loss=0.6904, lr=0.0001284, metrics:accuracy:0.6156
INFO:root:11:28:20 [Epoch 5 Batch 80/254] loss=0.6553, lr=0.0001249, metrics:accuracy:0.6381
INFO:root:11:28:24 [Epoch 5 Batch 120/254] loss=0.6263, lr=0.0001213, metrics:accuracy:0.6547
INFO:root:11:28:28 [Epoch 5 Batch 160/254] loss=0.6575, lr=0.0001178, metrics:accuracy:0.6552
INFO:root:11:28:32 [Epoch 5 Batch 200/254] loss=0.6567, lr=0.0001142, metrics:accuracy:0.6541
INFO:root:11:28:36 [Epoch 5 Batch 240/254] loss=0.6260, lr=0.0001107, metrics:accuracy:0.6581
INFO:root:11:28:38 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:28:39 [Batch 40/250] loss=0.6309, metrics:accuracy:0.6750
INFO:root:11:28:40 [Batch 80/250] loss=0.6162, metrics:accuracy:0.6844
INFO:root:11:28:41 [Batch 120/250] loss=0.6579, metrics:accuracy:0.6698
INFO:root:11:28:41 [Batch 160/250] loss=0.6407, metrics:accuracy:0.6680
INFO:root:11:28:42 [Batch 200/250] loss=0.6137, metrics:accuracy:0.6737
INFO:root:11:28:43 [Batch 240/250] loss=0.6358, metrics:accuracy:0.6729
INFO:root:11:28:43 validation metrics:accuracy:0.6750
INFO:root:11:28:43 Time cost=5.46s, throughput=366.35 samples/s
INFO:root:11:28:46 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:11:28:46 Time cost=33.29s
INFO:root:11:28:50 [Epoch 6 Batch 40/254] loss=0.6800, lr=0.0001059, metrics:accuracy:0.5984
INFO:root:11:28:54 [Epoch 6 Batch 80/254] loss=0.6665, lr=0.0001023, metrics:accuracy:0.6043
INFO:root:11:28:58 [Epoch 6 Batch 120/254] loss=0.6077, lr=0.0000988, metrics:accuracy:0.6406
INFO:root:11:29:02 [Epoch 6 Batch 160/254] loss=0.6363, lr=0.0000952, metrics:accuracy:0.6515
INFO:root:11:29:06 [Epoch 6 Batch 200/254] loss=0.6448, lr=0.0000916, metrics:accuracy:0.6533
INFO:root:11:29:10 [Epoch 6 Batch 240/254] loss=0.6552, lr=0.0000881, metrics:accuracy:0.6504
INFO:root:11:29:11 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:29:12 [Batch 40/250] loss=0.6313, metrics:accuracy:0.6750
INFO:root:11:29:13 [Batch 80/250] loss=0.6192, metrics:accuracy:0.6844
INFO:root:11:29:14 [Batch 120/250] loss=0.6536, metrics:accuracy:0.6698
INFO:root:11:29:15 [Batch 160/250] loss=0.6394, metrics:accuracy:0.6680
INFO:root:11:29:16 [Batch 200/250] loss=0.6172, metrics:accuracy:0.6737
INFO:root:11:29:16 [Batch 240/250] loss=0.6354, metrics:accuracy:0.6729
INFO:root:11:29:17 validation metrics:accuracy:0.6750
INFO:root:11:29:17 Time cost=5.39s, throughput=371.20 samples/s
INFO:root:11:29:23 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:11:29:23 Time cost=37.42s
INFO:root:11:29:27 [Epoch 7 Batch 40/254] loss=0.6837, lr=0.0000833, metrics:accuracy:0.5940
INFO:root:11:29:30 [Epoch 7 Batch 80/254] loss=0.6564, lr=0.0000797, metrics:accuracy:0.6187
INFO:root:11:29:35 [Epoch 7 Batch 120/254] loss=0.6337, lr=0.0000762, metrics:accuracy:0.6384
INFO:root:11:29:39 [Epoch 7 Batch 160/254] loss=0.6357, lr=0.0000726, metrics:accuracy:0.6526
INFO:root:11:29:43 [Epoch 7 Batch 200/254] loss=0.6532, lr=0.0000691, metrics:accuracy:0.6541
INFO:root:11:29:47 [Epoch 7 Batch 240/254] loss=0.6259, lr=0.0000655, metrics:accuracy:0.6609
INFO:root:11:29:48 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:29:49 [Batch 40/250] loss=0.6343, metrics:accuracy:0.6750
INFO:root:11:29:50 [Batch 80/250] loss=0.6171, metrics:accuracy:0.6844
INFO:root:11:29:51 [Batch 120/250] loss=0.6659, metrics:accuracy:0.6698
INFO:root:11:29:52 [Batch 160/250] loss=0.6458, metrics:accuracy:0.6680
INFO:root:11:29:52 [Batch 200/250] loss=0.6142, metrics:accuracy:0.6737
INFO:root:11:29:53 [Batch 240/250] loss=0.6401, metrics:accuracy:0.6729
INFO:root:11:29:53 validation metrics:accuracy:0.6750
INFO:root:11:29:53 Time cost=5.28s, throughput=378.60 samples/s
INFO:root:11:29:56 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:11:29:56 Time cost=32.69s
INFO:root:11:30:00 [Epoch 8 Batch 40/254] loss=0.6430, lr=0.0000607, metrics:accuracy:0.6664
INFO:root:11:30:04 [Epoch 8 Batch 80/254] loss=0.6672, lr=0.0000572, metrics:accuracy:0.6406
INFO:root:11:30:08 [Epoch 8 Batch 120/254] loss=0.6442, lr=0.0000536, metrics:accuracy:0.6507
INFO:root:11:30:12 [Epoch 8 Batch 160/254] loss=0.6451, lr=0.0000500, metrics:accuracy:0.6557
INFO:root:11:30:16 [Epoch 8 Batch 200/254] loss=0.6433, lr=0.0000465, metrics:accuracy:0.6574
INFO:root:11:30:19 [Epoch 8 Batch 240/254] loss=0.6570, lr=0.0000429, metrics:accuracy:0.6536
INFO:root:11:30:21 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:30:21 [Batch 40/250] loss=0.6354, metrics:accuracy:0.6750
INFO:root:11:30:22 [Batch 80/250] loss=0.6177, metrics:accuracy:0.6844
INFO:root:11:30:23 [Batch 120/250] loss=0.6678, metrics:accuracy:0.6698
INFO:root:11:30:24 [Batch 160/250] loss=0.6471, metrics:accuracy:0.6680
INFO:root:11:30:25 [Batch 200/250] loss=0.6147, metrics:accuracy:0.6737
INFO:root:11:30:26 [Batch 240/250] loss=0.6413, metrics:accuracy:0.6729
INFO:root:11:30:26 validation metrics:accuracy:0.6750
INFO:root:11:30:26 Time cost=5.09s, throughput=393.08 samples/s
INFO:root:11:30:28 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:11:30:28 Time cost=32.19s
INFO:root:11:30:32 [Epoch 9 Batch 40/254] loss=0.6698, lr=0.0000381, metrics:accuracy:0.6494
INFO:root:11:30:36 [Epoch 9 Batch 80/254] loss=0.6268, lr=0.0000346, metrics:accuracy:0.6667
INFO:root:11:30:40 [Epoch 9 Batch 120/254] loss=0.6525, lr=0.0000310, metrics:accuracy:0.6621
INFO:root:11:30:44 [Epoch 9 Batch 160/254] loss=0.6600, lr=0.0000275, metrics:accuracy:0.6571
INFO:root:11:30:48 [Epoch 9 Batch 200/254] loss=0.6236, lr=0.0000239, metrics:accuracy:0.6625
INFO:root:11:30:51 [Epoch 9 Batch 240/254] loss=0.6498, lr=0.0000204, metrics:accuracy:0.6631
INFO:root:11:30:53 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:30:53 [Batch 40/250] loss=0.6306, metrics:accuracy:0.6750
INFO:root:11:30:54 [Batch 80/250] loss=0.6170, metrics:accuracy:0.6844
INFO:root:11:30:55 [Batch 120/250] loss=0.6555, metrics:accuracy:0.6698
INFO:root:11:30:56 [Batch 160/250] loss=0.6396, metrics:accuracy:0.6680
INFO:root:11:30:57 [Batch 200/250] loss=0.6147, metrics:accuracy:0.6737
INFO:root:11:30:58 [Batch 240/250] loss=0.6351, metrics:accuracy:0.6729
INFO:root:11:30:58 validation metrics:accuracy:0.6750
INFO:root:11:30:58 Time cost=5.28s, throughput=378.43 samples/s
INFO:root:11:31:03 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:11:31:03 Time cost=35.09s
INFO:root:11:31:07 [Epoch 10 Batch 40/254] loss=0.6359, lr=0.0000156, metrics:accuracy:0.6789
INFO:root:11:31:10 [Epoch 10 Batch 80/254] loss=0.6587, lr=0.0000120, metrics:accuracy:0.6587
INFO:root:11:31:14 [Epoch 10 Batch 120/254] loss=0.6272, lr=0.0000084, metrics:accuracy:0.6652
INFO:root:11:31:18 [Epoch 10 Batch 160/254] loss=0.6424, lr=0.0000049, metrics:accuracy:0.6636
INFO:root:11:31:22 [Epoch 10 Batch 200/254] loss=0.6178, lr=0.0000013, metrics:accuracy:0.6710
INFO:root:11:31:23 Finish training step: 2500
INFO:root:11:31:23 Now we are doing evaluation on dev with gpu(0).
INFO:root:11:31:24 [Batch 40/250] loss=0.6315, metrics:accuracy:0.6750
INFO:root:11:31:25 [Batch 80/250] loss=0.6195, metrics:accuracy:0.6844
INFO:root:11:31:26 [Batch 120/250] loss=0.6534, metrics:accuracy:0.6698
INFO:root:11:31:27 [Batch 160/250] loss=0.6394, metrics:accuracy:0.6680
INFO:root:11:31:27 [Batch 200/250] loss=0.6175, metrics:accuracy:0.6737
INFO:root:11:31:28 [Batch 240/250] loss=0.6355, metrics:accuracy:0.6729
INFO:root:11:31:28 validation metrics:accuracy:0.6750
INFO:root:11:31:28 Time cost=5.13s, throughput=390.18 samples/s
INFO:root:11:31:30 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:11:31:30 Time cost=26.94s
INFO:root:11:31:30 Best model at epoch 0. Validation metrics:accuracy:0.6750
INFO:root:11:31:30 Now we are doing testing on test with gpu(0).
INFO:root:11:31:35 Time cost=5.16s, throughput=385.88 samples/s
INFO:root:15:26:47 Namespace(accumulate=None, batch_size=32, bert_dataset='wiki_cn_cased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=1e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.1)
INFO:root:15:26:51 processing dataset...
INFO:root:15:26:53 Now we are doing BERT classification training on gpu(0)!
INFO:root:15:26:53 training steps=2500
INFO:root:15:26:57 [Epoch 1 Batch 40/254] loss=0.6166, lr=0.0000016, metrics:accuracy:0.6628
INFO:root:15:27:01 [Epoch 1 Batch 80/254] loss=0.4307, lr=0.0000032, metrics:accuracy:0.7365
INFO:root:15:27:05 [Epoch 1 Batch 120/254] loss=0.3586, lr=0.0000048, metrics:accuracy:0.7795
INFO:root:15:27:08 [Epoch 1 Batch 160/254] loss=0.3022, lr=0.0000064, metrics:accuracy:0.8073
INFO:root:15:27:12 [Epoch 1 Batch 200/254] loss=0.2923, lr=0.0000080, metrics:accuracy:0.8261
INFO:root:15:27:15 [Epoch 1 Batch 240/254] loss=0.2854, lr=0.0000096, metrics:accuracy:0.8363
INFO:root:15:27:17 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:27:17 [Batch 40/250] loss=0.1963, metrics:accuracy:0.9250
INFO:root:15:27:18 [Batch 80/250] loss=0.2810, metrics:accuracy:0.9016
INFO:root:15:27:19 [Batch 120/250] loss=0.2258, metrics:accuracy:0.9010
INFO:root:15:27:20 [Batch 160/250] loss=0.2793, metrics:accuracy:0.9000
INFO:root:15:27:21 [Batch 200/250] loss=0.3006, metrics:accuracy:0.8988
INFO:root:15:27:22 [Batch 240/250] loss=0.3090, metrics:accuracy:0.8979
INFO:root:15:27:22 validation metrics:accuracy:0.8980
INFO:root:15:27:22 Time cost=5.23s, throughput=382.29 samples/s
INFO:root:15:27:23 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:15:27:23 Time cost=30.58s
INFO:root:15:27:27 [Epoch 2 Batch 40/254] loss=0.2618, lr=0.0000098, metrics:accuracy:0.9117
INFO:root:15:27:31 [Epoch 2 Batch 80/254] loss=0.2181, lr=0.0000096, metrics:accuracy:0.9175
INFO:root:15:27:35 [Epoch 2 Batch 120/254] loss=0.2292, lr=0.0000095, metrics:accuracy:0.9173
INFO:root:15:27:38 [Epoch 2 Batch 160/254] loss=0.2049, lr=0.0000093, metrics:accuracy:0.9193
INFO:root:15:27:42 [Epoch 2 Batch 200/254] loss=0.2557, lr=0.0000091, metrics:accuracy:0.9160
INFO:root:15:27:46 [Epoch 2 Batch 240/254] loss=0.2206, lr=0.0000089, metrics:accuracy:0.9170
INFO:root:15:27:47 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:27:47 [Batch 40/250] loss=0.1775, metrics:accuracy:0.9437
INFO:root:15:27:48 [Batch 80/250] loss=0.2477, metrics:accuracy:0.9234
INFO:root:15:27:49 [Batch 120/250] loss=0.2242, metrics:accuracy:0.9219
INFO:root:15:27:50 [Batch 160/250] loss=0.2391, metrics:accuracy:0.9180
INFO:root:15:27:51 [Batch 200/250] loss=0.2621, metrics:accuracy:0.9163
INFO:root:15:27:52 [Batch 240/250] loss=0.3025, metrics:accuracy:0.9146
INFO:root:15:27:52 validation metrics:accuracy:0.9140
INFO:root:15:27:52 Time cost=5.23s, throughput=382.73 samples/s
INFO:root:15:27:53 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:15:27:53 Time cost=29.79s
INFO:root:15:27:57 [Epoch 3 Batch 40/254] loss=0.1929, lr=0.0000087, metrics:accuracy:0.9376
INFO:root:15:28:00 [Epoch 3 Batch 80/254] loss=0.1683, lr=0.0000085, metrics:accuracy:0.9411
INFO:root:15:28:04 [Epoch 3 Batch 120/254] loss=0.1958, lr=0.0000083, metrics:accuracy:0.9381
INFO:root:15:28:08 [Epoch 3 Batch 160/254] loss=0.1626, lr=0.0000081, metrics:accuracy:0.9388
INFO:root:15:28:11 [Epoch 3 Batch 200/254] loss=0.1556, lr=0.0000080, metrics:accuracy:0.9401
INFO:root:15:28:15 [Epoch 3 Batch 240/254] loss=0.1683, lr=0.0000078, metrics:accuracy:0.9408
INFO:root:15:28:16 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:28:17 [Batch 40/250] loss=0.2084, metrics:accuracy:0.9406
INFO:root:15:28:18 [Batch 80/250] loss=0.2711, metrics:accuracy:0.9219
INFO:root:15:28:19 [Batch 120/250] loss=0.3035, metrics:accuracy:0.9135
INFO:root:15:28:20 [Batch 160/250] loss=0.2762, metrics:accuracy:0.9164
INFO:root:15:28:20 [Batch 200/250] loss=0.2997, metrics:accuracy:0.9137
INFO:root:15:28:21 [Batch 240/250] loss=0.3167, metrics:accuracy:0.9115
INFO:root:15:28:21 validation metrics:accuracy:0.9110
INFO:root:15:28:21 Time cost=5.02s, throughput=398.58 samples/s
INFO:root:15:28:23 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:15:28:23 Time cost=29.58s
INFO:root:15:28:26 [Epoch 4 Batch 40/254] loss=0.1129, lr=0.0000076, metrics:accuracy:0.9571
INFO:root:15:28:30 [Epoch 4 Batch 80/254] loss=0.1262, lr=0.0000074, metrics:accuracy:0.9584
INFO:root:15:28:33 [Epoch 4 Batch 120/254] loss=0.1143, lr=0.0000072, metrics:accuracy:0.9584
INFO:root:15:28:37 [Epoch 4 Batch 160/254] loss=0.1372, lr=0.0000070, metrics:accuracy:0.9586
INFO:root:15:28:40 [Epoch 4 Batch 200/254] loss=0.0966, lr=0.0000068, metrics:accuracy:0.9601
INFO:root:15:28:44 [Epoch 4 Batch 240/254] loss=0.1137, lr=0.0000067, metrics:accuracy:0.9611
INFO:root:15:28:46 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:28:47 [Batch 40/250] loss=0.2507, metrics:accuracy:0.9437
INFO:root:15:28:47 [Batch 80/250] loss=0.3364, metrics:accuracy:0.9250
INFO:root:15:28:48 [Batch 120/250] loss=0.3636, metrics:accuracy:0.9187
INFO:root:15:28:49 [Batch 160/250] loss=0.3151, metrics:accuracy:0.9195
INFO:root:15:28:50 [Batch 200/250] loss=0.3675, metrics:accuracy:0.9163
INFO:root:15:28:50 [Batch 240/250] loss=0.3652, metrics:accuracy:0.9151
INFO:root:15:28:51 validation metrics:accuracy:0.9145
INFO:root:15:28:51 Time cost=4.94s, throughput=404.66 samples/s
INFO:root:15:28:52 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:15:28:52 Time cost=29.31s
INFO:root:15:28:56 [Epoch 5 Batch 40/254] loss=0.0948, lr=0.0000064, metrics:accuracy:0.9664
INFO:root:15:28:59 [Epoch 5 Batch 80/254] loss=0.0780, lr=0.0000062, metrics:accuracy:0.9724
INFO:root:15:29:03 [Epoch 5 Batch 120/254] loss=0.0688, lr=0.0000061, metrics:accuracy:0.9744
INFO:root:15:29:06 [Epoch 5 Batch 160/254] loss=0.0891, lr=0.0000059, metrics:accuracy:0.9743
INFO:root:15:29:10 [Epoch 5 Batch 200/254] loss=0.0796, lr=0.0000057, metrics:accuracy:0.9745
INFO:root:15:29:14 [Epoch 5 Batch 240/254] loss=0.0962, lr=0.0000055, metrics:accuracy:0.9741
INFO:root:15:29:15 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:29:16 [Batch 40/250] loss=0.2973, metrics:accuracy:0.9313
INFO:root:15:29:17 [Batch 80/250] loss=0.4275, metrics:accuracy:0.9172
INFO:root:15:29:17 [Batch 120/250] loss=0.4060, metrics:accuracy:0.9167
INFO:root:15:29:18 [Batch 160/250] loss=0.3736, metrics:accuracy:0.9164
INFO:root:15:29:19 [Batch 200/250] loss=0.4375, metrics:accuracy:0.9144
INFO:root:15:29:20 [Batch 240/250] loss=0.4248, metrics:accuracy:0.9115
INFO:root:15:29:20 validation metrics:accuracy:0.9115
INFO:root:15:29:20 Time cost=5.02s, throughput=398.18 samples/s
INFO:root:15:29:21 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:15:29:21 Time cost=29.18s
INFO:root:15:29:25 [Epoch 6 Batch 40/254] loss=0.0691, lr=0.0000053, metrics:accuracy:0.9781
INFO:root:15:29:28 [Epoch 6 Batch 80/254] loss=0.0713, lr=0.0000051, metrics:accuracy:0.9789
INFO:root:15:29:32 [Epoch 6 Batch 120/254] loss=0.0445, lr=0.0000049, metrics:accuracy:0.9819
INFO:root:15:29:36 [Epoch 6 Batch 160/254] loss=0.0602, lr=0.0000048, metrics:accuracy:0.9817
INFO:root:15:29:39 [Epoch 6 Batch 200/254] loss=0.0584, lr=0.0000046, metrics:accuracy:0.9815
INFO:root:15:29:43 [Epoch 6 Batch 240/254] loss=0.0653, lr=0.0000044, metrics:accuracy:0.9818
INFO:root:15:29:44 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:29:45 [Batch 40/250] loss=0.3342, metrics:accuracy:0.9313
INFO:root:15:29:46 [Batch 80/250] loss=0.4684, metrics:accuracy:0.9187
INFO:root:15:29:47 [Batch 120/250] loss=0.4824, metrics:accuracy:0.9146
INFO:root:15:29:47 [Batch 160/250] loss=0.4081, metrics:accuracy:0.9148
INFO:root:15:29:48 [Batch 200/250] loss=0.4850, metrics:accuracy:0.9106
INFO:root:15:29:49 [Batch 240/250] loss=0.4234, metrics:accuracy:0.9078
INFO:root:15:29:49 validation metrics:accuracy:0.9080
INFO:root:15:29:49 Time cost=5.16s, throughput=387.38 samples/s
INFO:root:15:29:50 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:15:29:50 Time cost=29.17s
INFO:root:15:29:54 [Epoch 7 Batch 40/254] loss=0.0566, lr=0.0000042, metrics:accuracy:0.9794
INFO:root:15:29:57 [Epoch 7 Batch 80/254] loss=0.0401, lr=0.0000040, metrics:accuracy:0.9842
INFO:root:15:30:01 [Epoch 7 Batch 120/254] loss=0.0620, lr=0.0000038, metrics:accuracy:0.9847
INFO:root:15:30:05 [Epoch 7 Batch 160/254] loss=0.0428, lr=0.0000036, metrics:accuracy:0.9860
INFO:root:15:30:08 [Epoch 7 Batch 200/254] loss=0.0524, lr=0.0000035, metrics:accuracy:0.9857
INFO:root:15:30:12 [Epoch 7 Batch 240/254] loss=0.0367, lr=0.0000033, metrics:accuracy:0.9862
INFO:root:15:30:13 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:30:14 [Batch 40/250] loss=0.3972, metrics:accuracy:0.9406
INFO:root:15:30:15 [Batch 80/250] loss=0.5568, metrics:accuracy:0.9266
INFO:root:15:30:16 [Batch 120/250] loss=0.5755, metrics:accuracy:0.9177
INFO:root:15:30:17 [Batch 160/250] loss=0.5017, metrics:accuracy:0.9172
INFO:root:15:30:17 [Batch 200/250] loss=0.6098, metrics:accuracy:0.9131
INFO:root:15:30:18 [Batch 240/250] loss=0.4915, metrics:accuracy:0.9115
INFO:root:15:30:18 validation metrics:accuracy:0.9120
INFO:root:15:30:18 Time cost=5.04s, throughput=396.68 samples/s
INFO:root:15:30:20 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:15:30:20 Time cost=29.34s
INFO:root:15:30:24 [Epoch 8 Batch 40/254] loss=0.0400, lr=0.0000030, metrics:accuracy:0.9864
INFO:root:15:30:28 [Epoch 8 Batch 80/254] loss=0.0307, lr=0.0000029, metrics:accuracy:0.9876
INFO:root:15:30:32 [Epoch 8 Batch 120/254] loss=0.0361, lr=0.0000027, metrics:accuracy:0.9883
INFO:root:15:30:35 [Epoch 8 Batch 160/254] loss=0.0251, lr=0.0000025, metrics:accuracy:0.9895
INFO:root:15:30:39 [Epoch 8 Batch 200/254] loss=0.0259, lr=0.0000023, metrics:accuracy:0.9899
INFO:root:15:30:42 [Epoch 8 Batch 240/254] loss=0.0482, lr=0.0000021, metrics:accuracy:0.9888
INFO:root:15:30:44 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:30:45 [Batch 40/250] loss=0.4232, metrics:accuracy:0.9281
INFO:root:15:30:45 [Batch 80/250] loss=0.5734, metrics:accuracy:0.9172
INFO:root:15:30:46 [Batch 120/250] loss=0.6383, metrics:accuracy:0.9094
INFO:root:15:30:47 [Batch 160/250] loss=0.4979, metrics:accuracy:0.9125
INFO:root:15:30:48 [Batch 200/250] loss=0.6035, metrics:accuracy:0.9094
INFO:root:15:30:49 [Batch 240/250] loss=0.5072, metrics:accuracy:0.9078
INFO:root:15:30:49 validation metrics:accuracy:0.9080
INFO:root:15:30:49 Time cost=5.04s, throughput=396.80 samples/s
INFO:root:15:30:50 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:15:30:50 Time cost=30.40s
INFO:root:15:30:54 [Epoch 9 Batch 40/254] loss=0.0285, lr=0.0000019, metrics:accuracy:0.9887
INFO:root:15:30:58 [Epoch 9 Batch 80/254] loss=0.0243, lr=0.0000017, metrics:accuracy:0.9908
INFO:root:15:31:01 [Epoch 9 Batch 120/254] loss=0.0201, lr=0.0000016, metrics:accuracy:0.9907
INFO:root:15:31:05 [Epoch 9 Batch 160/254] loss=0.0362, lr=0.0000014, metrics:accuracy:0.9895
INFO:root:15:31:09 [Epoch 9 Batch 200/254] loss=0.0240, lr=0.0000012, metrics:accuracy:0.9903
INFO:root:15:31:12 [Epoch 9 Batch 240/254] loss=0.0393, lr=0.0000010, metrics:accuracy:0.9898
INFO:root:15:31:13 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:31:14 [Batch 40/250] loss=0.4284, metrics:accuracy:0.9313
INFO:root:15:31:15 [Batch 80/250] loss=0.6136, metrics:accuracy:0.9203
INFO:root:15:31:16 [Batch 120/250] loss=0.6208, metrics:accuracy:0.9146
INFO:root:15:31:16 [Batch 160/250] loss=0.5155, metrics:accuracy:0.9164
INFO:root:15:31:17 [Batch 200/250] loss=0.6984, metrics:accuracy:0.9100
INFO:root:15:31:18 [Batch 240/250] loss=0.5412, metrics:accuracy:0.9068
INFO:root:15:31:18 validation metrics:accuracy:0.9075
INFO:root:15:31:18 Time cost=4.98s, throughput=401.78 samples/s
INFO:root:15:31:19 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:15:31:19 Time cost=29.38s
INFO:root:15:31:23 [Epoch 10 Batch 40/254] loss=0.0195, lr=0.0000008, metrics:accuracy:0.9938
INFO:root:15:31:26 [Epoch 10 Batch 80/254] loss=0.0349, lr=0.0000006, metrics:accuracy:0.9906
INFO:root:15:31:30 [Epoch 10 Batch 120/254] loss=0.0151, lr=0.0000004, metrics:accuracy:0.9923
INFO:root:15:31:34 [Epoch 10 Batch 160/254] loss=0.0173, lr=0.0000002, metrics:accuracy:0.9923
INFO:root:15:31:38 [Epoch 10 Batch 200/254] loss=0.0111, lr=0.0000001, metrics:accuracy:0.9930
INFO:root:15:31:39 Finish training step: 2500
INFO:root:15:31:39 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:31:40 [Batch 40/250] loss=0.4327, metrics:accuracy:0.9344
INFO:root:15:31:41 [Batch 80/250] loss=0.6143, metrics:accuracy:0.9187
INFO:root:15:31:42 [Batch 120/250] loss=0.6395, metrics:accuracy:0.9135
INFO:root:15:31:42 [Batch 160/250] loss=0.5209, metrics:accuracy:0.9148
INFO:root:15:31:43 [Batch 200/250] loss=0.6895, metrics:accuracy:0.9087
INFO:root:15:31:44 [Batch 240/250] loss=0.5365, metrics:accuracy:0.9073
INFO:root:15:31:44 validation metrics:accuracy:0.9080
INFO:root:15:31:44 Time cost=5.12s, throughput=390.58 samples/s
INFO:root:15:31:45 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:15:31:45 Time cost=25.89s
INFO:root:15:31:46 Best model at epoch 3. Validation metrics:accuracy:0.9145
INFO:root:15:31:46 Now we are doing testing on test with gpu(0).
INFO:root:15:31:50 Time cost=4.84s, throughput=411.63 samples/s
INFO:root:15:32:46 Namespace(accumulate=None, batch_size=32, bert_dataset='wiki_cn_cased', bert_model='bert_12_768_12', calib_mode='customize', deploy=False, dev_batch_size=8, dtype='float32', early_stop=None, epochs=10, epsilon=1e-06, gpu=0, log_interval=40, lr=2e-05, max_len=128, model_parameters=None, model_prefix=None, num_calib_batches=5, only_calibration=False, only_inference=False, optimizer='bertadam', output_dir='./output_dir', pretrained_bert_parameters=None, quantized_dtype='auto', round_to=None, seed=2, task_name='waimai', training_steps=None, warmup_ratio=0.2)
INFO:root:15:32:51 processing dataset...
INFO:root:15:32:52 Now we are doing BERT classification training on gpu(0)!
INFO:root:15:32:52 training steps=2500
INFO:root:15:32:56 [Epoch 1 Batch 40/254] loss=0.6166, lr=0.0000016, metrics:accuracy:0.6628
INFO:root:15:33:00 [Epoch 1 Batch 80/254] loss=0.4307, lr=0.0000032, metrics:accuracy:0.7365
INFO:root:15:33:04 [Epoch 1 Batch 120/254] loss=0.3586, lr=0.0000048, metrics:accuracy:0.7795
INFO:root:15:33:07 [Epoch 1 Batch 160/254] loss=0.3022, lr=0.0000064, metrics:accuracy:0.8073
INFO:root:15:33:11 [Epoch 1 Batch 200/254] loss=0.2923, lr=0.0000080, metrics:accuracy:0.8261
INFO:root:15:33:14 [Epoch 1 Batch 240/254] loss=0.2854, lr=0.0000096, metrics:accuracy:0.8363
INFO:root:15:33:16 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:33:16 [Batch 40/250] loss=0.1963, metrics:accuracy:0.9250
INFO:root:15:33:17 [Batch 80/250] loss=0.2811, metrics:accuracy:0.9016
INFO:root:15:33:18 [Batch 120/250] loss=0.2259, metrics:accuracy:0.9010
INFO:root:15:33:19 [Batch 160/250] loss=0.2794, metrics:accuracy:0.9000
INFO:root:15:33:20 [Batch 200/250] loss=0.3007, metrics:accuracy:0.8988
INFO:root:15:33:20 [Batch 240/250] loss=0.3091, metrics:accuracy:0.8979
INFO:root:15:33:21 validation metrics:accuracy:0.8980
INFO:root:15:33:21 Time cost=5.10s, throughput=392.19 samples/s
INFO:root:15:33:22 params saved in: ./output_dir/model_bert_waimai_0.params
INFO:root:15:33:22 Time cost=29.85s
INFO:root:15:33:25 [Epoch 2 Batch 40/254] loss=0.2630, lr=0.0000117, metrics:accuracy:0.9133
INFO:root:15:33:29 [Epoch 2 Batch 80/254] loss=0.2341, lr=0.0000133, metrics:accuracy:0.9171
INFO:root:15:33:33 [Epoch 2 Batch 120/254] loss=0.2431, lr=0.0000149, metrics:accuracy:0.9144
INFO:root:15:33:37 [Epoch 2 Batch 160/254] loss=0.2165, lr=0.0000165, metrics:accuracy:0.9160
INFO:root:15:33:40 [Epoch 2 Batch 200/254] loss=0.2919, lr=0.0000181, metrics:accuracy:0.9131
INFO:root:15:33:44 [Epoch 2 Batch 240/254] loss=0.2555, lr=0.0000197, metrics:accuracy:0.9115
INFO:root:15:33:45 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:33:46 [Batch 40/250] loss=0.1889, metrics:accuracy:0.9313
INFO:root:15:33:47 [Batch 80/250] loss=0.2551, metrics:accuracy:0.9156
INFO:root:15:33:47 [Batch 120/250] loss=0.2471, metrics:accuracy:0.9104
INFO:root:15:33:48 [Batch 160/250] loss=0.2285, metrics:accuracy:0.9117
INFO:root:15:33:49 [Batch 200/250] loss=0.2751, metrics:accuracy:0.9069
INFO:root:15:33:50 [Batch 240/250] loss=0.3414, metrics:accuracy:0.9000
INFO:root:15:33:50 validation metrics:accuracy:0.8990
INFO:root:15:33:50 Time cost=5.21s, throughput=383.85 samples/s
INFO:root:15:33:52 params saved in: ./output_dir/model_bert_waimai_1.params
INFO:root:15:33:52 Time cost=29.62s
INFO:root:15:33:55 [Epoch 3 Batch 40/254] loss=0.2230, lr=0.0000195, metrics:accuracy:0.9232
INFO:root:15:33:59 [Epoch 3 Batch 80/254] loss=0.1828, lr=0.0000191, metrics:accuracy:0.9288
INFO:root:15:34:02 [Epoch 3 Batch 120/254] loss=0.2349, lr=0.0000187, metrics:accuracy:0.9265
INFO:root:15:34:06 [Epoch 3 Batch 160/254] loss=0.1843, lr=0.0000183, metrics:accuracy:0.9288
INFO:root:15:34:10 [Epoch 3 Batch 200/254] loss=0.1769, lr=0.0000179, metrics:accuracy:0.9312
INFO:root:15:34:14 [Epoch 3 Batch 240/254] loss=0.1845, lr=0.0000175, metrics:accuracy:0.9318
INFO:root:15:34:15 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:34:16 [Batch 40/250] loss=0.2583, metrics:accuracy:0.9062
INFO:root:15:34:16 [Batch 80/250] loss=0.2773, metrics:accuracy:0.9031
INFO:root:15:34:17 [Batch 120/250] loss=0.2824, metrics:accuracy:0.9010
INFO:root:15:34:18 [Batch 160/250] loss=0.2594, metrics:accuracy:0.9078
INFO:root:15:34:19 [Batch 200/250] loss=0.3151, metrics:accuracy:0.9038
INFO:root:15:34:20 [Batch 240/250] loss=0.3635, metrics:accuracy:0.9010
INFO:root:15:34:20 validation metrics:accuracy:0.9010
INFO:root:15:34:20 Time cost=5.25s, throughput=381.08 samples/s
INFO:root:15:34:21 params saved in: ./output_dir/model_bert_waimai_2.params
INFO:root:15:34:21 Time cost=29.64s
INFO:root:15:34:25 [Epoch 4 Batch 40/254] loss=0.1192, lr=0.0000170, metrics:accuracy:0.9611
INFO:root:15:34:29 [Epoch 4 Batch 80/254] loss=0.1297, lr=0.0000166, metrics:accuracy:0.9604
INFO:root:15:34:32 [Epoch 4 Batch 120/254] loss=0.1336, lr=0.0000162, metrics:accuracy:0.9592
INFO:root:15:34:36 [Epoch 4 Batch 160/254] loss=0.1508, lr=0.0000158, metrics:accuracy:0.9570
INFO:root:15:34:39 [Epoch 4 Batch 200/254] loss=0.1076, lr=0.0000154, metrics:accuracy:0.9595
INFO:root:15:34:43 [Epoch 4 Batch 240/254] loss=0.1355, lr=0.0000150, metrics:accuracy:0.9596
INFO:root:15:34:45 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:34:45 [Batch 40/250] loss=0.2870, metrics:accuracy:0.9313
INFO:root:15:34:46 [Batch 80/250] loss=0.3589, metrics:accuracy:0.9187
INFO:root:15:34:47 [Batch 120/250] loss=0.3787, metrics:accuracy:0.9125
INFO:root:15:34:48 [Batch 160/250] loss=0.2946, metrics:accuracy:0.9164
INFO:root:15:34:49 [Batch 200/250] loss=0.4507, metrics:accuracy:0.9106
INFO:root:15:34:49 [Batch 240/250] loss=0.3913, metrics:accuracy:0.9089
INFO:root:15:34:50 validation metrics:accuracy:0.9095
INFO:root:15:34:50 Time cost=5.03s, throughput=397.26 samples/s
INFO:root:15:34:51 params saved in: ./output_dir/model_bert_waimai_3.params
INFO:root:15:34:51 Time cost=29.52s
INFO:root:15:34:54 [Epoch 5 Batch 40/254] loss=0.0987, lr=0.0000145, metrics:accuracy:0.9719
INFO:root:15:34:58 [Epoch 5 Batch 80/254] loss=0.0902, lr=0.0000141, metrics:accuracy:0.9736
INFO:root:15:35:02 [Epoch 5 Batch 120/254] loss=0.0733, lr=0.0000137, metrics:accuracy:0.9751
INFO:root:15:35:05 [Epoch 5 Batch 160/254] loss=0.0915, lr=0.0000133, metrics:accuracy:0.9749
INFO:root:15:35:09 [Epoch 5 Batch 200/254] loss=0.0794, lr=0.0000129, metrics:accuracy:0.9753
INFO:root:15:35:13 [Epoch 5 Batch 240/254] loss=0.1034, lr=0.0000125, metrics:accuracy:0.9741
INFO:root:15:35:14 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:35:15 [Batch 40/250] loss=0.3378, metrics:accuracy:0.9250
INFO:root:15:35:16 [Batch 80/250] loss=0.4250, metrics:accuracy:0.9125
INFO:root:15:35:17 [Batch 120/250] loss=0.4284, metrics:accuracy:0.9125
INFO:root:15:35:17 [Batch 160/250] loss=0.3099, metrics:accuracy:0.9187
INFO:root:15:35:18 [Batch 200/250] loss=0.4417, metrics:accuracy:0.9156
INFO:root:15:35:19 [Batch 240/250] loss=0.5003, metrics:accuracy:0.9078
INFO:root:15:35:19 validation metrics:accuracy:0.9080
INFO:root:15:35:19 Time cost=5.15s, throughput=388.28 samples/s
INFO:root:15:35:20 params saved in: ./output_dir/model_bert_waimai_4.params
INFO:root:15:35:20 Time cost=29.78s
INFO:root:15:35:24 [Epoch 6 Batch 40/254] loss=0.0769, lr=0.0000119, metrics:accuracy:0.9781
INFO:root:15:35:28 [Epoch 6 Batch 80/254] loss=0.0790, lr=0.0000115, metrics:accuracy:0.9789
INFO:root:15:35:32 [Epoch 6 Batch 120/254] loss=0.0618, lr=0.0000111, metrics:accuracy:0.9808
INFO:root:15:35:35 [Epoch 6 Batch 160/254] loss=0.0528, lr=0.0000107, metrics:accuracy:0.9823
INFO:root:15:35:39 [Epoch 6 Batch 200/254] loss=0.0867, lr=0.0000103, metrics:accuracy:0.9813
INFO:root:15:35:43 [Epoch 6 Batch 240/254] loss=0.0621, lr=0.0000099, metrics:accuracy:0.9815
INFO:root:15:35:44 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:35:45 [Batch 40/250] loss=0.3577, metrics:accuracy:0.9219
INFO:root:15:35:46 [Batch 80/250] loss=0.5117, metrics:accuracy:0.9031
INFO:root:15:35:46 [Batch 120/250] loss=0.4870, metrics:accuracy:0.9010
INFO:root:15:35:47 [Batch 160/250] loss=0.3786, metrics:accuracy:0.9047
INFO:root:15:35:48 [Batch 200/250] loss=0.4691, metrics:accuracy:0.9038
INFO:root:15:35:49 [Batch 240/250] loss=0.4702, metrics:accuracy:0.9016
INFO:root:15:35:49 validation metrics:accuracy:0.9025
INFO:root:15:35:49 Time cost=5.25s, throughput=380.98 samples/s
INFO:root:15:35:50 params saved in: ./output_dir/model_bert_waimai_5.params
INFO:root:15:35:50 Time cost=29.78s
INFO:root:15:35:54 [Epoch 7 Batch 40/254] loss=0.0728, lr=0.0000094, metrics:accuracy:0.9786
INFO:root:15:35:57 [Epoch 7 Batch 80/254] loss=0.0397, lr=0.0000090, metrics:accuracy:0.9826
INFO:root:15:36:01 [Epoch 7 Batch 120/254] loss=0.0487, lr=0.0000086, metrics:accuracy:0.9845
INFO:root:15:36:05 [Epoch 7 Batch 160/254] loss=0.0486, lr=0.0000082, metrics:accuracy:0.9852
INFO:root:15:36:08 [Epoch 7 Batch 200/254] loss=0.0537, lr=0.0000078, metrics:accuracy:0.9854
INFO:root:15:36:12 [Epoch 7 Batch 240/254] loss=0.0489, lr=0.0000074, metrics:accuracy:0.9859
INFO:root:15:36:13 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:36:14 [Batch 40/250] loss=0.3874, metrics:accuracy:0.9250
INFO:root:15:36:15 [Batch 80/250] loss=0.5528, metrics:accuracy:0.9125
INFO:root:15:36:16 [Batch 120/250] loss=0.5259, metrics:accuracy:0.9083
INFO:root:15:36:17 [Batch 160/250] loss=0.4405, metrics:accuracy:0.9102
INFO:root:15:36:18 [Batch 200/250] loss=0.5581, metrics:accuracy:0.9069
INFO:root:15:36:19 [Batch 240/250] loss=0.5837, metrics:accuracy:0.9031
INFO:root:15:36:19 validation metrics:accuracy:0.9030
INFO:root:15:36:19 Time cost=5.23s, throughput=382.18 samples/s
INFO:root:15:36:20 params saved in: ./output_dir/model_bert_waimai_6.params
INFO:root:15:36:20 Time cost=29.72s
INFO:root:15:36:24 [Epoch 8 Batch 40/254] loss=0.0319, lr=0.0000068, metrics:accuracy:0.9912
INFO:root:15:36:28 [Epoch 8 Batch 80/254] loss=0.0353, lr=0.0000064, metrics:accuracy:0.9920
INFO:root:15:36:31 [Epoch 8 Batch 120/254] loss=0.0251, lr=0.0000060, metrics:accuracy:0.9928
INFO:root:15:36:35 [Epoch 8 Batch 160/254] loss=0.0262, lr=0.0000056, metrics:accuracy:0.9928
INFO:root:15:36:38 [Epoch 8 Batch 200/254] loss=0.0222, lr=0.0000052, metrics:accuracy:0.9932
INFO:root:15:36:42 [Epoch 8 Batch 240/254] loss=0.0375, lr=0.0000048, metrics:accuracy:0.9927
INFO:root:15:36:43 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:36:44 [Batch 40/250] loss=0.4701, metrics:accuracy:0.9094
INFO:root:15:36:45 [Batch 80/250] loss=0.6649, metrics:accuracy:0.8984
INFO:root:15:36:46 [Batch 120/250] loss=0.6435, metrics:accuracy:0.8938
INFO:root:15:36:47 [Batch 160/250] loss=0.5095, metrics:accuracy:0.8977
INFO:root:15:36:48 [Batch 200/250] loss=0.6103, metrics:accuracy:0.8969
INFO:root:15:36:48 [Batch 240/250] loss=0.6168, metrics:accuracy:0.8943
INFO:root:15:36:49 validation metrics:accuracy:0.8950
INFO:root:15:36:49 Time cost=5.20s, throughput=384.94 samples/s
INFO:root:15:36:50 params saved in: ./output_dir/model_bert_waimai_7.params
INFO:root:15:36:50 Time cost=29.74s
INFO:root:15:36:54 [Epoch 9 Batch 40/254] loss=0.0218, lr=0.0000043, metrics:accuracy:0.9935
INFO:root:15:36:57 [Epoch 9 Batch 80/254] loss=0.0162, lr=0.0000039, metrics:accuracy:0.9944
INFO:root:15:37:01 [Epoch 9 Batch 120/254] loss=0.0215, lr=0.0000035, metrics:accuracy:0.9942
INFO:root:15:37:05 [Epoch 9 Batch 160/254] loss=0.0314, lr=0.0000031, metrics:accuracy:0.9935
INFO:root:15:37:09 [Epoch 9 Batch 200/254] loss=0.0183, lr=0.0000027, metrics:accuracy:0.9938
INFO:root:15:37:12 [Epoch 9 Batch 240/254] loss=0.0150, lr=0.0000023, metrics:accuracy:0.9943
INFO:root:15:37:13 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:37:14 [Batch 40/250] loss=0.4450, metrics:accuracy:0.9250
INFO:root:15:37:15 [Batch 80/250] loss=0.6828, metrics:accuracy:0.9078
INFO:root:15:37:16 [Batch 120/250] loss=0.6443, metrics:accuracy:0.9031
INFO:root:15:37:17 [Batch 160/250] loss=0.4893, metrics:accuracy:0.9078
INFO:root:15:37:17 [Batch 200/250] loss=0.6448, metrics:accuracy:0.9056
INFO:root:15:37:18 [Batch 240/250] loss=0.6619, metrics:accuracy:0.9021
INFO:root:15:37:18 validation metrics:accuracy:0.9020
INFO:root:15:37:18 Time cost=5.21s, throughput=383.94 samples/s
INFO:root:15:37:19 params saved in: ./output_dir/model_bert_waimai_8.params
INFO:root:15:37:19 Time cost=29.76s
INFO:root:15:37:23 [Epoch 10 Batch 40/254] loss=0.0173, lr=0.0000018, metrics:accuracy:0.9953
INFO:root:15:37:27 [Epoch 10 Batch 80/254] loss=0.0356, lr=0.0000013, metrics:accuracy:0.9941
INFO:root:15:37:30 [Epoch 10 Batch 120/254] loss=0.0150, lr=0.0000009, metrics:accuracy:0.9950
INFO:root:15:37:34 [Epoch 10 Batch 160/254] loss=0.0114, lr=0.0000005, metrics:accuracy:0.9952
INFO:root:15:37:38 [Epoch 10 Batch 200/254] loss=0.0053, lr=0.0000002, metrics:accuracy:0.9957
INFO:root:15:37:39 Finish training step: 2500
INFO:root:15:37:39 Now we are doing evaluation on dev with gpu(0).
INFO:root:15:37:40 [Batch 40/250] loss=0.4591, metrics:accuracy:0.9250
INFO:root:15:37:41 [Batch 80/250] loss=0.7047, metrics:accuracy:0.9062
INFO:root:15:37:42 [Batch 120/250] loss=0.6669, metrics:accuracy:0.9010
INFO:root:15:37:42 [Batch 160/250] loss=0.5095, metrics:accuracy:0.9055
INFO:root:15:37:43 [Batch 200/250] loss=0.6159, metrics:accuracy:0.9050
INFO:root:15:37:44 [Batch 240/250] loss=0.6515, metrics:accuracy:0.9016
INFO:root:15:37:44 validation metrics:accuracy:0.9015
INFO:root:15:37:44 Time cost=5.23s, throughput=382.13 samples/s
INFO:root:15:37:45 params saved in: ./output_dir/model_bert_waimai_9.params
INFO:root:15:37:45 Time cost=25.99s
INFO:root:15:37:46 Best model at epoch 3. Validation metrics:accuracy:0.9095
INFO:root:15:37:46 Now we are doing testing on test with gpu(0).
INFO:root:15:37:51 Time cost=5.02s, throughput=396.53 samples/s
